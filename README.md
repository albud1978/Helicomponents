# Helicopter Component Lifecycle Prediction

## üöÅ –ü—Ä–æ–µ–∫—Ç –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≥–µ–Ω—Ç–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è (ABM) –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Flame GPU v2.0**.

---

## üéØ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è v2.0

### **üöÄ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Pipeline v2.0**
- ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: —Ç–æ–ª—å–∫–æ 2 —Ç–∞–±–ª–∏—Ü—ã (RAW + Results)
- ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ JOIN –≤ ClickHouse**: –æ–±–æ–≥–∞—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ pandas dict lookup
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –∑–∞–≥—Ä—É–∑–∫–∞ RAW –≤–æ –≤—Ä–µ–º—è GPU –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏  
- ‚úÖ **Production-ready**: –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **–í 3-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ**: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ data transfers

### **üìä –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `code/optimized_pipeline_v2.py` - –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω
- `code/final_optimized_pipeline.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `code/pipeline_migration_guide.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏

---

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### **üèóÔ∏è –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (2 —Ç–∞–±–ª–∏—Ü—ã)**

**1. RAW –¥–∞–Ω–Ω—ã–µ (`helicopter_components_raw`)**
- –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel + —á–∏—Å–ª–æ–≤—ã–µ ID –¥–ª—è GPU
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–∏–ø—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –¥–∞—Ç–µ
- –°–≤—è–∑—å —á–µ—Ä–µ–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `serialno`

**2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–π (`helicopter_simulation_results`)**  
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã GPU + –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è
- –ì–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –±–µ–∑ JOIN
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–∏–º—É–ª—è—Ü–∏–π –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### **üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel ‚Üí pandas (–æ–±–æ–≥–∞—â–µ–Ω–∏–µ) ‚Üí RAW table ‚Üí cuDF ‚Üí Flame GPU ‚Üí cuDF ‚Üí pandas (lookup) ‚Üí Arrow ‚Üí Results table
```

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **ClickHouse** - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (10.95.19.132:9000)
- **Flame GPU v2.0** - –∞–≥–µ–Ω—Ç–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ GPU
- **cuDF + RAPIDS** - GPU-—É—Å–∫–æ—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **PyArrow** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π data transfer
- **Apache Superset** - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### **Python –ø–∞–∫–µ—Ç—ã:**
```bash
pandas>=2.0.0
cudf>=24.0.0
pyarrow>=19.0.1
clickhouse-connect>=0.8.17
numpy
pyyaml
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### **1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repository_url>
cd cube

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp config/env_example.sh config/env.sh

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ClickHouse
nano config/database_config.yaml
```

### **3. –ó–∞–ø—É—Å–∫ Pipeline v2.0:**
```bash
# –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
python code/optimized_pipeline_v2.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
tail -f test_output/optimized_pipeline_v2.log
```

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### **–û–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö:**
- **–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ**: 108,623 –∑–∞–ø–∏—Å–µ–π (12 MB –ø–æ—Å–ª–µ –æ–±–æ–≥–∞—â–µ–Ω–∏—è)
- **–¶–µ–ª–µ–≤–æ–π –º–∞—Å—à—Ç–∞–±**: 600M —è—á–µ–µ–∫ –º–∞—Ç—Ä–∏—Ü—ã ‚Üí 2-5 GB —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞**: 80-90% –ø–æ—Å–ª–µ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

### **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã Pipeline v2.0:**
- –û–±–æ–≥–∞—â–µ–Ω–∏–µ –≤ pandas: ~2-3 —Å–µ–∫
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ GPU –¥–∞–Ω–Ω—ã—Ö: ~0.1-0.2 —Å–µ–∫  
- Flame GPU —Å–∏–º—É–ª—è—Ü–∏—è: –æ—Å–Ω–æ–≤–Ω–æ–µ –≤—Ä–µ–º—è
- –û–±–æ–≥–∞—â–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: ~1-2 —Å–µ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤ ClickHouse: ~5-10 —Å–µ–∫

**–ò—Ç–æ–≥–æ (–±–µ–∑ GPU)**: ~10-15 —Å–µ–∫—É–Ω–¥

---

## üéØ –¢–∏–ø—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### **–í–æ–∑–¥—É—à–Ω—ã–µ —Å—É–¥–∞:**
- **–ú–∏-26** (–±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞: 128)
- **–ú–∏-17** (–±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞: 64)  
- **–ú–∏-8–¢** (–±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞: 32)
- –ö–∞-32, AS-350, AS-355, R-44

### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **–í–ù–í** (–≤–∏–Ω—Ç—ã –Ω–µ—Å—É—â–∏–µ –≤–µ—Ä—Ç–æ–ª–µ—Ç–∞) - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–∫—É—Å
- –î–≤–∏–≥–∞—Ç–µ–ª–∏, —Ä–µ–¥—É–∫—Ç–æ—Ä—ã, –∞–≤–∏–æ–Ω–∏–∫–∞
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤

### **–í–ª–∞–¥–µ–ª—å—Ü—ã:**
–Æ–¢-–í–£, UTE, –ì–¢–õ–ö, –°–ë–ï–† –õ–ò–ó–ò–ù–ì, –ì–ü–ú, –ê–û –ì–ü–ú, –ò–ü, –ê–†–í, –ò

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cube/
‚îú‚îÄ‚îÄ code/                          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ optimized_pipeline_v2.py   # üöÄ –ì–ª–∞–≤–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω v2.0
‚îÇ   ‚îú‚îÄ‚îÄ final_optimized_pipeline.md # üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ pipeline_migration_guide.md # üîÑ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ cudf_flame_integration.py   # GPU –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ utils/                      # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ config/                        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database_config.yaml       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ClickHouse
‚îÇ   ‚îî‚îÄ‚îÄ logging_config.yaml        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ data_input/                    # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ source_data/               # Excel —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ master_data/               # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ analytics/                 # –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã
‚îÇ
‚îî‚îÄ‚îÄ test_output/                   # –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏
```

---

## üîç –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **ClickHouse –∑–∞–ø—Ä–æ—Å—ã:**
```sql
-- –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
SELECT 
    component_type,
    ac_typ,
    AVG(risk_score) as avg_risk,
    COUNT(*) as total_components
FROM helicopter_simulation_results
WHERE simulation_date >= today() - 7
GROUP BY component_type, ac_typ
ORDER BY avg_risk DESC;

-- –ü—Ä–æ–≥–Ω–æ–∑ –∑–∞–º–µ–Ω
SELECT 
    partno,
    COUNT(*) as components_at_risk,
    MIN(predicted_failure_days) as days_to_failure
FROM helicopter_simulation_results  
WHERE replacement_recommended = 1
GROUP BY partno
ORDER BY days_to_failure ASC;
```

### **Apache Superset:**
- –î–∞—à–±–æ—Ä–¥—ã —Ä–∏—Å–∫-–∞–Ω–∞–ª–∏–∑–∞
- –ü—Ä–æ–≥–Ω–æ–∑—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –í–°

---

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –∫–æ–Ω—Ç—Ä–∏–±—É—Ü–∏—è

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –º–∏–Ω–∏–º—É–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–æ—Å—Ç—É –¥–∞–Ω–Ω—ã—Ö
4. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ClickHouse
python -c "from code.utils.config_loader import load_database_config; print('OK')"

# –¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
python code/optimized_pipeline_v2.py
```

### **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –§–∞–π–ª–æ–≤—ã–µ –ª–æ–≥–∏: `test_output/optimized_pipeline_v2.log`
- –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üìà Roadmap

### **–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è (v2.0):**
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å 2 —Ç–∞–±–ª–∏—Ü–∞–º–∏
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ JOIN –≤ ClickHouse
- ‚úÖ Production-ready –∫–æ–¥

### **–°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã:**
- üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º Flame GPU v2.0
- üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ Superset  
- ü§ñ ML –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
- üåê Web API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –ø—Ä–æ–µ–∫—Ç—É helicopter component lifecycle prediction:

- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `code/final_optimized_pipeline.md`
- **–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏**: `code/pipeline_migration_guide.md`
- **–õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã**: `test_output/`

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤! üöÅ** 