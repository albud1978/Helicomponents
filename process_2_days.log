2024-12-01 19:01:56,260 - INFO - === Обработка даты 2024-11-26 ===
2024-12-01 19:01:56,271 - INFO - Обработка предыдущей даты: 2024-11-25
2024-12-01 19:01:56,272 - INFO - Обработка target_date: 2024-11-26
2024-12-01 19:01:56,380 - INFO - Извлечено 420 записей за предыдущую дату 2024-11-25.
2024-12-01 19:01:56,456 - INFO - Извлечено 420 записей за target_date 2024-11-26
2024-12-01 19:01:56,457 - INFO - serialno: 2228С78 - Status_P изменился с 'Ремонт' на 'Исправен'
2024-12-01 19:01:56,458 - INFO - serialno: 1228С101 - Status_P изменился с 'Ремонт' на 'Исправен'
2024-12-01 19:01:56,461 - INFO - serialno: С5381040 - Status_P изменился с 'Ремонт' на 'Исправен'
2024-12-01 19:01:56,462 - INFO - serialno: С6384678 - Status_P изменился с 'Ремонт' на 'Исправен'
2024-12-01 19:01:56,463 - INFO - serialno: СВ78В615 - Status_P изменился с 'Ремонт' на 'Исправен'
2024-12-01 19:01:56,466 - INFO - Определено 5 записей для обновления Status_P.
2024-12-01 19:01:56,467 - INFO - Изменились статусы для следующих serialno: 2228С78, 1228С101, С5381040, С6384678, СВ78В615
2024-12-01 19:01:56,468 - INFO - Общее количество измененных serialno: 5
2024-12-01 19:01:56,475 - INFO - Updated Status_P for serialno: 2228С78, Dates: 2024-11-26 to 'Исправен'
2024-12-01 19:01:56,482 - INFO - Updated Status_P for serialno: 1228С101, Dates: 2024-11-26 to 'Исправен'
2024-12-01 19:01:56,488 - INFO - Updated Status_P for serialno: С5381040, Dates: 2024-11-26 to 'Исправен'
2024-12-01 19:01:56,495 - INFO - Updated Status_P for serialno: С6384678, Dates: 2024-11-26 to 'Исправен'
2024-12-01 19:01:56,503 - INFO - Updated Status_P for serialno: СВ78В615, Dates: 2024-11-26 to 'Исправен'
2024-12-01 19:01:56,504 - INFO - Обновлено 5 записей в OlapCube_VNV для даты 2024-11-26.
2024-12-01 19:01:56,542 - INFO - balance_mi8t_count: 73
2024-12-01 19:01:56,552 - INFO - balance_mi8t: -13.0 (balance_mi8t_count: 73 - mi8t_count: 86.0)
2024-12-01 19:01:56,579 - INFO - balance_mi17_count: 83
2024-12-01 19:01:56,586 - INFO - balance_mi17: 13.0 (balance_mi17_count: 83 - mi17_count: 70.0)
2024-12-01 19:01:56,587 - INFO - balance_total: 0.0 (balance_mi8t: -13.0 + balance_mi17: 13.0)
2024-12-01 19:01:56,605 - INFO - stock_mi8t: 8
2024-12-01 19:01:56,621 - INFO - stock_mi17: 11
2024-12-01 19:01:56,637 - INFO - stock_empty: 1
2024-12-01 19:01:56,638 - INFO - stock_total: 20 (stock_mi8t: 8 + stock_mi17: 11 + stock_empty: 1)
2024-12-01 19:01:56,648 - INFO - Баланс и запасы успешно обновлены для даты 2024-11-26.
2024-12-01 19:01:56,658 - INFO - balance_total на target_date: 0
2024-12-01 19:01:56,709 - INFO - Извлечено 420 записей на target_date.
2024-12-01 19:01:56,711 - INFO - Начальное количество 'Эксплуатация': 156
2024-12-01 19:01:56,712 - INFO - Начальное количество 'Исправен': 20
2024-12-01 19:01:56,713 - INFO - Начальное количество 'Неактивно': 235
2024-12-01 19:01:56,723 - INFO - Статусы скопированы без изменений.
2024-12-01 19:01:56,730 - INFO - Оставшиеся значения скопированы из Status_P в Status.
2024-12-01 19:01:56,731 - INFO - Previous date: 2024-11-25
2024-12-01 19:01:56,819 - INFO - Извлечено 420 записей на target_date.
2024-12-01 19:01:56,880 - INFO - Извлечено 420 записей на предыдущую дату.
2024-12-01 19:01:56,881 - INFO - Обработано и обновлено 156 записей статуса 'Эксплуатация'.
2024-12-01 19:01:56,883 - INFO - Обработано и обновлено 20 записей статуса 'Исправен'.
2024-12-01 19:01:56,885 - INFO - Обработано и обновлено 8 записей статуса 'Ремонт'.
2024-12-01 19:01:56,887 - INFO - Обработано и обновлено записей статусов 'Хранение' и 'Неактивно'.
2024-12-01 19:01:56,888 - INFO - Обновлено всего 0 записей: sne, ppr и repair_days.
2024-12-01 19:01:56,890 - INFO - === Обработка даты 2024-11-27 ===
2024-12-01 19:01:56,903 - INFO - Обработка предыдущей даты: 2024-11-26
2024-12-01 19:01:56,904 - INFO - Обработка target_date: 2024-11-27
2024-12-01 19:01:57,029 - INFO - Извлечено 420 записей за предыдущую дату 2024-11-26.
2024-12-01 19:01:57,088 - INFO - Извлечено 420 записей за target_date 2024-11-27
2024-12-01 19:01:57,090 - INFO - serialno: С318789 - Status_P изменился с 'Эксплуатация' на 'Хранение'
2024-12-01 19:01:57,091 - INFO - Определено 1 записей для обновления Status_P.
2024-12-01 19:01:57,092 - INFO - Изменились статусы для следующих serialno: С318789
2024-12-01 19:01:57,094 - INFO - Общее количество измененных serialno: 1
2024-12-01 19:01:57,102 - INFO - Updated Status_P for serialno: С318789, Dates: 2024-11-27 to 'Хранение'
2024-12-01 19:01:57,103 - INFO - Обновлено 1 записей в OlapCube_VNV для даты 2024-11-27.
2024-12-01 19:01:57,155 - INFO - balance_mi8t_count: 0
2024-12-01 19:01:57,169 - INFO - balance_mi8t: -86.0 (balance_mi8t_count: 0 - mi8t_count: 86.0)
2024-12-01 19:01:57,203 - INFO - balance_mi17_count: 0
2024-12-01 19:01:57,215 - INFO - balance_mi17: -70.0 (balance_mi17_count: 0 - mi17_count: 70.0)
2024-12-01 19:01:57,216 - INFO - balance_total: -156.0 (balance_mi8t: -86.0 + balance_mi17: -70.0)
2024-12-01 19:01:57,244 - INFO - stock_mi8t: 0
2024-12-01 19:01:57,270 - INFO - stock_mi17: 0
2024-12-01 19:01:57,299 - INFO - stock_empty: 0
2024-12-01 19:01:57,301 - INFO - stock_total: 0 (stock_mi8t: 0 + stock_mi17: 0 + stock_empty: 0)
2024-12-01 19:01:57,311 - INFO - Баланс и запасы успешно обновлены для даты 2024-11-27.
2024-12-01 19:01:57,322 - INFO - balance_total на target_date: -156.0
2024-12-01 19:01:57,359 - INFO - Извлечено 420 записей на target_date.
2024-12-01 19:01:57,360 - INFO - Начальное количество 'Эксплуатация': 0
2024-12-01 19:01:57,363 - INFO - Начальное количество 'Исправен': 0
2024-12-01 19:01:57,364 - INFO - Начальное количество 'Неактивно': 0
2024-12-01 19:01:57,366 - INFO - Изменено 0 записей: 'Исправен' или 'Неактивно' -> 'Эксплуатация'. Serialno: 
2024-12-01 19:01:57,374 - INFO - Оставшиеся значения скопированы из Status_P в Status.
2024-12-01 19:01:57,375 - INFO - Previous date: 2024-11-26
2024-12-01 19:01:57,484 - INFO - Извлечено 420 записей на target_date.
2024-12-01 19:01:57,563 - INFO - Извлечено 420 записей на предыдущую дату.
2024-12-01 19:01:57,565 - ERROR - Ошибка при обновлении счётчиков: sequence item 0: expected str instance, NoneType found
Traceback (most recent call last):
  File "/tmp/ipykernel_25917/846516598.py", line 513, in calculate_and_update_counters
    logger.warning(f"Найдены неизвестные статусы: {', '.join(unknown_statuses)}. Эти записи будут пропущены.")
TypeError: sequence item 0: expected str instance, NoneType found
