=== program_ac_loader.py ===
Время выполнения: 0.486 секунд
Timestamp: 2025-07-03 13:06:58.231937

=== STDOUT ===
🚀 === ЗАГРУЗЧИК PROGRAM_AC (РЕЕСТР ВЕРТОЛЕТОВ В ЭКСПЛУАТАЦИИ) ===
✅ Environment variables автоматически загружены из .env
✅ Конфигурация загружена: 10.95.19.132:9000
🔒 Пароль получен из environment variable: CLICKHOUSE_PASSWORD
🔧 Создание таблицы program_ac...
✅ Таблица program_ac готова
📖 Загружаем data_input/source_data/Program_AC.xlsx...
📖 Загружен Excel файл
📊 Загружено: 178 записей с 10 колонками
📋 Колонки: ['ac_registr', 'ac_typ', 'object_type', 'description', 'owner', 'operator', 'homebase', 'homebase_name', 'directorate', 'Счет']

📈 Анализ данных:
   Типы ВС: ['350B3', '355NP', 'МИ8МТВ', 'МИ26Т', 'МИ8', 'КА32Т', 'МИ8АМТ', '355N']
   Распределение по типам:
     МИ8: 68 ВС
     МИ8МТВ: 54 ВС
     МИ8АМТ: 28 ВС
     350B3: 9 ВС
     МИ26Т: 8 ВС
   Собственники: ['ЮТ-ВУ', 'CHOPPER LL', 'ГТЛК', 'РЕГ ЛИЗИНГ', 'СБЕР ЛИЗИНГ']
   Распределение по собственникам:
     ЮТ-ВУ: 136 ВС
     ГТЛК: 25 ВС
     CHOPPER LL: 8 ВС
     РЕГ ЛИЗИНГ: 7 ВС
     СБЕР ЛИЗИНГ: 2 ВС
   Дирекции: 8 шт
📄 Извлечение версии из Program_AC.xlsx...
📋 Файл: Program_AC.xlsx
📏 Размер: 25,871 байт
🕐 Модификация ОС: 2025-07-02 17:30:10.656277
🎯 Источник версии: created date
🗓️ Версия данных: 2025-07-02
✅ Новая версия данных - продолжаем загрузку
📦 Подготовка данных реестра вертолетов для ClickHouse...
   🗑️ Удалены служебные колонки: Счет
📊 Подготовлено 178 записей с 10 колонками
🔍 Проверка качества данных:
   ✅ Все ac_registr уникальные
   ✅ Типы ВС: 8 уникальных

🚀 === НАЧИНАЕМ ЗАГРУЗКУ PROGRAM_AC ===
🚀 Загружаем 178 записей в program_ac...
🔍 Проверка типов в кортеже:
   ac_registr: 4043 (<class 'int'>)
   ac_typ: 350B3 (<class 'str'>)
   owner: ЮТ-ВУ (<class 'str'>)
✅ Загружено 178 записей в program_ac

🎉 === ЗАГРУЗКА PROGRAM_AC ЗАВЕРШЕНА ===

🔍 === ПРОВЕРКА КАЧЕСТВА PROGRAM_AC ===
📊 Исходный Excel файл: 178 записей
📊 program_ac: 178 записей

📈 Анализ по типам ВС и собственникам:
   350B3 - ЮТ-ВУ:
     📊 Записей: 5
     ✈️ ВС: 5
     🏢 Баз: 1
     🏛️ Дирекций: 1
   350B3 - CHOPPER LL:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 1
     🏛️ Дирекций: 1
   355N - ЮТ-ВУ:
     📊 Записей: 1
     ✈️ ВС: 1
     🏢 Баз: 1
     🏛️ Дирекций: 1
   355NP - CHOPPER LL:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 1
     🏛️ Дирекций: 1
   355NP - ЮТ-ВУ:
     📊 Записей: 2
     ✈️ ВС: 2
     🏢 Баз: 1
     🏛️ Дирекций: 1
   КА32Т - ЮТ-ВУ:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 1
     🏛️ Дирекций: 1
   МИ26Т - ЮТ-ВУ:
     📊 Записей: 8
     ✈️ ВС: 8
     🏢 Баз: 6
     🏛️ Дирекций: 3
   МИ8 - ЮТ-ВУ:
     📊 Записей: 68
     ✈️ ВС: 68
     🏢 Баз: 25
     🏛️ Дирекций: 6
   МИ8АМТ - ЮТ-ВУ:
     📊 Записей: 20
     ✈️ ВС: 20
     🏢 Баз: 10
     🏛️ Дирекций: 7
   МИ8АМТ - РЕГ ЛИЗИНГ:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 4
     🏛️ Дирекций: 2
   МИ8АМТ - ГТЛК:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 4
     🏛️ Дирекций: 2
   МИ8МТВ - ЮТ-ВУ:
     📊 Записей: 28
     ✈️ ВС: 28
     🏢 Баз: 7
     🏛️ Дирекций: 4
   МИ8МТВ - ГТЛК:
     📊 Записей: 21
     ✈️ ВС: 21
     🏢 Баз: 11
     🏛️ Дирекций: 6
   МИ8МТВ - РЕГ ЛИЗИНГ:
     📊 Записей: 3
     ✈️ ВС: 3
     🏢 Баз: 3
     🏛️ Дирекций: 3
   МИ8МТВ - СБЕР ЛИЗИНГ:
     📊 Записей: 2
     ✈️ ВС: 2
     🏢 Баз: 2
     🏛️ Дирекций: 1

📊 Распределение по типам ВС:
   МИ8: 68 ВС (1 собственников, 25 баз)
   МИ8МТВ: 54 ВС (4 собственников, 16 баз)
   МИ8АМТ: 28 ВС (3 собственников, 13 баз)
   350B3: 9 ВС (2 собственников, 1 баз)
   МИ26Т: 8 ВС (1 собственников, 6 баз)
   355NP: 6 ВС (2 собственников, 1 баз)
   КА32Т: 4 ВС (1 собственников, 1 баз)
   355N: 1 ВС (1 собственников, 1 баз)

🗺️ Топ-5 дирекций по количеству ВС:
   ЗАПАДНО-СИБИРСКАЯ ДИРЕКЦИЯ: 70 ВС (12 баз)
   ВОСТОЧНО-СИБИРСКАЯ ДИРЕКЦИЯ: 26 ВС (10 баз)
   КРАСНОЯРСКАЯ ДИРЕКЦИЯ: 24 ВС (7 баз)
   ЯМАЛЬСКАЯ ДИРЕКЦИЯ: 23 ВС (5 баз)
   ТУРЦИЯ: 17 ВС (1 баз)

✅ Все проверки пройдены успешно!
✅ Загружено записей: 178/178

🎯 === ИТОГОВАЯ СТАТИСТИКА ===
📅 Версия данных: 2025-07-02
📊 program_ac: 178 записей
📈 Реестр вертолетов в эксплуатации загружен
🔍 Проверки качества: ✅ ПРОЙДЕНЫ

=== STDERR ===
(пустой)
