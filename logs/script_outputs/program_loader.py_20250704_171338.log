=== program_loader.py ===
Время выполнения: 0.404 секунд
Timestamp: 2025-07-04 17:13:38.389044

=== STDOUT ===
🚀 === ЗАГРУЗЧИК PROGRAM (ПРОГРАММА ПОЛЕТОВ) ===
✅ Environment variables автоматически загружены из .env
✅ Конфигурация загружена: 10.95.19.132:9000
🔒 Пароль получен из environment variable: CLICKHOUSE_PASSWORD
✅ Таблица flight_program готова
📖 Загружаем data_input/source_data/Program.xlsx...
📖 Загружен Excel файл
📊 Загружено: 8 записей с 15 колонками
📋 Колонки: ['partno', 'serialno', 'Поле', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

📈 Анализ данных:
   Типы ВС (partno): [32. 64.]
   Серийные номера: [27067. 22492. 24190. 22321.]
   Типы полей: ['ops_counter_mi8' 'ops_counter_mi17' 'daily_flight']
📅 Определение версии данных из Excel метаданных...
⚠️ Дата создания 2006-09-16 00:00:00 отличается от текущего года более чем на год
📅 Дата модификации Excel: 2025-06-25 13:58:10
📋 Файл: Program.xlsx
📏 Размер: 11,504 байт
🕐 Модификация ОС: 2025-06-25 18:58:10.608442
🎯 Источник версии: Excel modified
🗓️ Версия данных: 2025-06-25
✅ Новая версия данных - продолжаем загрузку
📦 Подготовка данных программы полетов для ClickHouse...
📦 Преобразование данных программы полетов в нормализованную форму...
📅 Найдены месяцы: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
📊 Преобразовано в 96 записей (нормализованная форма)
📊 Подготовлено 96 записей с 9 колонками
🔍 Статистика None значений после обработки:
   partno: 48/96 None значений
   serialno: 48/96 None значений

🚀 === НАЧИНАЕМ ЗАГРУЗКУ FLIGHT_PROGRAM ===
🚀 Загружаем 96 записей в flight_program...
🔍 Проверка типов в кортеже:
   partno: 32 (<class 'int'>)
   serialno: None (<class 'NoneType'>)
✅ Загружено 96 записей в flight_program

🎉 === ЗАГРУЗКА FLIGHT_PROGRAM ЗАВЕРШЕНА ===

🔍 === ПРОВЕРКА КАЧЕСТВА FLIGHT_PROGRAM ===
📊 Исходный Excel файл: 8 записей
📊 flight_program (нормализованные): 96 записей

📈 Анализ структуры данных:
   daily_flight:
     📊 Записей: 72
     🔢 Типов ВС: 2
     ✈️ Серийных номеров: 4
     📅 Период: 2025-01-01 - 2025-12-01
   ops_counter_mi17:
     📊 Записей: 12
     🔢 Типов ВС: 1
     ✈️ Серийных номеров: 0
     📅 Период: 2025-01-01 - 2025-12-01
   ops_counter_mi8:
     📊 Записей: 12
     🔢 Типов ВС: 1
     ✈️ Серийных номеров: 0
     📅 Период: 2025-01-01 - 2025-12-01

📅 Покрытие по месяцам:
   Месяц  1: 8 записей, 3 типов полей
   Месяц  2: 8 записей, 3 типов полей
   Месяц  3: 8 записей, 3 типов полей
   Месяц  4: 8 записей, 3 типов полей
   Месяц  5: 8 записей, 3 типов полей
   Месяц  6: 8 записей, 3 типов полей
   Месяц  7: 8 записей, 3 типов полей
   Месяц  8: 8 записей, 3 типов полей
   Месяц  9: 8 записей, 3 типов полей
   Месяц 10: 8 записей, 3 типов полей
   Месяц 11: 8 записей, 3 типов полей
   Месяц 12: 8 записей, 3 типов полей

✅ Все проверки пройдены успешно!
✅ Коэффициент нормализации: 12.0x
✅ Покрытие месяцев: 12/12

🎯 === ИТОГОВАЯ СТАТИСТИКА ===
📅 Версия данных: 2025-06-25
📊 flight_program: 96 записей (нормализованные)
📈 Программа полетов на 2025 год загружена
🔍 Проверки качества: ✅ ПРОЙДЕНЫ

=== STDERR ===
(пустой)
