=== program_ac_loader.py ===
Время выполнения: 0.410 секунд
Timestamp: 2025-07-04 17:13:21.090911

=== STDOUT ===
🚀 === ЗАГРУЗЧИК PROGRAM_AC (РЕЕСТР ВЕРТОЛЕТОВ В ЭКСПЛУАТАЦИИ) ===
✅ Environment variables автоматически загружены из .env
✅ Конфигурация загружена: 10.95.19.132:9000
🔒 Пароль получен из environment variable: CLICKHOUSE_PASSWORD
🔧 Создание таблицы program_ac...
✅ Таблица program_ac готова
📖 Загружаем data_input/source_data/Program_AC.xlsx...
📖 Загружен Excel файл
📊 Загружено: 189 записей с 10 колонками
📋 Колонки: ['ac_registr', 'ac_typ', 'object_type', 'description', 'owner', 'operator', 'homebase', 'homebase_name', 'directorate', 'Счет']

📈 Анализ данных:
   Типы ВС: ['350B3', '355NP', 'Ми-17', 'МИ26Т', 'Ми-8Т', 'КА32Т', '355N']
   Распределение по типам:
     Ми-17: 93 ВС
     Ми-8Т: 68 ВС
     350B3: 9 ВС
     МИ26Т: 8 ВС
     355NP: 6 ВС
   Собственники: ['ЮТ-ВУ', 'CHOPPER LL', 'ГТЛК', 'РЕГ ЛИЗИНГ', 'СБЕР ЛИЗИНГ', 'ВТК-АВИА']
   Распределение по собственникам:
     ЮТ-ВУ: 137 ВС
     ГТЛК: 25 ВС
     ВТК-АВИА: 10 ВС
     CHOPPER LL: 8 ВС
     РЕГ ЛИЗИНГ: 7 ВС
     СБЕР ЛИЗИНГ: 2 ВС
   Дирекции: 7 шт
📄 Извлечение версии из Program_AC.xlsx...
📋 Файл: Program_AC.xlsx
📏 Размер: 26,991 байт
🕐 Модификация ОС: 2025-07-04 16:33:32.489322
🎯 Источник версии: created date
🗓️ Версия данных: 2025-07-04
✅ Новая версия данных - продолжаем загрузку
📦 Подготовка данных реестра вертолетов для ClickHouse...
   🗑️ Удалены служебные колонки: Счет
📊 Подготовлено 189 записей с 10 колонками
🔍 Проверка качества данных:
   ✅ Все ac_registr уникальные
   ✅ Типы ВС: 7 уникальных

🚀 === НАЧИНАЕМ ЗАГРУЗКУ PROGRAM_AC ===
🚀 Загружаем 189 записей в program_ac...
🔍 Проверка типов в кортеже:
   ac_registr: 4043 (<class 'int'>)
   ac_typ: 350B3 (<class 'str'>)
   owner: ЮТ-ВУ (<class 'str'>)
✅ Загружено 189 записей в program_ac

🎉 === ЗАГРУЗКА PROGRAM_AC ЗАВЕРШЕНА ===

🔍 === ПРОВЕРКА КАЧЕСТВА PROGRAM_AC ===
📊 Исходный Excel файл: 189 записей
📊 program_ac: 189 записей

📈 Анализ по типам ВС и собственникам:
   350B3 - ЮТ-ВУ:
     📊 Записей: 5
     ✈️ ВС: 5
     🏢 Баз: 1
     🏛️ Дирекций: 1
   350B3 - CHOPPER LL:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 1
     🏛️ Дирекций: 1
   355N - ЮТ-ВУ:
     📊 Записей: 1
     ✈️ ВС: 1
     🏢 Баз: 1
     🏛️ Дирекций: 1
   355NP - CHOPPER LL:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 1
     🏛️ Дирекций: 1
   355NP - ЮТ-ВУ:
     📊 Записей: 2
     ✈️ ВС: 2
     🏢 Баз: 1
     🏛️ Дирекций: 1
   КА32Т - ЮТ-ВУ:
     📊 Записей: 4
     ✈️ ВС: 4
     🏢 Баз: 1
     🏛️ Дирекций: 1
   МИ26Т - ЮТ-ВУ:
     📊 Записей: 8
     ✈️ ВС: 8
     🏢 Баз: 6
     🏛️ Дирекций: 3
   Ми-17 - ЮТ-ВУ:
     📊 Записей: 49
     ✈️ ВС: 49
     🏢 Баз: 14
     🏛️ Дирекций: 7
   Ми-17 - ГТЛК:
     📊 Записей: 25
     ✈️ ВС: 25
     🏢 Баз: 11
     🏛️ Дирекций: 6
   Ми-17 - ВТК-АВИА:
     📊 Записей: 10
     ✈️ ВС: 10
     🏢 Баз: 8
     🏛️ Дирекций: 6
   Ми-17 - РЕГ ЛИЗИНГ:
     📊 Записей: 7
     ✈️ ВС: 7
     🏢 Баз: 7
     🏛️ Дирекций: 4
   Ми-17 - СБЕР ЛИЗИНГ:
     📊 Записей: 2
     ✈️ ВС: 2
     🏢 Баз: 2
     🏛️ Дирекций: 1
   Ми-8Т - ЮТ-ВУ:
     📊 Записей: 68
     ✈️ ВС: 68
     🏢 Баз: 25
     🏛️ Дирекций: 6

📊 Распределение по типам ВС:
   Ми-17: 93 ВС (5 собственников, 21 баз)
   Ми-8Т: 68 ВС (1 собственников, 25 баз)
   350B3: 9 ВС (2 собственников, 1 баз)
   МИ26Т: 8 ВС (1 собственников, 6 баз)
   355NP: 6 ВС (2 собственников, 1 баз)
   КА32Т: 4 ВС (1 собственников, 1 баз)
   355N: 1 ВС (1 собственников, 1 баз)

🗺️ Топ-5 дирекций по количеству ВС:
   ЗАПАДНО-СИБИРСКАЯ ДИРЕКЦИЯ: 72 ВС (11 баз)
   ВОСТОЧНО-СИБИРСКАЯ ДИРЕКЦИЯ: 28 ВС (10 баз)
   КРАСНОЯРСКАЯ ДИРЕКЦИЯ: 27 ВС (7 баз)
   ЯМАЛЬСКАЯ ДИРЕКЦИЯ: 24 ВС (6 баз)
   ТУРЦИЯ: 17 ВС (1 баз)

✅ Все проверки пройдены успешно!
✅ Загружено записей: 189/189

🎯 === ИТОГОВАЯ СТАТИСТИКА ===
📅 Версия данных: 2025-07-04
📊 program_ac: 189 записей
📈 Реестр вертолетов в эксплуатации загружен
🔍 Проверки качества: ✅ ПРОЙДЕНЫ

=== STDERR ===
(пустой)
