2025-01-23 09:05:04,217 - INFO - CREATE TABLE Query for monthly_flight_hours:

    CREATE TABLE IF NOT EXISTS default.monthly_flight_hours (
        `monthly_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2025-01-23 09:05:04,232 - INFO - Таблица monthly_flight_hours создана или уже существует.
2025-01-23 09:05:04,233 - INFO - CREATE TABLE Query for flight_hours:

    CREATE TABLE IF NOT EXISTS default.flight_hours (
        `monthly_flight_hours` Nullable(Float64), `daily_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2025-01-23 09:05:04,244 - INFO - Таблица flight_hours создана или уже существует.
2025-01-23 09:05:04,245 - INFO - CREATE MATERIALIZED VIEW Query:

    CREATE MATERIALIZED VIEW IF NOT EXISTS default.flight_hours_mv TO default.flight_hours AS
    SELECT
        monthly_flight_hours,
        round((monthly_flight_hours * 12) / 365, 2) AS daily_flight_hours
    FROM default.monthly_flight_hours
    
2025-01-23 09:05:04,257 - INFO - Материализованное представление flight_hours_mv создано или уже существует.
2025-01-23 09:05:04,259 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2025-01-23 09:05:04,565 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2025-01-23 09:05:04,577 - INFO - Месячный налёт из файла Program.xlsx успешно загружен в таблицу monthly_flight_hours.
2025-01-23 09:05:35,157 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2025-01-23 09:05:35,173 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2025-01-23 09:05:35,176 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.fleet (
            `month` String, `mi8t_count` Nullable(Float64), `mi17_count` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2025-01-23 09:05:35,188 - INFO - Таблица fleet создана или уже существует.
2025-01-23 09:05:35,262 - INFO - Данные из файла Program.xlsx успешно загружены в таблицу fleet в ClickHouse.
2025-01-23 09:06:21,140 - INFO - Начинаю обработку файла: ./Агрегат/Агрегат.xlsx
2025-01-23 09:06:21,307 - INFO - Файл ./Агрегат/Агрегат.xlsx успешно прочитан.
2025-01-23 09:06:21,309 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.Agregat (
            `ComponentNumber` Nullable(String), `UnloadDate` Nullable(Date), `NR_Mi8T` Nullable(Float64), `MRR_Mi8T` Nullable(Float64), `NR_Mi17` Nullable(Float64), `MRR_Mi17` Nullable(Float64), `MRR_2_Mi8T` Nullable(Float64), `MRR_2_Mi17` Nullable(Float64), `RepairTime` Nullable(Float64), `PurchasePrice` Nullable(Float64), `RepairPrice` Nullable(Float64), `BR_Mi8T` Nullable(Float64), `BR_Mi17` Nullable(Float64), `items_per_ac` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2025-01-23 09:06:21,323 - INFO - Таблица Agregat создана или уже существует.
2025-01-23 09:06:21,333 - INFO - Данные из файла Агрегат.xlsx успешно загружены в таблицу Agregat в ClickHouse.
2025-01-23 09:57:43,843 - INFO - CREATE TABLE Query for monthly_flight_hours:

    CREATE TABLE IF NOT EXISTS default.monthly_flight_hours (
        `monthly_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2025-01-23 09:57:43,854 - INFO - Таблица monthly_flight_hours создана или уже существует.
2025-01-23 09:57:43,855 - INFO - CREATE TABLE Query for flight_hours:

    CREATE TABLE IF NOT EXISTS default.flight_hours (
        `monthly_flight_hours` Nullable(Float64), `daily_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2025-01-23 09:57:43,863 - INFO - Таблица flight_hours создана или уже существует.
2025-01-23 09:57:43,865 - INFO - CREATE MATERIALIZED VIEW Query:

    CREATE MATERIALIZED VIEW IF NOT EXISTS default.flight_hours_mv TO default.flight_hours AS
    SELECT
        monthly_flight_hours,
        round((monthly_flight_hours * 12) / 365, 2) AS daily_flight_hours
    FROM default.monthly_flight_hours
    
2025-01-23 09:57:43,872 - INFO - Материализованное представление flight_hours_mv создано или уже существует.
2025-01-23 09:57:43,874 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2025-01-23 09:57:43,888 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2025-01-23 09:57:43,897 - INFO - Месячный налёт из файла Program.xlsx успешно загружен в таблицу monthly_flight_hours.
2025-01-23 09:57:48,586 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2025-01-23 09:57:48,601 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2025-01-23 09:57:48,604 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.fleet (
            `month` String, `mi8t_count` Nullable(Float64), `mi17_count` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2025-01-23 09:57:48,614 - INFO - Таблица fleet создана или уже существует.
2025-01-23 09:57:48,671 - INFO - Данные из файла Program.xlsx успешно загружены в таблицу fleet в ClickHouse.
2025-01-23 09:58:34,217 - INFO - Начинаю обработку файла: ./Агрегат/Агрегат.xlsx
2025-01-23 09:58:34,230 - INFO - Файл ./Агрегат/Агрегат.xlsx успешно прочитан.
2025-01-23 09:58:34,231 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.Agregat (
            `ComponentNumber` Nullable(String), `UnloadDate` Nullable(Date), `NR_Mi8T` Nullable(Float64), `MRR_Mi8T` Nullable(Float64), `NR_Mi17` Nullable(Float64), `MRR_Mi17` Nullable(Float64), `MRR_2_Mi8T` Nullable(Float64), `MRR_2_Mi17` Nullable(Float64), `RepairTime` Nullable(Float64), `PurchasePrice` Nullable(Float64), `RepairPrice` Nullable(Float64), `BR_Mi8T` Nullable(Float64), `BR_Mi17` Nullable(Float64), `items_per_ac` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2025-01-23 09:58:34,241 - INFO - Таблица Agregat создана или уже существует.
2025-01-23 09:58:34,249 - INFO - Данные из файла Агрегат.xlsx успешно загружены в таблицу Agregat в ClickHouse.
