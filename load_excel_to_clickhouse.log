2024-11-28 12:30:43,922 - INFO - CREATE TABLE Query for monthly_flight_hours:

    CREATE TABLE IF NOT EXISTS default.monthly_flight_hours (
        `monthly_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2024-11-28 12:30:43,934 - INFO - Таблица monthly_flight_hours создана или уже существует.
2024-11-28 12:30:43,935 - INFO - CREATE TABLE Query for flight_hours:

    CREATE TABLE IF NOT EXISTS default.flight_hours (
        `monthly_flight_hours` Nullable(Float64), `daily_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2024-11-28 12:30:43,944 - INFO - Таблица flight_hours создана или уже существует.
2024-11-28 12:30:43,945 - INFO - CREATE MATERIALIZED VIEW Query:

    CREATE MATERIALIZED VIEW IF NOT EXISTS default.flight_hours_mv TO default.flight_hours AS
    SELECT
        monthly_flight_hours,
        round((monthly_flight_hours * 12) / 365, 2) AS daily_flight_hours
    FROM default.monthly_flight_hours
    
2024-11-28 12:30:43,958 - INFO - Материализованное представление flight_hours_mv создано или уже существует.
2024-11-28 12:30:43,959 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2024-11-28 12:30:44,248 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2024-11-28 12:30:44,262 - INFO - Месячный налёт из файла Program.xlsx успешно загружен в таблицу monthly_flight_hours.
2024-11-28 12:30:48,617 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2024-11-28 12:30:48,634 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2024-11-28 12:30:48,637 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.fleet (
            `month` String, `mi8t_count` Nullable(Float64), `mi17_count` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2024-11-28 12:30:48,647 - INFO - Таблица fleet создана или уже существует.
2024-11-28 12:30:48,705 - INFO - Данные из файла Program.xlsx успешно загружены в таблицу fleet в ClickHouse.
2024-11-28 12:33:26,107 - INFO - Начинаю обработку файла: ./Агрегат/Агрегат.xlsx
2024-11-28 12:33:26,268 - INFO - Файл ./Агрегат/Агрегат.xlsx успешно прочитан.
2024-11-28 12:33:26,270 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.Agregat (
            `ComponentNumber` Nullable(String), `UnloadDate` Nullable(Date), `NR_Mi8T` Nullable(Float64), `MRR_Mi8T` Nullable(Float64), `NR_Mi17` Nullable(Float64), `MRR_Mi17` Nullable(Float64), `MRR_2_Mi8T` Nullable(Float64), `MRR_2_Mi17` Nullable(Float64), `RepairTime` Nullable(Float64), `PurchasePrice` Nullable(Float64), `RepairPrice` Nullable(Float64), `BR_Mi8T` Nullable(Float64), `BR_Mi17` Nullable(Float64), `items_per_ac` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2024-11-28 12:33:26,282 - INFO - Таблица Agregat создана или уже существует.
2024-11-28 12:33:26,290 - INFO - Данные из файла Агрегат.xlsx успешно загружены в таблицу Agregat в ClickHouse.
2024-11-28 13:27:26,395 - INFO - CREATE TABLE Query for monthly_flight_hours:

    CREATE TABLE IF NOT EXISTS default.monthly_flight_hours (
        `monthly_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2024-11-28 13:27:26,405 - INFO - Таблица monthly_flight_hours создана или уже существует.
2024-11-28 13:27:26,406 - INFO - CREATE TABLE Query for flight_hours:

    CREATE TABLE IF NOT EXISTS default.flight_hours (
        `monthly_flight_hours` Nullable(Float64), `daily_flight_hours` Nullable(Float64)
    ) ENGINE = MergeTree()
    ORDER BY tuple()
    
2024-11-28 13:27:26,415 - INFO - Таблица flight_hours создана или уже существует.
2024-11-28 13:27:26,416 - INFO - CREATE MATERIALIZED VIEW Query:

    CREATE MATERIALIZED VIEW IF NOT EXISTS default.flight_hours_mv TO default.flight_hours AS
    SELECT
        monthly_flight_hours,
        round((monthly_flight_hours * 12) / 365, 2) AS daily_flight_hours
    FROM default.monthly_flight_hours
    
2024-11-28 13:27:26,424 - INFO - Материализованное представление flight_hours_mv создано или уже существует.
2024-11-28 13:27:26,426 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2024-11-28 13:27:26,440 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2024-11-28 13:27:26,449 - INFO - Месячный налёт из файла Program.xlsx успешно загружен в таблицу monthly_flight_hours.
2024-11-28 13:27:32,915 - INFO - Начинаю обработку файла: ./Программа/Program.xlsx
2024-11-28 13:27:32,931 - INFO - Файл ./Программа/Program.xlsx успешно прочитан.
2024-11-28 13:27:32,934 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.fleet (
            `month` String, `mi8t_count` Nullable(Float64), `mi17_count` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2024-11-28 13:27:32,945 - INFO - Таблица fleet создана или уже существует.
2024-11-28 13:27:33,026 - INFO - Данные из файла Program.xlsx успешно загружены в таблицу fleet в ClickHouse.
2024-11-28 13:27:59,650 - INFO - Начинаю обработку файла: ./Агрегат/Агрегат.xlsx
2024-11-28 13:27:59,662 - INFO - Файл ./Агрегат/Агрегат.xlsx успешно прочитан.
2024-11-28 13:27:59,664 - INFO - CREATE TABLE Query:

        CREATE TABLE IF NOT EXISTS default.Agregat (
            `ComponentNumber` Nullable(String), `UnloadDate` Nullable(Date), `NR_Mi8T` Nullable(Float64), `MRR_Mi8T` Nullable(Float64), `NR_Mi17` Nullable(Float64), `MRR_Mi17` Nullable(Float64), `MRR_2_Mi8T` Nullable(Float64), `MRR_2_Mi17` Nullable(Float64), `RepairTime` Nullable(Float64), `PurchasePrice` Nullable(Float64), `RepairPrice` Nullable(Float64), `BR_Mi8T` Nullable(Float64), `BR_Mi17` Nullable(Float64), `items_per_ac` Nullable(Float64)
        ) ENGINE = MergeTree()
        ORDER BY tuple()
        
2024-11-28 13:27:59,675 - INFO - Таблица Agregat создана или уже существует.
2024-11-28 13:27:59,682 - INFO - Данные из файла Агрегат.xlsx успешно загружены в таблицу Agregat в ClickHouse.
