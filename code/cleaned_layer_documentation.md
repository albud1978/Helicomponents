# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CLEANED —Å–ª–æ—è ClickHouse

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
CLEANED —Å–ª–æ–π —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏–∑ RAW –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É MD_Components.xlsx, –±–∏—Ç–æ–≤—ã—Ö –º–∞—Å–æ–∫ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏ –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω—é–∞–Ω—Å—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ClickHouse
**–î–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ `clickhouse_driver.Client` –Ω–∞–ø—Ä—è–º—É—é
- –ê—Ä—Ö–∏–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ù–∏–∫–∞–∫–∏—Ö —Å–∞–º–æ–¥–µ–ª—å–Ω—ã—Ö –æ–±–µ—Ä—Ç–æ–∫

### 2. –ß—Ç–µ–Ω–∏–µ MD_Components.xlsx
**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:**
- –°—Ç—Ä–æ–∫–∞ 8 (header=7): –†—É—Å—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ ‚úÖ
- –°—Ç—Ä–æ–∫–∞ 9 (header=8): –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–æ–ª—è ‚ùå –ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨

**–ú–∞–ø–ø–∏–Ω–≥:** –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è ‚Üí –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–æ–ª—è —á–µ—Ä–µ–∑ column_mapping

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–∏—Ç–æ–≤—ã—Ö –º–∞—Å–æ–∫
**–ö—Ä–∏—Ç–∏—á–Ω–æ:** –ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏ '0b01100000'
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —á–∏—Å–ª–∞: `int(mask, 2)`
- –ú–∞–ø–ø–∏–Ω–≥ –Ω–∞ —Ç–∏–ø—ã –í–°: 96‚Üí–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ, 64‚Üí–ú–∏-17, 32‚Üí–ú–∏-8–¢

### 4. –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
**–î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
1. **–ü–µ—Ä–≤–∏—á–Ω–∞—è:** `partno IN (—Å–ø–∏—Å–æ–∫ –∏–∑ MD_Components)` 
2. **–í—Ç–æ—Ä–∏—á–Ω–∞—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –±–∏—Ç–æ–≤—ã—Ö –º–∞—Å–æ–∫ —Å `ac_typ`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ~0.7% –æ—Ç RAW –¥–∞–Ω–Ω—ã—Ö (108,623 ‚Üí ~760 –∑–∞–ø–∏—Å–µ–π)

### 5. –ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
**–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞:** 5,000 –∑–∞–ø–∏—Å–µ–π (–∫–∞–∫ –≤ –∞—Ä—Ö–∏–≤–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ)
**–ü—Ä–∏—á–∏–Ω–∞:** –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è ClickHouse

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ CLEANED —Ç–∞–±–ª–∏—Ü—ã

**–ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç RAW:**
- –¢–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ partno –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
- –û–±–æ–≥–∞—â–µ–Ω–∏–µ: component_name, group_by, effectivity_type
- –ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —á–∏—Å–ª–æ–≤—ã–µ ID
- –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Å–≤—è–∑–∏ –≥–æ—Ç–æ–≤—ã –¥–ª—è JOIN

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –¢–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–Ω–µ—Ç "–º—É—Å–æ—Ä–∞")
- –ë—ã—Å—Ç—Ä—ã–µ –±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö)
- –ì–æ—Ç–æ–≤—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Å–≤—è–∑–∏

## üìà –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π: ~0.7% –æ—Ç RAW
- –ü–æ–∫—Ä—ã—Ç–∏–µ partno: 100% –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ MD_Components  
- –ü—É—Å—Ç—ã–µ component_name: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0

## üîß –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

**–ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –Ω—É–∂–Ω–æ –ø—Ä–∏:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–∏ MD_Components.xlsx
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–∏ RAW –¥–∞–Ω–Ω—ã—Ö  
- –ò–∑–º–µ–Ω–µ–Ω–∏–∏ –ª–æ–≥–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ 