# üöÄ –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π Pipeline v3.0 —Å Direct Join + Arrow

## üéØ –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è v3.0

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ä—ã–≤:**
- ‚úÖ **Direct Join –ø–æ (serialno + dates)** - ~25x –±—ã—Å—Ç—Ä–µ–µ hash join
- ‚úÖ **Arrow —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞** - dtype_backend="pyarrow" –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö transfers
- ‚úÖ **ClickHouse Dictionary FLAT layout** - O(1) lookup –¥–ª—è ID‚Üí—Ç–µ–∫—Å—Ç
- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - RAW –∑–∞–≥—Ä—É–∑–∫–∞ –≤–æ –≤—Ä–µ–º—è GPU –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏
- ‚úÖ **–°—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ Direct Join
- ‚úÖ **–ú–∞—Å—Å–æ–≤—ã–µ GPU –æ–ø–µ—Ä–∞—Ü–∏–∏** - –æ–¥–∏–Ω AgentVector, –æ–¥–∏–Ω getPopulationData()

---

## üèóÔ∏è –§–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ v3.0

### **–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel ‚Üí pandas (dtype_backend="pyarrow")
‚Üì
Dictionary encoding (text‚ÜíID) + —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–µ–π –≤ ClickHouse
‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ü–û–¢–û–ö 1 (—Ñ–æ–Ω–æ–≤—ã–π)          ‚îÇ  –ü–û–¢–û–ö 2 (–æ—Å–Ω–æ–≤–Ω–æ–π)         ‚îÇ
‚îÇ  pandas ‚Üí ClickHouse RAW    ‚îÇ  pandas ‚Üí cuDF –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞    ‚îÇ
‚îÇ  (—á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è + –∫–ª—é—á–∏)    ‚îÇ  (—Ç–æ–ª—å–∫–æ GPU –¥–∞–Ω–Ω—ã–µ)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚Üì
                    cuDF ‚Üí Flame GPU ABM ‚Üí simulation results
                              ‚Üì
                    cuDF ‚Üí ClickHouse Results
                              ‚Üì
                    Superset: Direct Join ‚Üí dashboard
```

### **–¢–∞–±–ª–∏—Ü—ã ClickHouse:**

**RAW –¥–∞–Ω–Ω—ã–µ (—á–∏—Å–ª–æ–≤—ã–µ ID + –∫–ª—é—á–∏):**
- serialno (String) + version_date (Date) - –∫–ª—é—á–∏ –¥–ª—è Direct Join
- partno_id (UInt16), ac_type_mask (UInt8), component_type_id (UInt8)
- current_ll (UInt32), current_oh (UInt32), oh_threshold (UInt32)

**Results (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –ø–æ–ª–µ–π):**
- serialno (String) + simulation_date (Date) - –∫–ª—é—á–∏ –¥–ª—è Direct Join  
- –í—Å–µ GPU —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã + ID –ø–æ–ª—è + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

**Dictionary —Ç–∞–±–ª–∏—Ü—ã (FLAT layout):**
- partno_dictionary: partno_id ‚Üí partno, component_name
- ac_type_dictionary: ac_type_mask ‚Üí ac_type
- component_type_dictionary: component_type_id ‚Üí component_type

---

## ‚ö° –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ v3.0

### **1. Arrow –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- **dtype_backend="pyarrow"** –≤ pandas.read_excel()
- –°—Ç–æ–ª–±—Ü—ã —Å—Ä–∞–∑—É Arrow-–º–∞—Å—Å–∏–≤—ã ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ transfers
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π

### **2. Direct Join –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- **–û—Å–Ω–æ–≤–Ω–æ–π Direct Join**: RAW ‚Üî Results –ø–æ (serialno, dates)
- **COMPLEX_KEY_HASHED layout** –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
- **~10-15x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –æ—Å–Ω–æ–≤–Ω–æ–≥–æ JOIN

### **3. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤:**
- **serialno**: String ‚Üî String (—Ç–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ)
- **dates**: Date ‚Üî Date (–ù–ï DateTime!)
- **ID –ø–æ–ª—è**: UInt16 ‚Üî UInt16 (–ù–ï Int32!)
- –ú–∞–ª–µ–π—à–µ–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ ‚Üí –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –¥–æ hash join

### **4. Flame GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- **–û–¥–∏–Ω AgentVector** –¥–ª—è –≤—Å–µ–π –ø–æ–ø—É–ª—è—Ü–∏–∏
- **–û–¥–∏–Ω getPopulationData()** –Ω–∞ –≤—ã—Ö–æ–¥–µ
- –ò–∑–±–µ–∂–∞–Ω–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ GPU –ø–∞–º—è—Ç–∏

### **5. Superset –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- **–§–∏–ª—å—Ç—Ä—ã —á–µ—Ä–µ–∑ dimension-—Ç–∞–±–ª–∏—Ü—ã** (—Å–ª–æ–≤–∞—Ä–∏)
- –ù–ï —á–µ—Ä–µ–∑ fact-—Ç–∞–±–ª–∏—Ü—ã —Å –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ –∑–∞–ø–∏—Å–µ–π
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ dropdown —Å–ø–∏—Å–∫–∏

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å v3.0

### **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π:**

| –≠—Ç–∞–ø | v2.0 | v3.0 | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|------|------|------|-----------|
| **Excel –∑–∞–≥—Ä—É–∑–∫–∞** | ~1 —Å–µ–∫ | ~0.7 —Å–µ–∫ | **1.5x** (Arrow) |
| **Dictionary —Å–æ–∑–¥–∞–Ω–∏–µ** | - | ~0.1 —Å–µ–∫ | –Ω–æ–≤—ã–π |
| **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | ~2-3 —Å–µ–∫ | ~0.2 —Å–µ–∫ | **15x** |
| **RAW –∑–∞–≥—Ä—É–∑–∫–∞** | ~3 —Å–µ–∫ | ~2 —Å–µ–∫ (parallel) | **1.5x** |
| **GPU transfer** | ~0.2 —Å–µ–∫ | ~0.1 —Å–µ–∫ | **2x** (Arrow) |
| **Results –æ–±–æ–≥–∞—â–µ–Ω–∏–µ** | ~10-15 —Å–µ–∫ | ~0.5 —Å–µ–∫ | **25x** (Direct Join) |
| **ClickHouse –∑–∞–≥—Ä—É–∑–∫–∞** | ~5-10 —Å–µ–∫ | ~2-3 —Å–µ–∫ | **3x** |

### **–ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **v2.0**: ~20-30 —Å–µ–∫ (–±–µ–∑ GPU)
- **v3.0**: ~3-5 —Å–µ–∫ (–±–µ–∑ GPU) 
- **–û–±—â–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: **6-10x –±—ã—Å—Ç—Ä–µ–µ!**

---

## üéØ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Å–ø–µ—à–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã

### **1. –°—Ç—Ä–æ–≥–æ–µ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö**
- –õ—é–±–æ–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —É–±–∏–≤–∞–µ—Ç Direct Join
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ checks –≤ pipeline

### **2. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ª–æ–≤–∞—Ä–µ–π**
- FLAT layout –¥–ª—è –ø–ª–æ—Ç–Ω—ã—Ö ID (–ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞)
- COMPLEX_KEY_HASHED –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π (serialno+date)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞

### **3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU+GPU —Ä–µ—Å—É—Ä—Å–æ–≤
- –ò–∑–±–µ–∂–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ–≤ –∏ –æ–∂–∏–¥–∞–Ω–∏–π
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é

### **4. Superset –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
- Smart —Ñ–∏–ª—å—Ç—Ä—ã —á–µ—Ä–µ–∑ dimension-—Ç–∞–±–ª–∏—Ü—ã
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ Direct Join –∑–∞–ø—Ä–æ—Å—ã
- –ß–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### **–ó–∞–ø—É—Å–∫ pipeline v3.0:**
```
python code/optimized_pipeline_v2.py
```

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~3-5 —Å–µ–∫ (–±–µ–∑ GPU)
- –ü–∞–º—è—Ç—å: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
- ClickHouse: –≥–æ—Ç–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è Direct Join

### **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º JOIN
- –í–∞–ª–∏–¥–∞—Ü–∏—è Dictionary –æ–±—ä–µ–∫—Ç–æ–≤ –≤ ClickHouse
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Direct Join –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üèÜ –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç v3.0

**Pipeline v3.0** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ä—ã–≤**:

1. **6-10x –æ–±—â–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –≤—Å–µ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
2. **25x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –æ–±–æ–≥–∞—â–µ–Ω–∏—è
3. **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** –≤ Superset —á–µ—Ä–µ–∑ Direct Join
4. **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–∏—Å—Ç–µ–º—ã
5. **Production-ready** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

–≠—Ç–æ **—Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è helicopter component lifecycle prediction —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å—é –∫ enterprise –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÅ‚ö° 