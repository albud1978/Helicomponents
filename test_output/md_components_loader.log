2025-06-24 18:28:48,537 - INFO - üöÄ === –ú–ò–ö–†–û–°–ï–†–í–ò–° –ü–†–Ø–ú–û–ô –ó–ê–ì–†–£–ó–ö–ò MD_COMPONENTS (v3.0) ===
2025-06-24 18:28:48,537 - INFO - üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Excel ‚Üí openpyxl ‚Üí ClickHouse (–ë–ï–ó pandas)
2025-06-24 18:28:48,548 - INFO - ‚úÖ –ö–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∂–µ–Ω: 10.95.19.132:9000/default
2025-06-24 18:28:48,556 - INFO - ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ ClickHouse: 10.95.19.132:9000
2025-06-24 18:28:48,560 - INFO - ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ md_components –≥–æ—Ç–æ–≤–∞
2025-06-24 18:28:48,618 - INFO - üìã Excel —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 31 —Å—Ç—Ä–æ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏
2025-06-24 18:28:48,618 - INFO - üìÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö...
2025-06-24 18:28:48,624 - INFO - ‚úÖ –î–∞—Ç–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ Excel: 2025-06-23
2025-06-24 18:28:48,624 - INFO - ‚ÑπÔ∏è –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è 2006-09-16 –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è (–Ω–µ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞)
2025-06-24 18:28:48,624 - INFO - üìã === –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ú–ï–¢–ê–î–ê–ù–ù–´–• ===
2025-06-24 18:28:48,624 - INFO - üìã –§–∞–π–ª: MD_–°omponents.xlsx
2025-06-24 18:28:48,624 - INFO - üìè –†–∞–∑–º–µ—Ä: 16,628 –±–∞–π—Ç
2025-06-24 18:28:48,625 - INFO - üïê –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –û–°: 2025-06-23 18:46:42.993445
2025-06-24 18:28:48,625 - INFO - üéØ –ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏: Excel modified
2025-06-24 18:28:48,625 - INFO - üìÖ –¢–µ–∫—É—â–∏–π –≥–æ–¥: 2025
2025-06-24 18:28:48,625 - INFO - üóìÔ∏è Excel created: 2006-09-16 - —Å—Ç–∞—Ä—ã–π –≥–æ–¥ (2006)
2025-06-24 18:28:48,625 - INFO - üóìÔ∏è Excel modified: 2025-06-23
2025-06-24 18:28:48,625 - INFO - üóìÔ∏è –í–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö: 2025-06-23
2025-06-24 18:28:48,631 - INFO - üì≠ –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞, –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—É—é –≤–µ—Ä—Å–∏—é
2025-06-24 18:28:48,631 - INFO - üìÇ –ü—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ MD_Components –∏–∑ data_input/master_data/MD_–°omponents.xlsx
2025-06-24 18:28:48,639 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 3: '–ß–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä' -> 'partno'
2025-06-24 18:28:48,640 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 4: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞ –í–°' -> 'comp_number'
2025-06-24 18:28:48,641 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 5: '–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ–±–æ—Ä–æ—Ç–∞' -> 'group_by'
2025-06-24 18:28:48,643 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 6: '–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –∫ —Ç–∏–ø—É –í–°' -> 'effectivity_type'
2025-06-24 18:28:48,644 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 7: '–ó–∞–ø—Ä–µ—Ç –Ω–∞ —Å–º–µ–Ω—É —Ç–∏–ø–∞ –í–°' -> 'type_restricted'
2025-06-24 18:28:48,645 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 8: '–ó–∞–ø—Ä–µ—Ç —Å–æ–≤–º–µ—â–µ–Ω–∏—è –•–í' -> 'effectivity_shaft'
2025-06-24 18:28:48,646 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 9: '–°—Ä–æ–∫ —Ä–∞–∑–±–æ—Ä–∫–∏ –í–°' -> 'partout_time'
2025-06-24 18:28:48,648 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 10: '–°—Ä–æ–∫ —Å–±–æ—Ä–∫–∏ –í–°' -> 'assembly_time'
2025-06-24 18:28:48,649 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 11: '–£—á–µ—Ç –ú–†–† 1' -> 'trigger_interval'
2025-06-24 18:28:48,651 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 12: '–°—Ä–æ–∫ —Ä–µ–º–æ–Ω—Ç–∞' -> 'repair_time'
2025-06-24 18:28:48,653 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 13: '–ù–† –ú–∏-8' -> 'll_mi8'
2025-06-24 18:28:48,654 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 14: '–ú–†–† –ú–∏-8' -> 'oh_mi8'
2025-06-24 18:28:48,655 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 15: '–ú–†–† 1 –ú–∏-8' -> 'oh_threshold_mi8'
2025-06-24 18:28:48,656 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 16: '–ù–† –ú–∏-17' -> 'll_mi17'
2025-06-24 18:28:48,658 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 17: '–ú–†–† –ú–∏-17' -> 'oh_mi17'
2025-06-24 18:28:48,659 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 18: '–¶–µ–Ω–∞ —Ä–µ–º–æ–Ω—Ç–∞ –±–µ–∑ –ù–î–°' -> 'repair_price'
2025-06-24 18:28:48,660 - INFO - üìã –ö–æ–ª–æ–Ω–∫–∞ 19: '–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ –±–µ–∑ –ù–î–°' -> 'purchase_price'
2025-06-24 18:28:48,660 - INFO - üìã –ù–∞–π–¥–µ–Ω–æ 17 –≤–∞–ª–∏–¥–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫: [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
2025-06-24 18:28:48,660 - INFO - üìã –°–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏: ['partno', 'comp_number', 'group_by', 'effectivity_type', 'type_restricted', 'effectivity_shaft', 'partout_time', 'assembly_time', 'trigger_interval', 'repair_time', 'll_mi8', 'oh_mi8', 'oh_threshold_mi8', 'll_mi17', 'oh_mi17', 'repair_price', 'purchase_price']
2025-06-24 18:28:48,660 - INFO - üîç –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫: {'component_name': 2, 'partno': 3, 'qty_per_aircraft': 4, 'group_by': 5, 'effectivity_type': 6, 'type_restricted': 7, 'effectivity_shaft': 8, 'partout_time': 9, 'assembly_time': 10, 'trigger_interval': 11, 'repair_time': 12, 'll_mi8': 13, 'oh_mi8': 14, 'oh_threshold_mi8': 15, 'll_mi17': 16, 'oh_mi17': 17, 'repair_price': 18, 'purchase_price': 19}
2025-06-24 18:28:48,678 - INFO - üìù –°—Ç—Ä–æ–∫–∞ 10: –ú–∏-8–¢ -> –ú–ò-8–¢
–ú–ò-8–ü
–ú–ò-8–ü–°
–ú–ò-8–¢–ü
2025-06-24 18:28:48,691 - INFO - üìù –°—Ç—Ä–æ–∫–∞ 11: –ú–∏-17 -> –ú–ò-8–ê–ú–¢
–ú–ò-8–ú–¢–í
2025-06-24 18:28:48,704 - INFO - üìù –°—Ç—Ä–æ–∫–∞ 12: –¢–í2 -> –¢–í2-117–ê
–¢–í2-117–ê–ì
2025-06-24 18:28:48,724 - INFO - üìù –°—Ç—Ä–æ–∫–∞ 13: –¢–í3 -> –¢–í3-117–í–ú
–¢–í3-117–í–ú –°–ï–†–ò–Ø 02
2025-06-24 18:28:48,737 - INFO - üìù –°—Ç—Ä–æ–∫–∞ 14: –í–†-8 -> –í–†-8–ê
2025-06-24 18:28:49,338 - INFO - üìä –ü—Ä–æ—á–∏—Ç–∞–Ω–æ 30 —Å—Ç—Ä–æ–∫ –∏–∑ Excel
2025-06-24 18:28:49,338 - INFO - üîÑ –ü–æ—Å–ª–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö —è—á–µ–µ–∫: 37 —Å—Ç—Ä–æ–∫
2025-06-24 18:28:49,338 - INFO - üìà –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ: 30 ‚Üí 37 –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ (+7)
2025-06-24 18:28:49,338 - INFO - üöÄ –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä—è–º—É—é –∑–∞–≥—Ä—É–∑–∫—É 37 –∑–∞–ø–∏—Å–µ–π –≤ ClickHouse...
2025-06-24 18:28:49,342 - ERROR - ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ ClickHouse: 'int' object has no attribute 'encode'
2025-06-24 18:28:49,342 - ERROR - üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: 'int' object has no attribute 'encode'
2025-06-24 18:28:49,344 - ERROR - Traceback (most recent call last):
  File "/home/budnik_an/cube linux/cube/code/load_md_components.py", line 766, in main
    if not load_to_clickhouse_direct(client, data_rows, logger):
  File "/home/budnik_an/cube linux/cube/code/load_md_components.py", line 560, in load_to_clickhouse_direct
    client.execute(insert_query, data_rows)
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/client.py", line 376, in execute
    rv = self.process_insert_query(
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/client.py", line 607, in process_insert_query
    rv = self.send_data(sample_block, data,
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/client.py", line 660, in send_data
    self.connection.send_data(block)
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/connection.py", line 688, in send_data
    self.block_out.write(block)
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/streams/native.py", line 48, in write
    write_column(self.context, col_name, col_type, items,
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/columns/service.py", line 167, in write_column
    column.write_data(items, buf)
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/columns/base.py", line 145, in write_data
    self._write_data(items, buf)
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/columns/base.py", line 149, in _write_data
    self.write_items(prepared, buf)
  File "/home/budnik_an/.local/lib/python3.10/site-packages/clickhouse_driver/columns/stringcolumn.py", line 18, in write_items
    buf.write_strings(items, encoding=self.encoding)
  File "clickhouse_driver/bufferedwriter.pyx", line 54, in clickhouse_driver.bufferedwriter.BufferedWriter.write_strings
AttributeError: 'int' object has no attribute 'encode'

