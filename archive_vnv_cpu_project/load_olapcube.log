2025-07-08 17:03:11,995 - INFO - Начинаю вычисление aggregate_count.
2025-07-08 17:03:12,004 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-07-08 17:03:12,007 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-07-08 17:03:12,011 - INFO - monthly_flight_hours: 48.0
2025-07-08 17:03:12,011 - INFO - Вычисленный aggregate_count: 235
2025-07-08 17:03:12,011 - INFO - aggregate_count рассчитан: 235
2025-07-08 17:03:12,012 - INFO - Получаю значения из таблицы Agregat.
2025-07-08 17:03:12,016 - INFO - Получены значения из таблицы Agregat.
2025-07-08 17:03:12,016 - INFO - Получаю daily_flight_hours из flight_hours.
2025-07-08 17:03:12,020 - INFO - Получено daily_flight_hours: 1.58
2025-07-08 17:03:12,020 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-07-08 17:03:12,028 - INFO - Получено 4001 уникальных дат.
2025-07-08 17:03:12,029 - INFO - Сгенерировано 235 серийных номеров.
2025-07-08 17:03:19,563 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-07-08 17:03:19,589 - INFO - Подключение к ClickHouse успешно установлено
2025-07-08 17:03:19,594 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-07-08 17:03:19,605 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-07-08 17:03:19,608 - INFO - Получено значение RepairTime: 120.0
2025-07-08 17:03:19,612 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-07-08 17:03:19,621 - INFO - Подключение к ClickHouse успешно установлено
2025-07-08 17:03:19,632 - INFO - Получено данных из fleet: 12 месяцев
2025-07-08 17:03:19,632 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-07-08 17:03:19,648 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-07-08 17:03:19,648 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-07-08 17:03:19,654 - INFO - Подключение к ClickHouse успешно установлено
2025-07-08 17:03:19,660 - INFO - Получено значение daily_flight_hours: 1.58
2025-07-08 17:03:19,671 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-07-08 17:03:19,672 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-07-08 17:03:19,691 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-07-08 17:03:19,699 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-07-08 17:03:19,699 - INFO - Определено 0 записей с trigger_type=1.
2025-07-08 17:03:19,700 - INFO - Определено 1 записей с trigger_type=0.
2025-07-08 17:03:19,700 - INFO - Нет записей для обновления trigger_type=1.
2025-07-08 17:03:19,705 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-07-08 17:03:19,706 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
