# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Adaptive 2.0

## –î–∞—Ç–∞: 10.01.2026
## –í–µ—Ç–∫–∞: feature/flame-messaging
## –°—Ç–∞—Ç—É—Å: üìê –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –§–∏–ª–æ—Å–æ—Ñ–∏—è

> "–ú—ã –ª—É—á—à–∏–µ –≤ –º–∏—Ä–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ GPU, –Ω–µ —Å–æ–∑–¥–∞—ë–º –∑–∞—É—Ä—è–¥–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤."

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
1. **–ú–∏–Ω–∏–º—É–º —Å—É—â–Ω–æ—Å—Ç–µ–π** ‚Äî –∫–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –æ–¥–Ω–æ –¥–µ–ª–æ —Ö–æ—Ä–æ—à–æ
2. **–õ–∏–º–∏—Ç–µ—Ä—ã –∫–∞–∫ –∞–≥–µ–Ω—Ç—ã** ‚Äî —Å–æ–±—ã—Ç–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —à–∞–≥, –Ω–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
3. **limiter_date –ø—Ä–∏ –≤—Ö–æ–¥–µ** ‚Äî –≥–æ—Ä–∏–∑–æ–Ω—Ç –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
4. **–í–µ—Ä—Ç–∏–∫–∞–ª—å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ** ‚Äî batch ‚Üí transitions ‚Üí quota
5. **–ù–µ—Ç getStepCounter()** ‚Äî —Ç–æ–ª—å–∫–æ current_day –∏–∑ Environment

---

## –¢—Ä–∏ —Ç–∏–ø–∞ –ª–∏–º–∏—Ç–µ—Ä–æ–≤

### 1. RESOURCE_LIMITER (–∞–≥–µ–Ω—Ç—ã –≤ operations)

```
limiter_date = current_day + horizon
horizon = min(
    find_day(cumsum, sne, ll),   // –î–Ω–∏ –¥–æ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è LL
    find_day(cumsum, ppr, oh)    // –î–Ω–∏ –¥–æ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è OH
)
```

**–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è:** –ü—Ä–∏ –≤—Ö–æ–¥–µ –∞–≥–µ–Ω—Ç–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `operations`

### 2. REPAIR_LIMITER (–∞–≥–µ–Ω—Ç—ã –≤ repair)

```
limiter_date = current_day + (repair_time - repair_days)
```

**–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è:** –ü—Ä–∏ –≤—Ö–æ–¥–µ –∞–≥–µ–Ω—Ç–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `repair`

### 3. PROGRAM_LIMITER (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã Mi-8, Mi-17)

```
limiter_date = –¥–µ–Ω—å —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è mp4_ops_counter
```

**–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è:** –ó–∞—Ä–∞–Ω–µ–µ –∏–∑ mp4_ops_counter, —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∞–≥–µ–Ω—Ç–∞—Ö ProgramEvent

---

## –ê–≥–µ–Ω—Ç—ã

### Planer (–æ—Å–Ω–æ–≤–Ω–æ–π –∞–≥–µ–Ω—Ç)

```cuda
struct Planer {
    // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    unsigned int idx;
    unsigned int aircraft_number;
    unsigned char group_by;  // 1=Mi-8, 2=Mi-17
    
    // –†–µ—Å—É—Ä—Å—ã
    unsigned int sne;
    unsigned int ppr;
    unsigned int ll;
    unsigned int oh;
    unsigned int br;
    
    // –†–µ–º–æ–Ω—Ç
    unsigned int repair_days;
    unsigned int repair_time;
    
    // –ö–õ–Æ–ß–ï–í–û–ï: –ª–∏–º–∏—Ç–µ—Ä –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    unsigned int limiter_date;  // –î–µ–Ω—å –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å–æ–±—ã—Ç–∏–µ
    
    // –°–æ—Å—Ç–æ—è–Ω–∏—è: inactive, operations, repair, reserve, storage
};
```

### ProgramEvent (–∞–≥–µ–Ω—Ç-—Å–æ–±—ã—Ç–∏–µ)

```cuda
struct ProgramEvent {
    unsigned int event_day;      // –î–µ–Ω—å —Å–æ–±—ã—Ç–∏—è
    unsigned int target_mi8;     // –ù–æ–≤—ã–π target Mi-8
    unsigned int target_mi17;    // –ù–æ–≤—ã–π target Mi-17
    unsigned char processed;     // 1 = —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω
};
```

**–°–æ–∑–¥–∞—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ** –∏–∑ mp4_ops_counter –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏.

---

## –ú–æ–¥—É–ª–∏ (–≤—Å–µ–≥–æ 5)

### –ú–û–î–£–õ–¨ 1: compute_adaptive_days

```
–í—Ö–æ–¥: limiter_date –≤—Å–µ—Ö Planer –≤ (operations, repair), –≤—Å–µ ProgramEvent
–í—ã—Ö–æ–¥: adaptive_days –≤ Environment

–õ–æ–≥–∏–∫–∞:
1. min_planer = min(limiter_date) –ø–æ –≤—Å–µ–º Planer –≤ ops/repair
2. min_program = min(event_day) –ø–æ –≤—Å–µ–º –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º ProgramEvent
3. adaptive_days = min(min_planer, min_program) - current_day
4. –ó–∞–ø–∏—Å–∞—Ç—å adaptive_days –≤ Environment
```

### –ú–û–î–£–õ–¨ 2: batch_increment

```
–í—Ö–æ–¥: adaptive_days, current_day, mp5_cumsum
–í—ã—Ö–æ–¥: –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ sne/ppr/repair_days

–õ–æ–≥–∏–∫–∞ –¥–ª—è OPERATIONS:
1. delta = cumsum[idx][current_day + adaptive_days] - cumsum[idx][current_day]
2. sne += delta
3. ppr += delta

–õ–æ–≥–∏–∫–∞ –¥–ª—è REPAIR:
1. repair_days += adaptive_days
```

### –ú–û–î–£–õ–¨ 3: transitions

```
–í—Ö–æ–¥: –∞–≥–µ–Ω—Ç—ã –ø–æ—Å–ª–µ batch_increment
–í—ã—Ö–æ–¥: –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π

–ü–æ—Ä—è–¥–æ–∫ (–í–ê–ñ–ù–û!):
1. Repair ‚Üí Reserve (–µ—Å–ª–∏ repair_days >= repair_time)
   - ppr = 0, repair_days = 0
   - limiter_date = MAX (—Ä–µ–∑–µ—Ä–≤ –Ω–µ –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç–µ—Ä–∞)

2. Operations ‚Üí Repair (–µ—Å–ª–∏ ppr >= oh –ò sne < br)
   - limiter_date = current_day + repair_time

3. Operations ‚Üí Storage (–µ—Å–ª–∏ sne >= ll –ò–õ–ò sne >= br)
   - limiter_date = MAX (storage –∫–æ–Ω–µ—á–Ω–æ–µ)
```

### –ú–û–î–£–õ–¨ 4: quota

```
–í—Ö–æ–¥: ProgramEvent –Ω–∞ current_day, –∞–≥–µ–Ω—Ç—ã –≤ operations
–í—ã—Ö–æ–¥: demote/promote

–õ–æ–≥–∏–∫–∞:
1. –ù–∞–π—Ç–∏ ProgramEvent —Å event_day == current_day
2. target = event.target_mi8 (–∏–ª–∏ mi17)
3. curr = count(operations AND group_by == 1)
4. balance = curr - target

5. –ï—Å–ª–∏ balance > 0: demote K —Å—Ç–∞—Ä–µ–π—à–∏—Ö ‚Üí reserve
6. –ï—Å–ª–∏ balance < 0: promote K –∏–∑ (serviceable ‚Üí reserve ‚Üí inactive)

7. –î–ª—è promoted: –≤—ã—á–∏—Å–ª–∏—Ç—å limiter_date
8. –ü–æ–º–µ—Ç–∏—Ç—å ProgramEvent –∫–∞–∫ processed
```

### –ú–û–î–£–õ–¨ 5: mp2_write

```
–í—Ö–æ–¥: –≤—Å–µ –∞–≥–µ–Ω—Ç—ã –ø–æ—Å–ª–µ –º–æ–¥—É–ª–µ–π 1-4
–í—ã—Ö–æ–¥: –∑–∞–ø–∏—Å—å –≤ MacroProperty mp2_buffer

–õ–æ–≥–∏–∫–∞:
- –ó–∞–ø–∏—Å–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –í–°–ï–• –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ current_day
- –í–∫–ª—é—á–∞—è adaptive_days –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
```

---

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     –û–î–ò–ù –®–ê–ì –°–ò–ú–£–õ–Ø–¶–ò–ò                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                 ‚îÇ
‚îÇ  LAYER 0: compute_adaptive_days                                 ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚Ä¢ QuotaManager —á–∏—Ç–∞–µ—Ç –≤—Å–µ limiter_date                         ‚îÇ
‚îÇ  ‚Ä¢ –ù–∞—Ö–æ–¥–∏—Ç min ‚Üí adaptive_days                                  ‚îÇ
‚îÇ  ‚Ä¢ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ Environment                                     ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  LAYER 1: batch_increment                                       ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚Ä¢ Operations: sne += delta, ppr += delta                       ‚îÇ
‚îÇ  ‚Ä¢ Repair: repair_days += adaptive_days                         ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  LAYER 2: transitions                                           ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚Ä¢ Repair ‚Üí Reserve (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–º–æ–Ω—Ç–∞)                        ‚îÇ
‚îÇ  ‚Ä¢ Operations ‚Üí Repair/Storage (–ª–∏–º–∏—Ç—ã)                         ‚îÇ
‚îÇ  ‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ limiter_date –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π                  ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  LAYER 3: quota                                                 ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ ProgramEvent –Ω–∞ current_day                         ‚îÇ
‚îÇ  ‚Ä¢ Demote/Promote –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏                             ‚îÇ
‚îÇ  ‚Ä¢ –í—ã—á–∏—Å–ª–µ–Ω–∏–µ limiter_date –¥–ª—è promoted                         ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  LAYER 4: mp2_write                                             ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚Ä¢ –ó–∞–ø–∏—Å—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ mp2_buffer                                ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  HOST: update current_day                                       ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ              ‚îÇ
‚îÇ  ‚Ä¢ current_day += adaptive_days                                 ‚îÇ
‚îÇ  ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ current_day >= end_day                              ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ö–ª—é—á–µ–≤—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

### INV-1: limiter_date –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

```
–í—Ö–æ–¥ –≤ operations:
  limiter_date = current_day + find_horizon(sne, ppr, ll, oh, cumsum)

–í—Ö–æ–¥ –≤ repair:
  limiter_date = current_day + repair_time

–í—Ö–æ–¥ –≤ reserve/inactive/storage:
  limiter_date = MAX_UINT (–Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ min)
```

### INV-2: adaptive_days = min(–≤—Å–µ limiter_date) - current_day

```
–í—Å–µ–≥–¥–∞ > 0, –≤—Å–µ–≥–¥–∞ —Ü–µ–ª–æ–µ, –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ
```

### INV-3: –ü–µ—Ä–µ—Ö–æ–¥—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ current_day == limiter_date

```
–ê–≥–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –¥—Ä—É–≥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¢–û–õ–¨–ö–û –∫–æ–≥–¥–∞ –µ–≥–æ limiter_date –¥–æ—Å—Ç–∏–≥–Ω—É—Ç
```

### INV-4: ProgramEvent –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑

```
–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏: processed = 1
```

---

## –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

### –ù–∞—á–∞–ª–æ (–î–µ–Ω—å 0)

```
Planers:
  AC 22431 (ops): sne=500000, ll=1080000, limiter_date=480
  AC 22215 (ops): sne=900000, ll=1080000, limiter_date=120 ‚Üê MIN_OPS
  AC 25484 (repair): repair_days=170, repair_time=180, limiter_date=10 ‚Üê MIN

ProgramEvents:
  Day 45: target_mi8=150, target_mi17=100
  Day 180: target_mi8=145, target_mi17=98

compute_adaptive_days:
  min_planer = 10 (AC 25484)
  min_program = 45
  adaptive_days = 10
```

### –ü–æ—Å–ª–µ —à–∞–≥–∞ 1 (–î–µ–Ω—å 10)

```
AC 25484: repair_days=180 >= repair_time ‚Üí –ü–ï–†–ï–•–û–î repair ‚Üí reserve
          limiter_date = MAX

–ù–æ–≤—ã–µ –ª–∏–º–∏—Ç–µ—Ä—ã:
  AC 22215 (ops): limiter_date=110 (–±—ã–ª–æ 120, -10)
  min_planer = 35 (—Å–ª–µ–¥—É—é—â–∏–π repair)
  min_program = 45 - 10 = 35

adaptive_days = 35
```

### –ü–æ—Å–ª–µ —à–∞–≥–∞ 2 (–î–µ–Ω—å 45) ‚Äî Program Event!

```
ProgramEvent Day 45 –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω:
  target_mi8 = 150 (–±—ã–ª–æ 155)
  curr_mi8 = 155
  balance = +5 ‚Üí demote 5 –∞–≥–µ–Ω—Ç–æ–≤

Demoted –∞–≥–µ–Ω—Ç—ã ‚Üí reserve:
  limiter_date = MAX

adaptive_days = —Å–ª–µ–¥—É—é—â–∏–π min(resource, repair, program)
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ 2.0

| –ê—Å–ø–µ–∫—Ç | v1 (baseline) | v3 (–ø—Ä–æ—Ç–æ—Ç–∏–ø) | **v2.0** |
|--------|---------------|---------------|----------|
| –ú–æ–¥—É–ª–µ–π | ~20 | ~15 | **5** |
| –ê–≥–µ–Ω—Ç–æ–≤ | 1 —Ç–∏–ø | 2 —Ç–∏–ø–∞ | **2 —Ç–∏–ø–∞** |
| getStepCounter | ‚úì | ‚úì (–ø—Ä–æ–±–ª–µ–º–∞) | **‚úó** |
| limiter_date | ‚úó | ‚úó | **‚úì** |
| ProgramEvent | ‚úó | ‚úó | **‚úì** |
| –ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | **–í—ã—Å–æ–∫–∞—è** |

---

## –§–∞–π–ª—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `agents_2_0.py` | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤ Planer, ProgramEvent |
| `module_compute_adaptive.py` | –ú–æ–¥—É–ª—å 1: –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ adaptive_days |
| `module_batch_increment.py` | –ú–æ–¥—É–ª—å 2: –±–∞—Ç—á–µ–≤—ã–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã |
| `module_transitions.py` | –ú–æ–¥—É–ª—å 3: –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π |
| `module_quota.py` | –ú–æ–¥—É–ª—å 4: –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `module_mp2_write.py` | –ú–æ–¥—É–ª—å 5: –∑–∞–ø–∏—Å—å –≤ MP2 |
| `orchestrator_2_0.py` | –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä |
| `precompute_program_events.py` | –°–æ–∑–¥–∞–Ω–∏–µ ProgramEvent –∏–∑ mp4 |

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. [ ] –°–æ–∑–¥–∞—Ç—å `precompute_program_events.py` ‚Äî –∏–∑–≤–ª–µ—á—å —Å–æ–±—ã—Ç–∏—è –∏–∑ mp4_ops_counter
2. [ ] –°–æ–∑–¥–∞—Ç—å `agents_2_0.py` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è Planer –∏ ProgramEvent
3. [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `module_compute_adaptive.py` —Å limiter_date
4. [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `module_batch_increment.py` —Å cumsum
5. [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `module_transitions.py` —Å –ø–µ—Ä–µ—Å—á—ë—Ç–æ–º limiter_date
6. [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `module_quota.py` —Å ProgramEvent
7. [ ] –°–æ–∑–¥–∞—Ç—å `orchestrator_2_0.py`
8. [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

---

**–ê–≤—Ç–æ—Ä:** –ê–ª–µ–∫—Å–µ–π (–∫–æ–Ω—Ü–µ–ø—Ü–∏—è), AI (–¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è)
**–î–∞—Ç–∞:** 10.01.2026

