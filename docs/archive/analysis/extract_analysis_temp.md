# –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ extract_master.py –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤

*–í—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ Extract*

## üöÄ Extract Master - –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Extract Master

`extract_master.py` - —ç—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—Å–µ–≥–æ ETL –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π:

1. **–£–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å—é** - –∏–∑–≤–ª–µ–∫–∞–µ—Ç –µ–¥–∏–Ω—É—é `version_date` –∏–∑ `Status_Components.xlsx`
2. **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ —Å —É—á–µ—Ç–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å —ç—Ç–∞–ø–æ–≤ –∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
4. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞**:
   - **–¢–ï–°–¢** - –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
   - **–ü–†–û–î** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π –¥–∞–Ω–Ω—ã—Ö

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Extract Master

```python
EXTRACT_PIPELINE = [
    # 14 —ç—Ç–∞–ø–æ–≤ –≤ —Å—Ç—Ä–æ–≥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    # –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –∏–º–µ–µ—Ç: script, description, dependencies, result_table, critical
]
```

## üìä –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ —ç—Ç–∞–ø–∞–º

### **–≠–¢–ê–ü 1: md_components_loader.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel: MD_–°omponents.xlsx (–ª–∏—Å—Ç "–ê–≥—Ä–µ–≥–∞—Ç—ã") 
  ‚Üí pandas DataFrame 
  ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö 
  ‚Üí ClickHouse: md_components
```

**–ß–∏—Ç–∞–µ–º—ã–µ –ø–æ–ª—è –∏–∑ Excel:**
- –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –ª–∏—Å—Ç–∞ "–ê–≥—Ä–µ–≥–∞—Ç—ã" (header=1)
- –£–¥–∞–ª—è–µ—Ç—Å—è —Å–ª—É–∂–µ–±–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ "–°—á–µ—Ç"

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è –≤ –°–£–ë–î:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–±—Ä–∞–±–æ—Ç–∫–∞ | –¢–∏–ø –≤ –ë–î |
|------|----------|-----------|----------|
| partno | Excel | –û—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫ | Nullable(String) |
| comp_number | Excel | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —á–∏—Å–ª–æ, –¥–∏–∞–ø–∞–∑–æ–Ω 0-255 | Nullable(UInt8) |
| group_by | Excel | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —á–∏—Å–ª–æ, –¥–∏–∞–ø–∞–∑–æ–Ω 0-255 | Nullable(UInt8) |
| ac_type_mask | Excel | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —á–∏—Å–ª–æ, –º–∞—Å–∫–∏ 32/64/96 | Nullable(UInt8) |
| ll_mi8, ll_mi17 | Excel | **–ß–∞—Å—ã ‚Üí –º–∏–Ω—É—Ç—ã (√ó60)** | Nullable(UInt32) |
| oh_mi8, oh_mi17 | Excel | **–ß–∞—Å—ã ‚Üí –º–∏–Ω—É—Ç—ã (√ó60)** | Nullable(UInt32) |
| repair_price | Excel | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Float32 | Nullable(Float32) |
| sne_new, ppr_new | Excel | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ UInt32 | Nullable(UInt32) |
| restrictions_mask | –†–∞—Å—á–µ—Ç | type_restricted + common_restricted1√ó2 + common_restricted2√ó4 + trigger_interval√ó8 | UInt8 |

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- –í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –∏–∑ `extract_unified_version_date()`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π —Å –¥–∏–∞–ª–æ–≥–æ–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –¥–ª—è GPU-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç—ã—Ö –ø–æ–ª–µ–π: br_mi8, br_mi17, partno_comp

---

### **–≠–¢–ê–ü 2: status_overhaul_loader.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel: Status_Overhaul.xlsx 
  ‚Üí pandas DataFrame 
  ‚Üí –ü–∞—Ä—Å–∏–Ω–≥ —Ä—É—Å—Å–∫–∏—Ö –¥–∞—Ç 
  ‚Üí ClickHouse: status_overhaul
```

**–ß–∏—Ç–∞–µ–º—ã–µ –ø–æ–ª—è –∏–∑ Excel:**
- –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ (header=0)
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –¥–∞—Ç —Ñ–æ—Ä–º–∞—Ç–∞ '05.—Ñ–µ–≤—Ä..2024'

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è –≤ –°–£–ë–î:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–±—Ä–∞–±–æ—Ç–∫–∞ | –¢–∏–ø –≤ –ë–î |
|------|----------|-----------|----------|
| ac_registr | Excel | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —á–∏—Å–ª–æ | UInt32 |
| ac_typ | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |
| wpno | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |
| sched_start_date | Excel | –ü–∞—Ä—Å–∏–Ω–≥ —Ä—É—Å—Å–∫–∏—Ö –¥–∞—Ç | Nullable(Date) |
| sched_end_date | Excel | –ü–∞—Ä—Å–∏–Ω–≥ —Ä—É—Å—Å–∫–∏—Ö –¥–∞—Ç | Nullable(Date) |
| act_start_date | Excel | –ü–∞—Ä—Å–∏–Ω–≥ —Ä—É—Å—Å–∫–∏—Ö –¥–∞—Ç | Nullable(Date) |
| act_end_date | Excel | –ü–∞—Ä—Å–∏–Ω–≥ —Ä—É—Å—Å–∫–∏—Ö –¥–∞—Ç | Nullable(Date) |
| status | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Ä—É—Å—Å–∫–∏—Ö –º–µ—Å—è—Ü–µ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç —Å fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
- –í–∞–ª–∏–¥–∞—Ü–∏—è: –ø–æ–¥—Å—á–µ—Ç –∑–∞–ø–∏—Å–µ–π –ø–æ —Ç–∏–ø–∞–º –í–° –∏ —Å—Ç–∞—Ç—É—Å–∞–º

---

### **–≠–¢–ê–ü 3: program_ac_loader.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel: Program_AC.xlsx 
  ‚Üí pandas DataFrame 
  ‚Üí –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ 
  ‚Üí ClickHouse: program_ac
```

**–ß–∏—Ç–∞–µ–º—ã–µ –ø–æ–ª—è –∏–∑ Excel:**
- –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ (header=0)
- –£–¥–∞–ª—è–µ—Ç—Å—è —Å–ª—É–∂–µ–±–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ "–°—á–µ—Ç"

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è –≤ –°–£–ë–î:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–±—Ä–∞–±–æ—Ç–∫–∞ | –¢–∏–ø –≤ –ë–î |
|------|----------|-----------|----------|
| ac_registr | Excel | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —á–∏—Å–ª–æ | UInt32 |
| ac_typ | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |
| object_type | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |
| owner | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |
| operator | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |
| homebase | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |
| directorate | Excel | –û—á–∏—Å—Ç–∫–∞ –æ—Ç nan/None | String |

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤
- –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º –í–° –∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–∏—Ä–µ–∫—Ü–∏—è–º

---

### **–≠–¢–ê–ü 4: dual_loader.py (—Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π)**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel: Status_Components.xlsx 
  ‚Üí pandas DataFrame 
  ‚Üí –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ md_components.partno 
  ‚Üí –û–±–æ–≥–∞—â–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∏ –Ω–æ–º–µ—Ä–∞–º–∏ –í–° 
  ‚Üí ClickHouse: heli_raw + heli_pandas
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
1. Excel Status_Components.xlsx (–æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
2. md_components (—Å–ø–∏—Å–æ–∫ –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
3. status_overhaul (—á–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã)
4. program_ac (—á–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã)

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è –≤ heli_pandas:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–±—Ä–∞–±–æ—Ç–∫–∞ | –¢–∏–ø –≤ –ë–î |
|------|----------|-----------|----------|
| partno-ppr | Excel | –ë–∞–∑–æ–≤—ã–µ –ø–æ–ª—è –∫–∞–∫ –µ—Å—Ç—å | –†–∞–∑–ª–∏—á–Ω—ã–µ |
| lease_restricted | Excel | 'Y'/'1' ‚Üí 1, –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Üí 0 | UInt8 |
| oh, ll, sne, ppr | Excel | –ß–∏—Å–ª–æ–≤—ã–µ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π | Nullable(UInt32) |
| aircraft_number | location —á–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ RA-XXXXX | UInt32 |
| status_id | –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã | –õ–æ–≥–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ 1-6 | UInt8 |
| repair_days | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è | None (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–∑–∂–µ) | Nullable(UInt16) |
| ac_type_mask | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è | 0 (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —ç—Ç–∞–ø–æ–º 5) | UInt8 |
| group_by | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è | 0 (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —ç—Ç–∞–ø–æ–º 11) | UInt8 |

**–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã:**
1. **aircraft_number_processor** - –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–æ–º–µ—Ä –í–° –∏–∑ –ø–æ–ª—è location (RA-XXXXX)
2. **overhaul_status_processor** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç status_id=4 –¥–ª—è –í–° –≤ —Ä–µ–º–æ–Ω—Ç–µ
3. **program_ac_status_processor** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç status_id=2 –¥–ª—è –í–° –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ + precheck D1
4. **inactive_planery_processor** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç status_id=1 –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ set() –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø–∞–º—è—Ç–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è —Å—Ö–µ–º—ã –ë–î

---

### **–≠–¢–ê–ü 5: enrich_heli_pandas.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: heli_pandas.ac_typ 
  ‚Üí –ú–∞–ø–ø–∏–Ω–≥ —Ç–∏–ø–æ–≤ –í–° –Ω–∞ –±–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ 
  ‚Üí UPDATE heli_pandas.ac_type_mask
```

**–ß–∏—Ç–∞–µ–º—ã–µ –ø–æ–ª—è:**
- heli_pandas.ac_typ - —Ç–∏–ø—ã –í–° –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞
- dict_ac_type_flat (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) - —Å–ª–æ–≤–∞—Ä—å –º–∞—Å–æ–∫

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ | –ó–Ω–∞—á–µ–Ω–∏—è |
|------|------------------|----------|
| ac_type_mask | –ú–∞–ø–ø–∏–Ω–≥ ac_typ ‚Üí –±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ | 2, 4, 8, 16, 32, 64, 128 |

**–•–∞—Ä–¥–∫–æ–¥ –±–∏—Ç–æ–≤—ã—Ö –º–∞—Å–æ–∫:**
- –ú–ò-8 —Å–µ–º–µ–π—Å—Ç–≤–æ ‚Üí 32
- –ú–ò-17 —Å–µ–º–µ–π—Å—Ç–≤–æ ‚Üí 64  
- –ú–ò-26 ‚Üí 128
- Airbus/Robinson ‚Üí 2-16

---

### **–≠–¢–ê–ü 6: calculate_beyond_repair.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: md_components (—Ü–µ–Ω—ã, —Ä–µ—Å—É—Ä—Å—ã) 
  ‚Üí –†–∞—Å—á–µ—Ç BR –ø–æ —Ñ–æ—Ä–º—É–ª–µ 
  ‚Üí UPDATE md_components.br_mi8/br_mi17
```

**–ß–∏—Ç–∞–µ–º—ã–µ –ø–æ–ª—è:**
- repair_price, purchase_price - —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- ll_mi8/mi17, oh_mi8/mi17 - —Ä–µ—Å—É—Ä—Å—ã (—É–∂–µ –≤ –º–∏–Ω—É—Ç–∞—Ö)

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –§–æ—Ä–º—É–ª–∞ | –ï–¥–∏–Ω–∏—Ü—ã |
|------|---------|---------|
| br_mi8 | ll - (repair_price / ((purchase_price - repair_price) / ll + repair_price / oh)) | –ú–∏–Ω—É—Ç—ã |
| br_mi17 | –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –ú–ò-17 | –ú–∏–Ω—É—Ç—ã |

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Ä–æ–≥–∞ —Å–ø–∏—Å–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ repair_price >= purchase_price ‚Üí br = 0
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: 0 ‚â§ br ‚â§ ll
- –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç: br –≤—Å–µ–≥–¥–∞ ‚â§ ll

---

### **–≠–¢–ê–ü 7: md_components_enricher.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: dict_partno_flat 
  ‚Üí –ú–∞–ø–ø–∏–Ω–≥ partno ‚Üí partseqno_i 
  ‚Üí UPDATE md_components.partno_comp
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- dict_partno_flat - —Å–ª–æ–≤–∞—Ä—å –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ —Å ID –∏–∑ AMOS
- md_components.partno - –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|------------|
| partno_comp | dict_partno_flat.partseqno_i | ID –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è —Å–≤—è–∑–∏ —Å heli_pandas |

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- CASE WHEN –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞
- –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è: –æ–±—ã—á–Ω–æ >80% –ø–æ–∫—Ä—ã—Ç–∏–µ

---

### **–≠–¢–ê–ü 8: dictionary_creator.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: heli_pandas (DISTINCT –∑–Ω–∞—á–µ–Ω–∏—è) 
  ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ 6 —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü 
  ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ Dictionary –æ–±—ä–µ–∫—Ç–æ–≤
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- heli_pandas - –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–∞—Å–∫–∏ —Ç–∏–ø–æ–≤ –í–°
- –•–∞—Ä–¥–∫–æ–¥ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–°–æ–∑–¥–∞–≤–∞–µ–º—ã–µ —Å–ª–æ–≤–∞—Ä–∏:**

| –°–ª–æ–≤–∞—Ä—å | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö | –ö–ª—é—á ‚Üí –ó–Ω–∞—á–µ–Ω–∏–µ | –¢–∏–ø |
|---------|-----------------|-----------------|-----|
| dict_partno_flat | heli_pandas | partseqno_i ‚Üí partno | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π |
| dict_serialno_flat | heli_pandas | psn ‚Üí (partno, serialno) | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π |
| dict_owner_flat | heli_pandas | address_i ‚Üí owner | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π |
| dict_ac_type_flat | –•–∞—Ä–¥–∫–æ–¥ –º–∞—Å–æ–∫ | ac_type_mask ‚Üí ac_typ | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π |
| dict_status_flat | –•–∞—Ä–¥–∫–æ–¥ —Å—Ç–∞—Ç—É—Å–æ–≤ | status_id ‚Üí status_name | –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–π |
| dict_aircraft_number_flat | heli_pandas + JOIN | aircraft_number ‚Üí (formatted, registration, ac_type_mask) | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π |

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- –í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –±–µ—Ä–µ—Ç—Å—è –∏–∑ heli_pandas
- –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ
- dict_status_flat –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è
- –°–æ–∑–¥–∞–Ω–∏–µ Dictionary –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è dictGet()

---

### **–≠–¢–ê–ü–´ 9-10: –¢–µ–Ω–∑–æ—Ä—ã –ø—Ä–æ–≥—Ä–∞–º–º**

#### **–≠–¢–ê–ü 9: program_fl_direct_loader.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel: Program.xlsx (–ª–∏—Å—Ç "2025") 
  ‚Üí –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–≥—Ä–∞–º–º 
  ‚Üí –†–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 4000 –¥–Ω–µ–π 
  ‚Üí ClickHouse: flight_program_fl
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- Excel —Å –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –ø–æ–ª–µ—Ç–æ–≤
- dict_aircraft_number_flat - –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|------|----------|-----------|
| aircraft_number | Excel serialno ‚Üí —Å–ª–æ–≤–∞—Ä—å | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –Ω–æ–º–µ—Ä –í–° |
| dates | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è | 4000 –¥–Ω–µ–π –æ—Ç version_date |
| daily_hours | Excel | –ß–∞—Å—ã ‚Üí –º–∏–Ω—É—Ç—ã (√ó60) |
| ac_type_mask | –°–ª–æ–≤–∞—Ä—å –ø–æ aircraft_number | –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ |

#### **–≠–¢–ê–ü 10: program_ac_direct_loader.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
Excel: Program_heli.xlsx 
  ‚Üí –ü–∞—Ä—Å–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ü–∏–π –í–° 
  ‚Üí –ü–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ 
  ‚Üí ClickHouse: flight_program_ac
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- Excel —Å –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- heli_pandas - –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|------|----------|-----------|
| dates | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è | 4000 –¥–Ω–µ–π |
| ops_counter_mi8/mi17 | Excel | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–Ω—è–º –º–µ—Å—è—Ü–∞ |
| new_counter_mi17 | Excel | –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ |
| trigger_program_* | –†–∞—Å—á–µ—Ç | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è |
| ops_counter_total | –†–∞—Å—á–µ—Ç | –°—É–º–º–∞ mi8 + mi17 |

---

### **–≠–¢–ê–ü 11: heli_pandas_group_by_enricher.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: md_components.partno_comp + heli_pandas.partseqno_i 
  ‚Üí JOIN –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è group_by 
  ‚Üí UPDATE heli_pandas.group_by
```

**–ß–∏—Ç–∞–µ–º—ã–µ –ø–æ–ª—è:**
- md_components: partno_comp, group_by
- heli_pandas: partseqno_i

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –õ–æ–≥–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏—è |
|------|--------|----------|
| group_by | –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ md_components —á–µ—Ä–µ–∑ JOIN | 1 (–ú–ò-8), 2 (–ú–ò-17), –¥—Ä—É–≥–∏–µ |

---

### **–≠–¢–ê–ü 12: program_ac_precheck_runner.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: heli_pandas + flight_program_fl + md_components.br_* 
  ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ D1 
  ‚Üí UPDATE heli_pandas.status_id
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- heli_pandas: status_id=2, —Ä–µ—Å—É—Ä—Å—ã, group_by
- flight_program_fl: daily_hours –Ω–∞ D1
- md_components: br_mi8/br_mi17

**–û–±–Ω–æ–≤–ª—è–µ–º—ã–µ –∑–∞–ø–∏—Å–∏:**
| –£—Å–ª–æ–≤–∏–µ | –ù–æ–≤—ã–π status_id | –ü—Ä–∏—á–∏–Ω–∞ |
|---------|-----------------|---------|
| –û—Å—Ç–∞—Ç–æ–∫ < D1 –∏ > BR | 6 (—Ö—Ä–∞–Ω–µ–Ω–∏–µ) | –†–µ—Å—É—Ä—Å –∫–æ–Ω—á–∏—Ç—Å—è –Ω–∞ D1 |
| –û—Å—Ç–∞—Ç–æ–∫ < D1 –∏ ‚â§ BR | 4 (—Ä–µ–º–æ–Ω—Ç) | –î–æ—Å—Ç–∏–≥–Ω—É—Ç BR |

---

### **–≠–¢–ê–ü 13: digital_values_dictionary_creator.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: DESCRIBE –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü Extract 
  ‚Üí –°–±–æ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π 
  ‚Üí dict_digital_values_flat
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö 12 —Ç–∞–±–ª–∏—Ü Extract —á–µ—Ä–µ–∑ DESCRIBE TABLE

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|------------|
| field_id | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID 1-65535 |
| primary_table | –ê–Ω–∞–ª–∏–∑ | –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª—è |
| field_name | DESCRIBE | –ò–º—è –ø–æ–ª—è |
| data_type | DESCRIBE | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö ClickHouse |
| is_nullable | DESCRIBE | –ú–æ–∂–µ—Ç –ª–∏ –±—ã—Ç—å NULL |

---

### **–≠–¢–ê–ü 14: repair_days_calculator.py**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ClickHouse: heli_pandas (status_id=4) + md_components.repair_time 
  ‚Üí –†–∞—Å—á–µ—Ç –¥–Ω–µ–π —Ä–µ–º–æ–Ω—Ç–∞ 
  ‚Üí UPDATE heli_pandas.repair_days
```

**–ß–∏—Ç–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- heli_pandas: serialno, target_date, partseqno_i (–≥–¥–µ status_id=4)
- md_components: repair_time –ø–æ partno_comp

**–ó–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–µ –ø–æ–ª—è:**
| –ü–æ–ª–µ | –§–æ—Ä–º—É–ª–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|----------|
| repair_days | repair_time - (target_date - version_date) | –î–Ω–∏ —Ä–µ–º–æ–Ω—Ç–∞ —É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–µ |

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- –¢–æ–ª—å–∫–æ –¥–ª—è –í–° –≤ —Å—Ç–∞—Ç—É—Å–µ 4 (—Ä–µ–º–æ–Ω—Ç)
- –ü–æ–∏—Å–∫ repair_time —á–µ—Ä–µ–∑ partseqno_i = partno_comp
- –ï—Å–ª–∏ repair_time –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí repair_days –æ—Å—Ç–∞–µ—Ç—Å—è NULL

## üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª–µ–π —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –ø–æ –≤—Å–µ–º —Å–∫—Ä–∏–ø—Ç–∞–º Extract

### **–ú–∞—Ç—Ä–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –°–£–ë–î**

| –°–∫—Ä–∏–ø—Ç | –ß–∏—Ç–∞–µ—Ç –∏–∑ –°–£–ë–î | –ü–∏—à–µ—Ç –≤ –°–£–ë–î | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|--------|----------------|--------------|-------------|
| **1. md_components_loader** | - | md_components | ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–π |
| **2. status_overhaul_loader** | - | status_overhaul | ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–π |
| **3. program_ac_loader** | - | program_ac | ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–π |
| **4. dual_loader** | md_components, status_overhaul, program_ac | heli_raw, heli_pandas | ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–π |
| **5. enrich_heli_pandas** | heli_pandas, dict_ac_type_flat | heli_pandas (UPDATE) | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **6. calculate_beyond_repair** | md_components | md_components (UPDATE) | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **7. md_components_enricher** | md_components, dict_partno_flat | md_components (UPDATE) | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **8. dictionary_creator** | heli_pandas, md_components | dict_*_flat (6 —Ç–∞–±–ª–∏—Ü) | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **9. program_fl_direct_loader** | dict_aircraft_number_flat | flight_program_fl | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **10. program_ac_direct_loader** | heli_pandas, md_components | flight_program_ac | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **11. heli_pandas_group_by_enricher** | md_components, heli_pandas | heli_pandas (UPDATE) | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **12. program_ac_precheck_runner** | heli_pandas, md_components, flight_program_fl | heli_pandas (UPDATE) | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **13. digital_values_dictionary_creator** | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü | dict_digital_values_flat | ‚ùå –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π |
| **14. repair_days_calculator** | md_components, heli_pandas, status_overhaul | heli_pandas (UPDATE) | ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–π |

### **–î–µ—Ç–∞–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–ª–µ–π —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏**

#### **–°–∫—Ä–∏–ø—Ç 1: md_components_loader.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | Excel MD_–°omponents.xlsx | –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –ª–∏—Å—Ç–∞ "–ê–≥—Ä–µ–≥–∞—Ç—ã" | header=1, —É–¥–∞–ª–µ–Ω–∏–µ "–°—á–µ—Ç" |
| **–ü–ò–®–ï–¢** | md_components | partno, comp_number, group_by, ac_type_mask, type_restricted, common_restricted1/2, trigger_interval, partout_time, assembly_time, repair_time, ll_mi8/mi17, oh_mi8/mi17, oh_threshold_mi8, repair_price, purchase_price, sne_new, ppr_new, version_date, version_id, restrictions_mask | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤, —á–∞—Å—ã‚Üí–º–∏–Ω—É—Ç—ã –¥–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤ |

#### **–°–∫—Ä–∏–ø—Ç 2: status_overhaul_loader.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | Excel Status_Overhaul.xlsx | ac_registr, ac_typ, wpno, description, sched/act –¥–∞—Ç—ã, status, owner, operator | –ü–∞—Ä—Å–∏–Ω–≥ —Ä—É—Å—Å–∫–∏—Ö –¥–∞—Ç |
| **–ü–ò–®–ï–¢** | status_overhaul | –í—Å–µ –ø–æ–ª—è –∏–∑ Excel + version_date, version_id | Date –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è |

#### **–°–∫—Ä–∏–ø—Ç 3: program_ac_loader.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | Excel Program_AC.xlsx | ac_registr, ac_typ, object_type, description, owner, operator, homebase, homebase_name, directorate | –£–¥–∞–ª–µ–Ω–∏–µ "–°—á–µ—Ç" |
| **–ü–ò–®–ï–¢** | program_ac | –í—Å–µ –ø–æ–ª—è –∏–∑ Excel + version_date, version_id | String –æ—á–∏—Å—Ç–∫–∞ |

#### **–°–∫—Ä–∏–ø—Ç 4: dual_loader.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | Excel Status_Components.xlsx | partno, serialno, ac_typ, location, mfg/removal/target_date, condition, owner, lease_restricted, oh, oh_threshold, ll, sne, ppr, partseqno_i, psn, address_i, ac_type_i | –í—Å–µ –ø–æ–ª—è |
| **–ß–ò–¢–ê–ï–¢** | md_components | partno | –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ |
| **–ß–ò–¢–ê–ï–¢** | status_overhaul | ac_registr, sched/act –¥–∞—Ç—ã, status | –ß–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã |
| **–ß–ò–¢–ê–ï–¢** | program_ac | ac_registr, ac_typ | –ß–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã |
| **–ü–ò–®–ï–¢** | heli_raw | –í—Å–µ –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è | –ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ |
| **–ü–ò–®–ï–¢** | heli_pandas | –í—Å–µ –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è + status_id, repair_days (init), aircraft_number, ac_type_mask (init), group_by (init) | –° —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ–º |

#### **–°–∫—Ä–∏–ø—Ç 5: enrich_heli_pandas.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | heli_pandas | ac_typ | –î–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ |
| **–ß–ò–¢–ê–ï–¢** | dict_ac_type_flat | ac_type_mask, ac_typ | –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |
| **–ü–ò–®–ï–¢** | heli_pandas | ac_type_mask | UPDATE –ø–æ ac_typ |

#### **–°–∫—Ä–∏–ø—Ç 6: calculate_beyond_repair.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | md_components | ll_mi8/mi17, oh_mi8/mi17, repair_price, purchase_price | –î–ª—è —Ä–∞—Å—á–µ—Ç–∞ |
| **–ü–ò–®–ï–¢** | md_components | br_mi8, br_mi17 | UPDATE —Å —Ñ–æ—Ä–º—É–ª–æ–π BR |

#### **–°–∫—Ä–∏–ø—Ç 7: md_components_enricher.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | dict_partno_flat | partseqno_i, partno | –°–ª–æ–≤–∞—Ä—å ID |
| **–ß–ò–¢–ê–ï–¢** | md_components | partno | –î–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ |
| **–ü–ò–®–ï–¢** | md_components | partno_comp | UPDATE —á–µ—Ä–µ–∑ CASE WHEN |

#### **–°–∫—Ä–∏–ø—Ç 8: dictionary_creator.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | heli_pandas | DISTINCT: partseqno_i, partno, psn, serialno, address_i, owner, ac_typ, aircraft_number, ac_type_mask | –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è |
| **–ß–ò–¢–ê–ï–¢** | md_components | group_by | –î–ª—è —Å–ª–æ–≤–∞—Ä—è aircraft_number |
| **–ü–ò–®–ï–¢** | dict_partno_flat | partseqno_i, partno, version_date, version_id, load_timestamp | –ê–¥–¥–∏—Ç–∏–≤–Ω–æ |
| **–ü–ò–®–ï–¢** | dict_serialno_flat | psn, partno, serialno, version_date, version_id, load_timestamp | –ê–¥–¥–∏—Ç–∏–≤–Ω–æ |
| **–ü–ò–®–ï–¢** | dict_owner_flat | address_i, owner, version_date, version_id, load_timestamp | –ê–¥–¥–∏—Ç–∏–≤–Ω–æ |
| **–ü–ò–®–ï–¢** | dict_ac_type_flat | ac_type_mask, ac_typ, version_date, version_id, load_timestamp | –ê–¥–¥–∏—Ç–∏–≤–Ω–æ |
| **–ü–ò–®–ï–¢** | dict_status_flat | status_id, status_name, load_timestamp | –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å |
| **–ü–ò–®–ï–¢** | dict_aircraft_number_flat | aircraft_number, formatted_number, registration_code, is_leading_zero, ac_type_mask, version_date, version_id, load_timestamp | –ê–¥–¥–∏—Ç–∏–≤–Ω–æ |

#### **–°–∫—Ä–∏–ø—Ç 9: program_fl_direct_loader.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | Excel Program.xlsx | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º –ø–æ–ª–µ—Ç–æ–≤ | –ü–∞—Ä—Å–∏–Ω–≥ —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã |
| **–ß–ò–¢–ê–ï–¢** | dict_aircraft_number_flat | aircraft_number, ac_type_mask | –î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |
| **–ü–ò–®–ï–¢** | flight_program_fl | aircraft_number, dates, daily_hours, ac_type_mask, version_date, version_id | 4000 –¥–Ω–µ–π √ó 279 –í–° |

#### **–°–∫—Ä–∏–ø—Ç 10: program_ac_direct_loader.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | Excel Program_heli.xlsx | ops_counter_*, new_counter_* | –ü–æ –º–µ—Å—è—Ü–∞–º |
| **–ß–ò–¢–ê–ï–¢** | heli_pandas | status_id (–¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏) | –ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç—É—Å–∞ 2 |
| **–ü–ò–®–ï–¢** | flight_program_ac | dates, ops_counter_mi8/mi17/total, new_counter_mi17, trigger_program_mi8/mi17/total, version_date, version_id | 4000 –¥–Ω–µ–π |

#### **–°–∫—Ä–∏–ø—Ç 11: heli_pandas_group_by_enricher.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | md_components | partno_comp, group_by | –ò—Å—Ç–æ—á–Ω–∏–∫ group_by |
| **–ß–ò–¢–ê–ï–¢** | heli_pandas | partseqno_i | –î–ª—è JOIN |
| **–ü–ò–®–ï–¢** | heli_pandas | group_by | UPDATE —á–µ—Ä–µ–∑ JOIN |

#### **–°–∫—Ä–∏–ø—Ç 12: program_ac_precheck_runner.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | heli_pandas | serialno, status_id, ll, oh, sne, ppr, partseqno_i, ac_typ, aircraft_number, group_by | –ì–¥–µ status_id=2 –∏ group_by IN (1,2) |
| **–ß–ò–¢–ê–ï–¢** | flight_program_fl | daily_hours (–Ω–∞ D1) | –ü–æ aircraft_number |
| **–ß–ò–¢–ê–ï–¢** | md_components | br_mi8, br_mi17 | –ß–µ—Ä–µ–∑ JOIN –ø–æ partseqno_i |
| **–ü–ò–®–ï–¢** | heli_pandas | status_id | UPDATE: 2‚Üí6 –∏–ª–∏ 2‚Üí4 |

#### **–°–∫—Ä–∏–ø—Ç 13: digital_values_dictionary_creator.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | system.columns | table, name, type, is_in_partition_key, is_in_sorting_key, is_in_primary_key, is_in_sampling_key | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ |
| **–ü–ò–®–ï–¢** | dict_digital_values_flat | field_id, primary_table, field_name, field_description, data_type, is_nullable, version_date, version_id, load_timestamp | –ê–¥–¥–∏—Ç–∏–≤–Ω–æ |

#### **–°–∫—Ä–∏–ø—Ç 14: repair_days_calculator.py**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü–æ–ª—è | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|----------|------|-----------|
| **–ß–ò–¢–ê–ï–¢** | heli_pandas | serialno, target_date, version_date, partseqno_i | –ì–¥–µ status_id=4 |
| **–ß–ò–¢–ê–ï–¢** | md_components | partno_comp, repair_time | –ü–æ partseqno_i |
| **–ü–ò–®–ï–¢** | heli_pandas | repair_days | UPDATE –ø–æ —Ñ–æ—Ä–º—É–ª–µ |

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Extract

### **1. –ï–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å**
- –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é `version_date` –∏–∑ `Status_Components.xlsx`
- Extract Master –ø–µ—Ä–µ–¥–∞–µ—Ç –≤–µ—Ä—Å–∏—é —á–µ—Ä–µ–∑ CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `--version-date`, `--version-id`
- –°–ª–æ–≤–∞—Ä–∏ –ø–æ–ª—É—á–∞—é—Ç –≤–µ—Ä—Å–∏—é –∏–∑ `heli_pandas` —á–µ—Ä–µ–∑ `get_version_from_heli_pandas()`

### **2. –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å —ç—Ç–∞–ø–æ–≤**
- **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ —ç—Ç–∞–ø—ã (1-4, 14)**: –ü—Ä–∏ –æ—à–∏–±–∫–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω
- **–ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ —ç—Ç–∞–ø—ã (5-13)**: –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–∞–π–ø–ª–∞–π–Ω –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º

### **3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ `dual_loader` —á–µ—Ä–µ–∑ set() –≤–º–µ—Å—Ç–æ —Å–ø–∏—Å–∫–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é
- –ë–∞—Ç—á–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ INSERT –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

### **4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
- **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü**: –ß–∞—Å—ã ‚Üí –º–∏–Ω—É—Ç—ã –¥–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤ (√ó60)
- **–ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏**: –¢–∏–ø—ã –í–° –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –¥–ª—è GPU –æ–ø–µ—Ä–∞—Ü–∏–π
- **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è GPU (UInt8/16/32 –≤–º–µ—Å—Ç–æ Float64)

### **5. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏**
- `md_components` –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –ø–µ—Ä–≤—ã–º (—Ñ–∏–ª—å—Ç—Ä –¥–ª—è `dual_loader`)
- –°–ª–æ–≤–∞—Ä–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ—Å–ª–µ `heli_pandas` (–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö)
- `repair_days_calculator` –≤ –∫–æ–Ω—Ü–µ (–Ω—É–∂–Ω—ã –≤—Å–µ –æ–±–æ–≥–∞—â–µ–Ω–∏—è)
- `program_ac_precheck_runner` –ø–æ—Å–ª–µ `flight_program_fl` –∏ `group_by`

### **6. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –≤ dual_loader**
–ù–µ —è–≤–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏, –∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —ç—Ç–∞–ø 4:
- aircraft_number_processor
- overhaul_status_processor
- program_ac_status_processor  
- inactive_planery_processor

### **7. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, >80% –¥–ª—è —Å–ª–æ–≤–∞—Ä–µ–π)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, br ‚â§ ll)

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Extract —Å–∏—Å—Ç–µ–º—ã

- **14 —Å–∫—Ä–∏–ø—Ç–æ–≤** –≤ —Å—Ç—Ä–æ–≥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **14 —Ç–∞–±–ª–∏—Ü –°–£–ë–î** —Å–æ–∑–¥–∞–µ—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- **~2.4M –∑–∞–ø–∏—Å–µ–π** –≤ heli_pandas (–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞)
- **279 –í–°** –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
- **~1.1M –∑–∞–ø–∏—Å–µ–π** –≤ —Ç–µ–Ω–∑–æ—Ä–µ flight_program_fl
- **6 —Å–ª–æ–≤–∞—Ä–µ–π** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ Flame GPU

–í—Å—è —Å–∏—Å—Ç–µ–º–∞ Extract –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ - `extract_master.py`.

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 15 —Å–µ–Ω—Ç—è–±—Ä—è 2025*