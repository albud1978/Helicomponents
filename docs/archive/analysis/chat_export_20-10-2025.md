# –ß–∞—Ç-—ç–∫—Å–ø–æ—Ä—Ç: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–∏–∫–∏ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ approve —Ñ–ª–∞–≥–æ–≤ (20.10.2025)

**–î–∞—Ç–∞:** 20 –æ–∫—Ç—è–±—Ä—è 2025  
**–£—á–∞—Å—Ç–Ω–∏–∫:** –ê–ª–µ–∫—Å–µ–π (–≤–µ–¥—É—â–∏–π —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ü–û)  
**–¢–µ–º–∞:** –ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–µ–º–æ—É—Ç, P1/P2/P3) –∏ approve –±—É—Ñ–µ—Ä–æ–≤

---

## –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç–∏—è

### 1. –û—à–∏–±–∫–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ P1 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–¥—Å—á—ë—Ç–∞ `used` –∏–∑ –¥–µ–º–æ—É—Ç–∞ –≤ P1.

**–ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ —á—Ç–æ –¥–µ–º–æ—É—Ç –∏ P1 —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–†–µ–∞–ª—å–Ω–æ—Å—Ç—å:**
- –î–µ–º–æ—É—Ç –∏ P1 **–ù–ò–ö–û–ì–î–ê** –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- `balance > 0` ‚Üí –¥–µ–º–æ—É—Ç, –∑–∞—Ç–µ–º **EARLY EXIT** –¥–ª—è P1/P2/P3
- `balance ‚â§ 0` ‚Üí P1/P2/P3 —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞—Å–∫–∞–¥–Ω–æ
- **XOR —Å–≤–æ–π—Å—Ç–≤–æ:** –¥–µ–º–æ—É—Ç XOR (P1 ‚à® P2 ‚à® P3)

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω—ã used –∏–∑ P1, –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ `deficit = target - curr`

### 2. –¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è: Intent vs Approve

**–ü—Ä–∞–≤–∏–ª–æ:** –õ–æ–≥–∏—Ä—É—é—Ç—Å—è **approve —Ñ–ª–∞–≥–∏** (–≤—ã–±–æ—Ä—ã), –∞ –Ω–µ intent —Ñ–ª–∞–≥–∏ (–Ω–∞–º–µ—Ä–µ–Ω–∏—è).

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è |
|-----------|-----------|-----------|
| `intent_state` | –ù–∞–º–µ—Ä–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å | –î–∞, –≤ mp2_intent_state |
| `approve[]` | –î–µ–º–æ—É—Ç –≤—ã–±—Ä–∞–Ω | –î–∞, –≤ mp2_quota_demount |
| `approve_s3[]` | P1 –≤—ã–±—Ä–∞–Ω | –î–∞, –≤ mp2_quota_promote_p1 |
| `approve_s5[]` | P2 –≤—ã–±—Ä–∞–Ω | –î–∞, –≤ mp2_quota_promote_p2 |
| `approve_s1[]` | P3 –≤—ã–±—Ä–∞–Ω | –î–∞, –≤ mp2_quota_promote_p3 |

### 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ COUNT_OPS

**–°–ª–æ–π 1: RESET (idx=0)**
- –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –±–æ—Ä—Ç –æ–±–Ω—É–ª—è–µ—Ç –±—É—Ñ–µ—Ä—ã
- `idx` ‚Äî –∏–Ω–¥–µ–∫—Å –≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ (0-285)
- –ù–µ "–ø–µ—Ä–≤—ã–π –∞–≥–µ–Ω—Ç", –∞ "–ø–µ—Ä–≤—ã–π –±–æ—Ä—Ç" –ø–æ –ø–æ—Ä—è–¥–∫—É –Ω–æ–º–µ—Ä–æ–≤

**–°–ª–æ–∏ 2-5:** –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞—é—Ç –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º
- `ops_count[idx]` ‚Äî –µ—Å—Ç—å –ª–∏ –±–æ—Ä—Ç –≤ operations
- `svc_count[idx]` ‚Äî –µ—Å—Ç—å –ª–∏ –±–æ—Ä—Ç –≤ serviceable
- –ò —Ç.–¥.

### 4. QUOTA_OPS_EXCESS (–î–µ–º–æ—É—Ç)

**–õ–æ–≥–∏–∫–∞:**
```
1. –ü–æ–¥—Å—á—ë—Ç curr = sum(ops_count[])
2. –ß—Ç–µ–Ω–∏–µ target = mp4_ops_counter[day+1]
3. balance = curr - target

4. –ï–°–õ–ò balance ‚â§ 0 ‚Üí EARLY EXIT
   ‚îî‚îÄ –í—Å–µ –∞–≥–µ–Ω—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   ‚îî‚îÄ –ü–µ—Ä–µ—Ö–æ–¥—è—Ç –∫ P1 (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è P1/P2/P3)

5. –ï–°–õ–ò balance > 0 ‚Üí –î–µ–º–æ—É—Ç K = balance —Å—Ç–∞—Ä—ã—Ö
   ‚îú‚îÄ –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ: oldest_first
   ‚îú‚îÄ –î–ª—è —Ç–æ–ø-K: intent=3, approve[idx]=1
   ‚îî‚îÄ –ó–ê–í–ï–†–®–ï–ù–û —ç—Ç–æ—Ç –¥–µ–Ω—å
```

**–ö–ª—é—á:** "–ü–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ P1" –æ–∑–Ω–∞—á–∞–µ—Ç "–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π P1", –∞ –Ω–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥.

### 5. Cascading –≤ P1/P2/P3

**P1:** `deficit_p1 = target - curr`

**P2:** 
```
used_p1 = sum(approve_s3[])  // –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç P1
deficit_p2 = target - curr - used_p1  // –í—ã—á–µ—Å—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –≤ P1
```

**P3:**
```
used_total = sum(approve_s3[]) + sum(approve_s5[])  // P1 + P2
deficit_p3 = target - curr - used_total
```

**–ü–æ—á–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- P1 –ø–æ–º–µ—á–∞–µ—Ç `approve_s3[idx] = 1`
- P2 —á–∏—Ç–∞–µ—Ç –±—É—Ñ–µ—Ä `approve_s3[]` ‚Üí –≤—ã—á–∏—Ç–∞–µ—Ç –∏–∑ –¥–µ—Ñ–∏—Ü–∏—Ç–∞
- P3 —á–∏—Ç–∞–µ—Ç –û–ë–ê –±—É—Ñ–µ—Ä–∞ ‚Üí –≤—ã—á–∏—Ç–∞–µ—Ç –æ–±–∞
- –ù–µ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞

### 6. –ü—Ä–∞–≤–∏–ª–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ .cursorrules:**

```
### –¢—Ä–µ–±—É–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å —Ä–∞–±–æ—Ç—ã
- –í—ã –≤–µ–¥—É—â–∏–π –º–∏—Ä–æ–≤–æ–π —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ü–û
- –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–∏—Å—Ç–µ–º
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π
- –û—Ç–∫–∞–∑ –æ—Ç —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è

### –ü—Ä–∞–≤–∏–ª–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –û—à–∏–±–∫–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã
- –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞ ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —É—Ä–æ–∫

### –ü—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞
1. –ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
4. –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É
5. –°–∫–µ–ø—Ç–∏—á–Ω—ã–π –≤–∑–≥–ª—è–¥ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
```

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –Ω–∞ 3650 –¥–Ω–µ–π

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ–º–æ—É—Ç–æ–≤
- **–í—Å–µ–≥–æ –¥–µ–º–æ—É—Ç–æ–≤:** 63,801 (6.12%)
- **Mi-8 –¥–µ–º–æ—É—Ç–æ–≤:** 42,920
- **Mi-17 –¥–µ–º–æ—É—Ç–æ–≤:** 20,881
- **–ù–∞—á–∞–ª–æ –¥–Ω—è:** 180 (–∫–æ–≥–¥–∞ –ø–æ—è–≤–∏–ª—Å—è –¥–µ—Ñ–∏—Ü–∏—Ç)

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- –î–Ω–∏ 0-179: 0 –¥–µ–º–æ—É—Ç–æ–≤ (–Ω–µ—Ç –∏–∑–±—ã—Ç–∫–∞)
- –î–Ω–∏ 180-3649: –¥–µ–º–æ—É—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –¥–Ω—è–º

### –ü—Ä–∏–º–µ—Ä AC 22482
- –î–µ–Ω—å 180: `quota_demount=1, state=serviceable, intent=3`
- –î–Ω–∏ 181+: cold holding (–∂–¥–µ—Ç —Ä–µ—à–µ–Ω–∏—è P1)

---

## –í—ã–≤–æ–¥—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
1. COUNT_OPS —Å RESET —Å–ª–æ–µ–º
2. QUOTA_OPS_EXCESS (–¥–µ–º–æ—É—Ç –ø—Ä–∏ balance > 0)
3. QUOTA_PROMOTE –∫–∞—Å–∫–∞–¥–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º
4. MP2 –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ approve —Ñ–ª–∞–≥–æ–≤
5. –ü–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ v3 —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ —Å –∫–æ–¥–æ–º

### üîë –ö–ª—é—á–µ–≤—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã
1. **XOR:** –¥–µ–º–æ—É—Ç XOR (P1 ‚à® P2 ‚à® P3)
2. **Early exit:** –ü—Ä–∏ balance > 0 —Ñ—É–Ω–∫—Ü–∏–∏ P1/P2/P3 –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
3. **Cascading:** P2 —á–∏—Ç–∞–µ—Ç P1, P3 —á–∏—Ç–∞–µ—Ç P1+P2
4. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:** –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- docs/validation.md ‚Äî –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª —Å –ø–æ–ª–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º
- .cursorrules ‚Äî –ø—Ä–∞–≤–∏–ª–∞ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- docs/rtc_pipeline_architecture.md ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ v3 —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö PRODUCTION

