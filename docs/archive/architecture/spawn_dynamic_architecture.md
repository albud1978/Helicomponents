# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn –ø–ª–∞–Ω–µ—Ä–æ–≤ –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –¥–µ—Ñ–∏—Ü–∏—Ç–∞

**–î–∞—Ç–∞:** 08.11.2025  
**–í–µ—Ä—Å–∏—è:** 1.0 (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

---

## üìã –ö–û–ù–¢–ï–ö–°–¢ –ò –ó–ê–î–ê–ß–ê

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

**–î–≤–∞ —Ç–∏–ø–∞ spawn:**
1. ‚úÖ **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn** (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω) ‚Äî –ø–æ –ø–ª–∞–Ω—É –∏–∑ MP4:
   - –ò—Å—Ç–æ—á–Ω–∏–∫: `mp4_new_counter_mi17_seed[day]` (PropertyArray –∏–∑ ClickHouse)
   - –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ `seed[day] > 0` ‚Üí —Å–æ–∑–¥–∞—ë–º —Ä–æ–≤–Ω–æ `seed[day]` –∞–≥–µ–Ω—Ç–æ–≤
   - –ú–æ–º–µ–Ω—Ç: –∫–æ–Ω–µ—Ü –¥–Ω—è (—Å–ª–æ–π 14 –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ)
   - –°–æ—Å—Ç–æ—è–Ω–∏–µ: `serviceable&intent=3` (holding, –∂–¥—É—Ç —Ä–µ—à–µ–Ω–∏—è)

2. ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn** (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω) ‚Äî –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –¥–µ—Ñ–∏—Ü–∏—Ç–∞:
   - –ò—Å—Ç–æ—á–Ω–∏–∫: —Ä–∞—Å—á—ë—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –ø–æ—Å–ª–µ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è P1/P2/P3
   - –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ `deficit > 0` –ø–æ—Å–ª–µ P3 ‚Üí —Å–æ–∑–¥–∞—ë–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
   - –ú–æ–º–µ–Ω—Ç: **–ü–û–°–õ–ï P3, –Ω–æ –î–û state_manager** (–Ω–æ–≤—ã–π —Å–ª–æ–π 7.5)
   - –°–æ—Å—Ç–æ—è–Ω–∏–µ: **`operations`** (–ù–ï–ú–ï–î–õ–ï–ù–ù–û–ï –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–µ—Ñ–∏—Ü–∏—Ç–∞, –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫)
   - –£—Å–ª–æ–≤–∏–µ: `step_day >= repair_time` (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ P3)

### –ü—Ä–æ–±–ª–µ–º–∞

**–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```
–°–ª–æ–π 7: quota_promote_inactive (P3)
  ‚îú‚îÄ –ü—Ä–æ–º–æ—É—Ç –≥–æ—Ç–æ–≤—ã—Ö inactive ‚Üí operations
  ‚îú‚îÄ –ú–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è deficit > 0 (–¥–æ–ø—É—Å—Ç–∏–º–æ)
  ‚îî‚îÄ –ü–æ—Å–ª–µ P3 –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ó–ê–ö–ê–ù–ß–ò–í–ê–ï–¢–°–Ø ‚ùå

–°–ª–æ–π 8: state_manager_operations
  ‚îî‚îÄ –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã 1‚Üí2, 3‚Üí2, 5‚Üí2
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
```
–°–ª–æ–π 7: quota_promote_inactive (P3)
  ‚îî‚îÄ –ü—Ä–æ–º–æ—É—Ç –≥–æ—Ç–æ–≤—ã—Ö inactive

–°–ª–æ–π 7.5: spawn_dynamic (–†–ï–ê–õ–ò–ó–û–í–ê–ù) ‚Üê –ó–î–ï–°–¨!
  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞: deficit > 0 –ø–æ—Å–ª–µ P3?
  ‚îú‚îÄ –£—Å–ª–æ–≤–∏–µ: step_day >= repair_time
  ‚îî‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ ‚Üí operations (–ù–ï–ú–ï–î–õ–ï–ù–ù–û)

–°–ª–æ–π 8: state_manager_operations
  ‚îî‚îÄ –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã (–≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤)
```

---

## üéØ –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –†–ï–®–ï–ù–ò–Ø

### 1. –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ frames

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ—Ç—ã –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn

**–†–µ—à–µ–Ω–∏–µ:**

```python
# –í sim_env_setup.py

# –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ (–¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ spawn):
first_reserved_idx = 279  # –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∞–≥–µ–Ω—Ç
total_spawn_planned = sum(mp4_new_counter_mi17_seed)  # –ò–∑ MP4 –ø–ª–∞–Ω–∞

# –ù–û–í–ê–Ø –ª–æ–≥–∏–∫–∞ (–¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn):
# –ü—Ä–æ–≥–Ω–æ–∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –∑–∞ 10 –ª–µ—Ç
max_deficit_estimate = calculate_max_deficit_reserve(
    target_ops=mp4_ops_counter_mi17,  # –¶–µ–ª–µ–≤—ã–µ –∫–≤–æ—Ç—ã
    initial_population=279,            # –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–ø—É–ª—è—Ü–∏—è
    repair_time=180,                   # –í—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞
    simulation_days=3650               # –ì–æ—Ä–∏–∑–æ–Ω—Ç —Å–∏–º—É–ª—è—Ü–∏–∏
)

# –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ:
frames_total = (
    279                      # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞–≥–µ–Ω—Ç—ã (163 Mi-8 + 116 Mi-17)
    + total_spawn_planned    # –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn –∏–∑ MP4
    + max_deficit_estimate   # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn (—Ä–µ–∑–µ—Ä–≤)
)

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–ª—è Mi-17 (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):
frames_total_mi17 = (
    116                      # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–ª–∞–Ω–µ—Ä—ã Mi-17
    + 6                      # –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn (–∏–∑ MP4: 2025-10-15)
    + 50                     # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn (–ø–æ —Ñ–æ—Ä–º—É–ª–µ LL)
) # = 172 —Å–ª–æ—Ç–∞

# –î–∏–∞–ø–∞–∑–æ–Ω—ã –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è Mi-17:
# ‚Ä¢ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ:           idx = [0, 115]
# ‚Ä¢ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn: idx = [116, 121]
# ‚Ä¢ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn:      idx = [122, 171]
```

**–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á—ë—Ç–∞ —Ä–µ–∑–µ—Ä–≤–∞ (–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∞–≥—Ä–µ–≥–∞—Ç–æ–≤):**

```python
def calculate_max_deficit_reserve(
    initial_population: int,
    ll_minutes: int,
    avg_daily_minutes: float,
    simulation_days: int = 3650
) -> int:
    """
    –ü—Ä–æ–≥–Ω–æ–∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ —á–µ—Ä–µ–∑ –≤—ã—Ä–∞–±–æ—Ç–∫—É —Ä–µ—Å—É—Ä—Å–∞ LL
    
    –õ–æ–≥–∏–∫–∞ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∞–≥—Ä–µ–≥–∞—Ç–∞–º):
    1. –°—É–º–º–∞—Ä–Ω—ã–π –Ω–∞–ª—ë—Ç –≤—Å–µ—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥
    2. –î–µ–ª–µ–Ω–∏–µ –Ω–∞ LL ‚Üí —Å–∫–æ–ª—å–∫–æ –ø–ª–∞–Ω–µ—Ä–æ–≤ –≤—ã—Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ—Å—É—Ä—Å
    3. –ó–∞–ø–∞—Å –ø—Ä–æ—á–Ω–æ—Å—Ç–∏ 20%
    4. –ú–∏–Ω–∏–º—É–º 50 —Å–ª–æ—Ç–æ–≤
    """
    # 1. –°—É–º–º–∞—Ä–Ω—ã–π –Ω–∞–ª—ë—Ç –∑–∞ –ø–µ—Ä–∏–æ–¥
    total_flight_minutes = initial_population * simulation_days * avg_daily_minutes
    
    # 2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã—Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ—Å—É—Ä—Å
    planers_consumed = total_flight_minutes / ll_minutes
    
    # 3. –° –∑–∞–ø–∞—Å–æ–º –ø—Ä–æ—á–Ω–æ—Å—Ç–∏ 20%
    planers_needed = planers_consumed * 1.2
    
    # 4. –†–µ–∑–µ—Ä–≤–Ω—ã–µ —Å–ª–æ—Ç—ã (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º, –µ—Å–ª–∏ LL –±–æ–ª—å—à–æ–π)
    reserve_slots = max(50, int(planers_needed - initial_population))
    
    return reserve_slots
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Mi-17 (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ ClickHouse):**

**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–ø—É–ª—è—Ü–∏—è: 116 –ø–ª–∞–Ω–µ—Ä–æ–≤
- LL Mi-17: **1,080,000 –º–∏–Ω—É—Ç** (18,000 —á–∞—Å–æ–≤)
- –°—Ä–µ–¥–Ω–∏–π —Å—É—Ç–æ—á–Ω—ã–π –Ω–∞–ª—ë—Ç: **110.5 –º–∏–Ω—É—Ç/–¥–µ–Ω—å** (1.8 —á–∞—Å–æ–≤/–¥–µ–Ω—å)
- –ü–µ—Ä–∏–æ–¥ —Å–∏–º—É–ª—è—Ü–∏–∏: 3650 –¥–Ω–µ–π (10 –ª–µ—Ç)

**–†–∞—Å—á—ë—Ç:**
1. –°—É–º–º–∞—Ä–Ω—ã–π –Ω–∞–ª—ë—Ç –∑–∞ 10 –ª–µ—Ç:
   - 116 √ó 3650 √ó 110.5 = **46,770,617 –º–∏–Ω—É—Ç** (779,510 —á–∞—Å–æ–≤)

2. –ü–ª–∞–Ω–µ—Ä–æ–≤ –≤—ã—Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ—Å—É—Ä—Å:
   - 46,770,617 / 1,080,000 = **43.31 –ø–ª–∞–Ω–µ—Ä–∞**

3. –° –∑–∞–ø–∞—Å–æ–º –ø—Ä–æ—á–Ω–æ—Å—Ç–∏ 20%:
   - 43.31 √ó 1.2 = **51.97 –ø–ª–∞–Ω–µ—Ä–æ–≤**

4. –†–µ–∑–µ—Ä–≤–Ω—ã–µ —Å–ª–æ—Ç—ã:
   - max(50, 51.97 - 116) = max(50, -64.03) = **50 —Å–ª–æ—Ç–æ–≤** (–º–∏–Ω–∏–º—É–º)

5. **–ò–¢–û–ì–û frames –¥–ª—è Mi-17:**
   - 116 (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ) + 50 (—Ä–µ–∑–µ—Ä–≤) = **166 —Å–ª–æ—Ç–æ–≤**

**–í—ã–≤–æ–¥:** 
- –ó–∞ 10 –ª–µ—Ç –≤—ã—Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ—Å—É—Ä—Å ~43 –ø–ª–∞–Ω–µ—Ä–∞ (37% –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–ø—É–ª—è—Ü–∏–∏)
- –†–µ–∑–µ—Ä–≤ 50 —Å–ª–æ—Ç–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –¥–µ—Ñ–∏—Ü–∏—Ç–∞ —Å –∑–∞–ø–∞—Å–æ–º
- LL Mi-17 –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π (18,000 —á–∞—Å–æ–≤), –ø–æ—ç—Ç–æ–º—É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–ª–∞–Ω–µ—Ä–æ–≤ –Ω–µ –≤—ã—Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ—Å—É—Ä—Å –∑–∞ 10 –ª–µ—Ç

---

### 2. –ù–æ–≤—ã–π RTC –º–æ–¥—É–ª—å: `rtc_spawn_dynamic.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –ø–æ—Å–ª–µ P3

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```python
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ spawn_v2.py)

1. –ê–≥–µ–Ω—Ç—ã-—É—Ç–∏–ª–∏—Ç—ã:
   - spawn_dynamic_mgr (1 —ç–∫–∑–µ–º–ø–ª—è—Ä) ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –¥–µ—Ñ–∏—Ü–∏—Ç–∞
   - spawn_dynamic_ticket (16 —Ç–∏–∫–µ—Ç–æ–≤) ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ

2. RTC —Ñ—É–Ω–∫—Ü–∏–∏:
   - rtc_spawn_dynamic_mgr ‚Äî —Ä–∞—Å—á—ë—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - rtc_spawn_dynamic_ticket ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤

3. MacroProperty –º–∞—Å—Å–∏–≤—ã (–ø–æ –¥–Ω—è–º):
   - spawn_dynamic_need_u32[MAX_DAYS]
   - spawn_dynamic_base_idx_u32[MAX_DAYS]
   - spawn_dynamic_base_acn_u32[MAX_DAYS]
   - spawn_dynamic_base_psn_u32[MAX_DAYS]
```

**–õ–æ–≥–∏–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞:**

```cuda
FLAMEGPU_AGENT_FUNCTION(rtc_spawn_dynamic_mgr, ...) {
    const unsigned int day = FLAMEGPU->getStepCounter();
    const unsigned int repair_time = FLAMEGPU->environment.getProperty<unsigned int>("mi17_repair_time_const");
    
    // ‚úÖ –£–°–õ–û–í–ò–ï: –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è repair_time —Å –Ω–∞—á–∞–ª–∞ —Å–∏–º—É–ª—è—Ü–∏–∏
    if (day < repair_time) {
        // –°–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ ‚Äî –≤—ã—Ö–æ–¥
        return flamegpu::ALIVE;
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // –®–ê–ì 1: –ü–æ–¥—Å—á—ë—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ P3)
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    // 1.1. –¢–µ–∫—É—â–∏–µ –≤ operations (curr)
    unsigned int curr = 0u;
    auto ops_count = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_FRAMES>("mi17_ops_count");
    for (unsigned int i = 0u; i < frames; ++i) {
        if (ops_count[i] == 1u) ++curr;
    }
    
    // 1.2. –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –∏–∑ P1/P2/P3 (used)
    unsigned int used = 0u;
    
    auto approve_s3 = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_FRAMES>("mi17_approve_s3");
    for (unsigned int i = 0u; i < frames; ++i) {
        if (approve_s3[i] == 1u) ++used;
    }
    
    auto approve_s5 = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_FRAMES>("mi17_approve_s5");
    for (unsigned int i = 0u; i < frames; ++i) {
        if (approve_s5[i] == 1u) ++used;
    }
    
    auto approve_s1 = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_FRAMES>("mi17_approve_s1");
    for (unsigned int i = 0u; i < frames; ++i) {
        if (approve_s1[i] == 1u) ++used;
    }
    
    // 1.3. –¶–µ–ª–µ–≤–∞—è –∫–≤–æ—Ç–∞ (target)
    const unsigned int safe_day = ((day + 1u) < days_total ? (day + 1u) : (days_total - 1u));
    const unsigned int target = FLAMEGPU->environment.getProperty<unsigned int>("mp4_ops_counter_mi17", safe_day);
    
    // 1.4. –†–∞—Å—á—ë—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞
    const int deficit = (int)target - (int)curr - (int)used;
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // –®–ê–ì 2: –ï—Å–ª–∏ –¥–µ—Ñ–∏—Ü–∏—Ç > 0 ‚Üí spawn
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    unsigned int need = 0u;
    if (deficit > 0) {
        need = (unsigned int)deficit;
        
        printf("  [SPAWN DYNAMIC Day %u] DEFICIT=%d, target=%u, curr=%u, used=%u ‚Üí SPAWN %u agents\\n",
               day, deficit, target, curr, used, need);
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // –®–ê–ì 3: –ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ spawn
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    unsigned int next_idx = FLAMEGPU->getVariable<unsigned int>("next_idx");
    unsigned int next_acn = FLAMEGPU->getVariable<unsigned int>("next_acn");
    unsigned int next_psn = FLAMEGPU->getVariable<unsigned int>("next_psn");
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—É—Ä—Å–æ—Ä–æ–≤ –≤ –¥–µ–Ω—å 0
    if (day == 0u) {
        const unsigned int first_dynamic_idx = FLAMEGPU->environment.getProperty<unsigned int>("first_dynamic_idx");
        if (next_idx < first_dynamic_idx) next_idx = first_dynamic_idx;
        if (next_acn < 200000u) next_acn = 200000u;  // –û—Ç–¥–µ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö
        const unsigned int spawn_psn = FLAMEGPU->environment.getProperty<unsigned int>("spawn_partseqno_mi17");
        if (next_psn < spawn_psn) next_psn = spawn_psn;
    }
    
    // –ü—É–±–ª–∏–∫—É–µ–º –≤ MacroProperty –º–∞—Å—Å–∏–≤—ã
    auto need_mp = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_DAYS>("spawn_dynamic_need_u32");
    auto bidx_mp = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_DAYS>("spawn_dynamic_base_idx_u32");
    auto bacn_mp = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_DAYS>("spawn_dynamic_base_acn_u32");
    auto bpsn_mp = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_DAYS>("spawn_dynamic_base_psn_u32");
    
    need_mp[safe_day].exchange(need);
    bidx_mp[safe_day].exchange(next_idx);
    bacn_mp[safe_day].exchange(next_acn);
    bpsn_mp[safe_day].exchange(next_psn);
    
    // –°–¥–≤–∏–≥–∞–µ–º –∫—É—Ä—Å–æ—Ä—ã
    next_idx += need;
    next_acn += need;
    next_psn += need;
    
    FLAMEGPU->setVariable<unsigned int>("next_idx", next_idx);
    FLAMEGPU->setVariable<unsigned int>("next_acn", next_acn);
    FLAMEGPU->setVariable<unsigned int>("next_psn", next_psn);
    
    return flamegpu::ALIVE;
}
```

**–õ–æ–≥–∏–∫–∞ —Ç–∏–∫–µ—Ç–∞:**

```cuda
FLAMEGPU_AGENT_FUNCTION(rtc_spawn_dynamic_ticket, ...) {
    const unsigned int day = FLAMEGPU->getStepCounter();
    const unsigned int days_total = FLAMEGPU->environment.getProperty<unsigned int>("days_total");
    const unsigned int frames_total = FLAMEGPU->environment.getProperty<unsigned int>("frames_total");
    const unsigned int safe_day = (day < days_total ? day : (days_total - 1u));
    
    // –ß–∏—Ç–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ MacroProperty –º–∞—Å—Å–∏–≤–æ–≤
    auto need_mp = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_DAYS>("spawn_dynamic_need_u32");
    auto bidx_mp = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_DAYS>("spawn_dynamic_base_idx_u32");
    auto bacn_mp = FLAMEGPU->environment.getMacroProperty<unsigned int, MAX_DAYS>("spawn_dynamic_base_acn_u32");
    
    const unsigned int need = need_mp[safe_day];
    const unsigned int base_idx = bidx_mp[safe_day];
    const unsigned int base_acn = bacn_mp[safe_day];
    
    const unsigned int ticket = FLAMEGPU->getVariable<unsigned int>("ticket");
    if (ticket >= need) return flamegpu::ALIVE;
    
    const unsigned int idx = base_idx + ticket;
    if (idx >= frames_total) return flamegpu::ALIVE;
    
    const unsigned int acn = base_acn + ticket;
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ spawn_v2.py)
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    FLAMEGPU->agent_out.setVariable<unsigned int>("idx", idx);
    FLAMEGPU->agent_out.setVariable<unsigned int>("aircraft_number", acn);
    
    // ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–∫ –≤ spawn_v2.py)
    
    // ‚úÖ –ö–õ–Æ–ß–ï–í–û–ï –û–¢–õ–ò–ß–ò–ï: intent=0 (—É–∂–µ –≤ operations, –Ω–µ—Ç intent)
    FLAMEGPU->agent_out.setVariable<unsigned int>("intent_state", 0u);  // –ù–µ—Ç intent!
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    if (ticket == 0u) {
        printf("  [SPAWN DYNAMIC Day %u] Creating %u agents: idx %u-%u, acn %u-%u (DIRECT to operations)\\n",
               day, need, base_idx, base_idx + need - 1u, base_acn, base_acn + need - 1u);
    }
    
    return flamegpu::ALIVE;
}
```

---

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø–∞–π–ø–ª–∞–π–Ω

**–¢–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫ –º–æ–¥—É–ª–µ–π:**

```
–°–ª–æ–π 1:  state_2_operations
–°–ª–æ–π 2:  states_stub
–°–ª–æ–π 3:  count_ops
–°–ª–æ–π 4:  quota_ops_excess
–°–ª–æ–π 5:  quota_promote_serviceable (P1)
–°–ª–æ–π 6:  quota_promote_reserve (P2)
–°–ª–æ–π 7:  quota_promote_inactive (P3)
–°–ª–æ–π 8:  state_manager_operations
...
–°–ª–æ–π 14: spawn_v2 (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
```

**–ù–û–í–´–ô –ø–æ—Ä—è–¥–æ–∫:**

```
–°–ª–æ–π 1:  state_2_operations
–°–ª–æ–π 2:  states_stub
–°–ª–æ–π 3:  count_ops
–°–ª–æ–π 4:  quota_ops_excess
–°–ª–æ–π 5:  quota_promote_serviceable (P1)
–°–ª–æ–π 6:  quota_promote_reserve (P2)
–°–ª–æ–π 7:  quota_promote_inactive (P3)

–°–ª–æ–π 7.5: spawn_dynamic (–ù–û–í–´–ô) ‚Üê –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–µ—Ñ–∏—Ü–∏—Ç–∞
  ‚îú‚îÄ spawn_dynamic_mgr (—Ä–∞—Å—á—ë—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞)
  ‚îî‚îÄ spawn_dynamic_ticket (—Å–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤)

–°–ª–æ–π 8:  state_manager_operations
...
–°–ª–æ–π 14: spawn_v2 (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
```

**–ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –¥–µ–Ω—å D:**

```
1. count_ops ‚Üí –ø–æ–¥—Å—á—ë—Ç curr
2. quota_ops_excess ‚Üí –¥–µ–º–æ—É—Ç –∏–∑–±—ã—Ç–∫–∞
3. quota_promote_serviceable (P1) ‚Üí –ø—Ä–æ–º–æ—É—Ç –∏–∑ serviceable
4. quota_promote_reserve (P2) ‚Üí –ø—Ä–æ–º–æ—É—Ç –∏–∑ reserve
5. quota_promote_inactive (P3) ‚Üí –ø—Ä–æ–º–æ—É—Ç –∏–∑ inactive
   ‚îî‚îÄ –ú–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è deficit > 0

6. spawn_dynamic_mgr ‚Üí —Ä–∞—Å—á—ë—Ç deficit –ø–æ—Å–ª–µ P3
   ‚îú‚îÄ –ï—Å–ª–∏ deficit > 0 –ò day >= repair_time
   ‚îî‚îÄ –ü—É–±–ª–∏–∫–∞—Ü–∏—è need –≤ MacroProperty

7. spawn_dynamic_ticket ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
   ‚îî‚îÄ –ê–≥–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –°–†–ê–ó–£ –≤ operations (intent=0)

8. state_manager_operations ‚Üí –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
   ‚îî‚îÄ –ù–æ–≤—ã–µ –∞–≥–µ–Ω—Ç—ã –£–ñ–ï –≤ operations, –ø–æ–ª—É—á–∞—é—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
```

---

## üîë –ö–õ–Æ–ß–ï–í–´–ï –û–¢–õ–ò–ß–ò–Ø –û–¢ –î–ï–¢–ï–†–ú–ò–ù–ò–†–û–í–ê–ù–ù–û–ì–û SPAWN

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn |
|----------|------------------------|-------------------|
| **–ò—Å—Ç–æ—á–Ω–∏–∫** | MP4 –ø–ª–∞–Ω (`mp4_new_counter_mi17_seed`) | –†–∞—Å—á—ë—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –ø–æ—Å–ª–µ P3 |
| **–¢—Ä–∏–≥–≥–µ—Ä** | `seed[day] > 0` | `deficit > 0 AND day >= repair_time` |
| **–ú–æ–º–µ–Ω—Ç** | –ö–æ–Ω–µ—Ü –¥–Ω—è (—Å–ª–æ–π 14) | –ü–æ—Å–ª–µ P3, –¥–æ state_manager (—Å–ª–æ–π 7.5) |
| **–°–æ—Å—Ç–æ—è–Ω–∏–µ** | `serviceable&intent=3` (holding) | **`operations`** (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ) |
| **–î–∏–∞–ø–∞–∑–æ–Ω ACN** | 100000-100005 (6 –∞–≥–µ–Ω—Ç–æ–≤) | 100006+ (–æ–±—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω) |
| **–î–∏–∞–ø–∞–∑–æ–Ω idx** | first_reserved_idx (279+) | first_dynamic_idx (279 + –¥–µ—Ç–µ—Ä–º. spawn) |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –ü–æ –ø–ª–∞–Ω—É –∑–∞–∫—É–ø–æ–∫ | –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ |

---

## üìä –ò–ù–í–ê–†–ò–ê–ù–¢–´

**INV-SPAWN-DYN-1:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `day >= repair_time`
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö spawn –¥–æ repair_time
SELECT COUNT(*) 
FROM sim_masterv2 
WHERE aircraft_number >= 200000 
  AND day_u16 < 180;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

**INV-SPAWN-DYN-2:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞–≥–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å `intent=2` (–æ–¥–æ–±—Ä–µ–Ω—ã)
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞–≥–µ–Ω—Ç—ã —Å—Ä–∞–∑—É —Å intent=2
SELECT COUNT(*) 
FROM sim_masterv2 
WHERE aircraft_number >= 200000 
  AND intent_state != 2;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0 (–∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤)
```

**INV-SPAWN-DYN-3:** –î–µ—Ñ–∏—Ü–∏—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ—Å–ª–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn deficit <= 0 –∏–ª–∏ –±–ª–∏–∑–∫–æ –∫ 0
-- (–º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –º–∞–ª—ã–π deficit –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π frames_total)
```

**INV-SPAWN-DYN-4:** –ù–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ ACN
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (100000-199999) –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ (200000+) –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è
SELECT COUNT(*) 
FROM sim_masterv2 
WHERE aircraft_number BETWEEN 100000 AND 199999
  AND aircraft_number >= 200000;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

---

## üöÄ –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (setup_env)
1. ‚úÖ –†–∞—Å—á—ë—Ç `max_deficit_estimate` –ø–æ —Ñ–æ—Ä–º—É–ª–µ
2. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `frames_total` —Å —É—á—ë—Ç–æ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–∞
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ `first_dynamic_idx` –≤ Environment
4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ MP5 –∏ MP2

### –≠—Ç–∞–ø 2: RTC –º–æ–¥—É–ª—å
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ `rtc_spawn_dynamic.py` (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å `spawn_v2.py`)
2. ‚úÖ –ê–≥–µ–Ω—Ç—ã-—É—Ç–∏–ª–∏—Ç—ã: `spawn_dynamic_mgr`, `spawn_dynamic_ticket`
3. ‚úÖ MacroProperty –º–∞—Å—Å–∏–≤—ã –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ spawn
4. ‚úÖ RTC —Ñ—É–Ω–∫—Ü–∏–∏: –º–µ–Ω–µ–¥–∂–µ—Ä –∏ —Ç–∏–∫–µ—Ç

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
1. ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è –≤ `orchestrator_v2.py`
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ—è 7.5 –º–µ–∂–¥—É P3 –∏ state_manager
3. ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ø—É–ª—è—Ü–∏–∏ —É—Ç–∏–ª–∏—Ç

### –≠—Ç–∞–ø 4: –í–∞–ª–∏–¥–∞—Ü–∏—è
1. ‚úÖ –¢–µ—Å—Ç 365 –¥–Ω–µ–π: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ—Å–ª–µ repair_time
2. ‚úÖ –¢–µ—Å—Ç 3650 –¥–Ω–µ–π: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –¥–µ—Ñ–∏—Ü–∏—Ç–∞
3. ‚úÖ SQL –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
4. ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –í–ê–õ–ò–î–ê–¶–ò–ò (08.11.2025)

### –¢–µ—Å—Ç 3650 –¥–Ω–µ–π (–ø–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn: 6 –∞–≥–µ–Ω—Ç–æ–≤ (100000-100005) –≤ –¥–µ–Ω—å 103
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn: —Ä–µ–∑–µ—Ä–≤ 55 —Å–ª–æ—Ç–æ–≤ (100006+)
- –£—Å–ª–æ–≤–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: day >= 180 (repair_time)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–æ** | 31 –∏–∑ 55 | ‚úÖ 56.4% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ |
| **–†–µ–∑–µ—Ä–≤ –æ—Å—Ç–∞–ª—Å—è** | 24 —Å–ª–æ—Ç–∞ | ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–µ–Ω |
| **–ó–∞–¥–µ—Ä–∂–∫–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ operations** | 0 –¥–Ω–µ–π (100%) | ‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| **–î–Ω–µ–π —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –±–∞–ª–∞–Ω—Å–æ–º** | 0 | ‚úÖ –ù–µ—Ç –ø—Ä–æ–º–∞—Ä–≥–∏–≤–∞–Ω–∏–π -1 |
| **–ü–µ—Ä–≤—ã–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn** | –î–µ–Ω—å 823 | ‚úÖ –ü–æ—Å–ª–µ repair_time=180 |
| **–ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn** | –î–µ–Ω—å 3640 | ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–æ –∫–æ–Ω—Ü–∞ |

**–î–µ—Ç–∞–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn:**

```
ACN    | Birth | First Ops | –ó–∞–¥–µ—Ä–∂–∫–∞
-------|-------|-----------|----------
100006 |   823 |       823 | 0 –¥–Ω. ‚úÖ
100007 |   829 |       829 | 0 –¥–Ω. ‚úÖ
100008 |   848 |       848 | 0 –¥–Ω. ‚úÖ
...
100036 |  3640 |      3640 | 0 –¥–Ω. ‚úÖ
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π (serviceable&intent=2):**

| –í–µ—Ä—Å–∏—è | –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ | –ú–∞–∫—Å. –∑–∞–¥–µ—Ä–∂–∫–∞ | –ü—Ä–æ–º–∞—Ä–≥–∏–≤–∞–Ω–∏—è -1 |
|--------|------------------|----------------|------------------|
| **serviceable&intent=2** | 22.3 –¥–Ω—è | 108 –¥–Ω–µ–π | –î–∞ (–æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–Ω–∏) |
| **operations (—Ñ–∏–Ω–∞–ª)** | **0 –¥–Ω–µ–π** | **0 –¥–Ω–µ–π** | **–ù–µ—Ç** |

**–í—ã–≤–æ–¥:** 
- ‚úÖ –ü—Ä—è–º–æ–π —Å–ø–∞–≤–Ω –≤ `operations` –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏
- ‚úÖ –î–µ—Ñ–∏—Ü–∏—Ç –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤ —Ç–æ—Ç –∂–µ –¥–µ–Ω—å
- ‚úÖ –ù–µ—Ç –ø—Ä–æ–º–∞—Ä–≥–∏–≤–∞–Ω–∏–π –±–∞–ª–∞–Ω—Å–∞ -1
- ‚úÖ –†–µ–∑–µ—Ä–≤ 55 —Å–ª–æ—Ç–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è 10 –ª–µ—Ç —Å–∏–º—É–ª—è—Ü–∏–∏

---

## üìä –§–ò–ù–ê–õ–¨–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**

```python
# Mi-17
existing_mi17 = 116                  # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–ª–∞–Ω–µ—Ä—ã
deterministic_spawn_mi17 = 6         # –ò–∑ MP4 (–¥–µ–Ω—å 103: 2025-10-15)
dynamic_reserve_mi17 = 55            # –†–µ–∑–µ—Ä–≤ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn
frames_total_mi17 = 177              # –ò—Ç–æ–≥–æ —Å–ª–æ—Ç–æ–≤ (116 + 6 + 55)

# –ò–Ω–¥–µ–∫—Å—ã
first_reserved_idx = 279             # –ù–∞—á–∞–ª–æ —Ä–µ–∑–µ—Ä–≤–∞ (163 Mi-8 + 116 Mi-17)
first_deterministic_idx = 279        # –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn (279-284)
first_dynamic_idx = 285              # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn (285-339)

# ACN –¥–∏–∞–ø–∞–∑–æ–Ω—ã
base_acn_spawn = 100000              # –û–±—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
# –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: 100000-100005 (6 –∞–≥–µ–Ω—Ç–æ–≤)
# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π: 100006+ (–¥–æ 55 –∞–≥–µ–Ω—Ç–æ–≤)

# –£—Å–ª–æ–≤–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
repair_time_mi17 = 180               # –î–Ω–µ–π (–∏–∑ MP1)
```

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
1. ‚úÖ **–û–±—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω ACN** (100000+) –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn
2. ‚úÖ **–ü—Ä—è–º–æ–π —Å–ø–∞–≤–Ω –≤ operations** (–±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ —á–µ—Ä–µ–∑ serviceable)
3. ‚úÖ **–†–µ–∑–µ—Ä–≤ 55 —Å–ª–æ—Ç–æ–≤** (–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è 10 –ª–µ—Ç —Å –∑–∞–ø–∞—Å–æ–º 43%)
4. ‚úÖ **–£—Å–ª–æ–≤–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏** `day >= repair_time` (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å P3)
5. ‚úÖ **WARNING –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ —Ä–µ–∑–µ—Ä–≤–∞** (—Å–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ (08.11.2025)  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

