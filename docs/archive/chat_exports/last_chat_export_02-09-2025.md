# Экспорт чата от 02-09-2025

## Основные темы чата
- Полная GPU‑модель статусов 1/2/4/5/6 и экспорт в ClickHouse
- Исправление нулей в триггерных/derived полях, перенос логики триггеров в RTC
- Валидация assembly/partout vs переходы 2→4 и добавление поддержки 2→6
- Обновление документации и валидаторов под UInt16 даты

## Решенные задачи
- Устранены нули в `partout_trigger`/`assembly_trigger` за счёт переноса сброса на начало суток и фиксов RTC
- Добавлен счётчик `s6_days` и флаг `s6_started` для статуса 6; инкремент ограничен до `partout_time`
- Экспорт `sim_results` стабилизирован, DDL auto‑ALTER поддерживает новые поля
- Реализованы CLI‑флаги экспорта (вкл. `--export-triggers-only`, `--export-d0`)
- Валидатор расширен: учтены переходы 2→6 для partout; проверка по `day_u16`

## Проблемы и их решения
- Сброс триггеров из‑за порядка слоёв → перенесён `rtc_quota_begin_day` в первый слой
- Дубли объявлений переменных и отступы → исправлено в `model_build.py`
- Долгая загрузка MP5 при 10‑летке → временно отключали через переменную окружения в прогоне

## Изменения в коде
- `code/model_build.py`: добавлены `s6_days`, `s6_started`; правки `rtc_status_6`, `rtc_status_2`
- `code/sim_master.py`: экспорт, DDL/ALTER, батч‑вставки, триггер‑only режим
- `code/utils/validate_triggers_vs_2to4.py`: валидатор c поддержкой 2→6 и `day_u16`

## Обновления документации
- `docs/validation.md`: добавлен статус 6 в методику; метрики 2→6=38; сверка по `day_u16`

## Следующие шаги
- Повторная 10‑летка с включённым MP5 для полной валидации производных метрик
- Проверка derived/mark полей после будущего переноса постпроцессинга на GPU
