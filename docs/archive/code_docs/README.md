# üöÅ Helicopter Component Lifecycle Prediction - Code

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö Excel ‚Üí ClickHouse –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ Agent-Based –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é.

---

## üéØ **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è**

### **1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –∏–∑ Excel –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**
**–¢—Ä—É–¥–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö:
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: created ‚Üí modified ‚Üí filesystem time
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≥–æ–¥–∞ (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö)
- Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∏–∑–≤–ª–µ—á–µ–Ω–∏—è

### **2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ MD_Components (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ)**
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞**:
```
Row 0: [–∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º] ‚Üê –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨
Row 1: partno | comp_number | group_by | ...  ‚Üê HEADER (header=1)
Row 2: –¢–í2-117–ê | 1 | 1 | ...                ‚Üê DATA
```

### **3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å clickhouse_driver)**
**–¢—Ä—É–¥–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**:
- **Python native —Ç–∏–ø—ã** (–ù–ï numpy/pandas —Ç–∏–ø—ã!)
- lease_restricted: "Y" ‚Üí 1 (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è)
- Fallback –Ω–∞ 1900-01-01 –¥–ª—è NULL –¥–∞—Ç
- –û–±–Ω—É–ª–µ–Ω–∏–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### **4. –î–≤–æ–π–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–∞—á–µ—Å—Ç–≤–∞**
**–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**:
- `heli_raw`: –≤—Å–µ 108,623 –∑–∞–ø–∏—Å–µ–π
- `heli_pandas`: 6,677 –∑–∞–ø–∏—Å–µ–π (6.1% –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è 100% –ø–æ–∫—Ä—ã—Ç–∏—è 37 –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤

---

## üìã **–ê–∫—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö (16 –∫–æ–ª–æ–Ω–æ–∫)**

```sql
CREATE TABLE heli_raw (
    -- –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    partno Nullable(String),              -- –ü–∞—Ä—Ç–Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    serialno Nullable(String),            -- –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä
    ac_typ Nullable(String),              -- –¢–∏–ø –≤–æ–∑–¥—É—à–Ω–æ–≥–æ —Å—É–¥–Ω–∞
    location Nullable(String),            -- –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ/–Ω–æ–º–µ—Ä –í–°
    
    -- –î–∞—Ç—ã
    mfg_date Nullable(Date),              -- –î–∞—Ç–∞ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
    removal_date Nullable(Date),          -- –î–∞—Ç–∞ —Å–Ω—è—Ç–∏—è
    target_date Nullable(Date),           -- –¶–µ–ª–µ–≤–∞—è –¥–∞—Ç–∞
    
    -- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –≤–ª–∞–¥–µ–Ω–∏–µ
    condition Nullable(String),           -- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    owner Nullable(String),               -- –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫
    lease_restricted Nullable(String),    -- –õ–∏–∑–∏–Ω–≥–æ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    
    -- –†–µ—Å—É—Ä—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–≤ —á–∞—Å–∞—Ö)
    oh Nullable(UInt32),                  -- –ù–∞—Ä–∞–±–æ—Ç–∫–∞ —Å –Ω–∞—á–∞–ª–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
    oh_threshold Nullable(UInt32),        -- –ü–æ—Ä–æ–≥ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
    ll Nullable(UInt32),                  -- –ù–∞–ª–µ—Ç —Å –º–æ–º–µ–Ω—Ç–∞ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
    sne Nullable(UInt32),                 -- –ù–∞—Ä–∞–±–æ—Ç–∫–∞ —Å –º–æ–º–µ–Ω—Ç–∞ —Ä–µ–º–æ–Ω—Ç–∞
    ppr Nullable(UInt32),                 -- –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥ —Ä–µ–º–æ–Ω—Ç–∞
    
    -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞
    version_date Date DEFAULT today()     -- –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö
) ENGINE = MergeTree()
ORDER BY version_date
PARTITION BY toYYYYMM(version_date)
```

---

## üî¨ **–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

**–ù–∞ –æ—Å–Ω–æ–≤–µ `data_input/analytics/MD_Dictionary.xlsx`** - –ø–µ—Ä–µ—Ö–æ–¥ –∫ GPU-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ö–µ–º–µ:

### **–ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ (—ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ 61%):**
```python
# ac_type_mask: UInt8 (–≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫)
–ú–ò_26 = 0b10000000, –ú–ò_17 = 0b01000000, –ú–ò_8–¢ = 0b00100000...

# condition_mask: UInt8 (–ª–æ–≥–∏–∫–∞ –∏–∑ MD_Dictionary.xlsx)
–ò–°–ü–†–ê–í–ù–´–ô = 0b00000111, –ù–ï–ò–°–ü–†–ê–í–ù–´–ô = 0b00000100, –ù–ï_–£–°–¢–ê–ù–û–í–õ–ï–ù = 0b00000110

# lease_restricted: UInt8 (—Ç—Ä—É–¥–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)
–£–ß–ò–¢–´–í–ê–¢–¨ = 0b00010000, –ù–ï_–£–ß–ò–¢–´–í–ê–¢–¨ = 0b00000000
```

### **ID –º–∞–ø–ø–∏–Ω–≥–∏ –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏:**
```python
partno_id: UInt16      # –î–æ 65k –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ (–≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫)
serialno_id: UInt32    # –î–æ 4.3B —Å–µ—Ä–∏–π–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤
owner_id: UInt8        # –î–æ 255 —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤
location_id: UInt16    # –î–æ 65k –ª–æ–∫–∞—Ü–∏–π
```

---

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

### **–¢–µ–∫—É—â–∏–π –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```
Excel —Ñ–∞–π–ª (–¥–∏—Å–∫) ‚Üí pandas DataFrame (RAM) ‚Üí ClickHouse —Ç–∞–±–ª–∏—Ü—ã (–¥–∏—Å–∫)
```

### **DataFrame lifecycle (–æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):**
1. **–°–æ–∑–¥–∞–Ω–∏–µ**: —á—Ç–µ–Ω–∏–µ Excel —Å pandas.read_excel()
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞**: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –æ—á–∏—Å—Ç–∫–∞, —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤ –ø–∞–º—è—Ç–∏
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –ª–æ–≥–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –∑–∞–≥—Ä—É–∑–∫–∞ –≤ ClickHouse —á–µ—Ä–µ–∑ clickhouse_driver
5. **–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ RAM

### **–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
- **DataFrame –≤ –ø–∞–º—è—Ç–∏** - –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç –¥–ª—è —É–ª—É—á—à–µ–Ω–∏–π
- **–ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ DataFrame** –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤ heli_pandas
- **–í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ Excel –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

---

## ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏)**

- **–ó–∞–≥—Ä—É–∑–∫–∞ Excel**: ~2-3 —Å–µ–∫ (108k –∑–∞–ø–∏—Å–µ–π)
- **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: ~1-2 —Å–µ–∫ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è + –æ—á–∏—Å—Ç–∫–∞)
- **–í—Å—Ç–∞–≤–∫–∞ ClickHouse**: ~167k –∑–∞–ø–∏—Å–µ–π/—Å–µ–∫ (–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è)
- **–û–±—â–∏–π —Ü–∏–∫–ª**: ~5-10 —Å–µ–∫ (–ø–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

---

## üöÄ **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è Enhanced DataFrame**

### **–ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–¥–∞—á–∏:**
1. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏** –∏–∑ `data_input/analytics/`:
   - –ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ –¥–ª—è ac_typ, condition, lease_restricted
   - ID –º–∞–ø–ø–∏–Ω–≥–∏ –¥–ª—è —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –ø–æ–ª–µ–π
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è GPU

2. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ Flame GPU**:
   - cuDF –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è GPU DataFrame
   - –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–≥–µ–Ω—Ç–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üí° **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

- **–°—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: Linux WSL2 Ubuntu 22.04
- **–ö–æ–º–∞–Ω–¥—ã Python**: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ `python3` (–Ω–µ `python`)
- **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π production –∑–∞–≥—Ä—É–∑—á–∏–∫**: `dual_loader.py`
- **–§–æ–∫—É—Å –Ω–∞ DataFrame**: –æ—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –æ–±—ä–µ–∫—Ç–æ–º pandas DataFrame –≤ –ø–∞–º—è—Ç–∏
- **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è roadmap**: —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ `data_input/analytics/`

### **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞:**
‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö  
‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏  
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  
üîÑ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ Agent-Based –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é  
üîÆ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ GPU –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ 