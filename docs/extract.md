# Extract - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üì• –û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ Extract

–≠—Ç–∞–ø Extract –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤, –ø–µ—Ä–≤–∏—á–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –≤ ClickHouse –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

## üìã –ü–µ—Ä–µ—á–µ–Ω—å —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract (–∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ ETL Master)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (ETL Pipeline)

1. **`md_components_loader.py`** - MD Components (–º–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
2. **`status_overhaul_loader.py`** - Status & Overhaul (—Å—Ç–∞—Ç—É—Å—ã –∏ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç)
3. **`program_loader.py`** - Flight Program (–ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤)
4. **`program_ac_loader.py`** - Program AC (—Å–≤—è–∑–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –∏ –í–°)
5. **`dual_loader.py`** - Status Components (–æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ + –ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥)

### –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (ETL Pipeline)

6. **`dictionary_creator.py`** - –í—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (—Å—Ç–∞—Ç—É—Å—ã, –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞, —Å–µ—Ä–∏–π–Ω–∏–∫–∏, –≤–ª–∞–¥–µ–ª—å—Ü—ã, —Ç–∏–ø—ã –í–°, –Ω–æ–º–µ—Ä–∞ –í–°)
7. **`enrich_heli_pandas.py`** - –û–±–æ–≥–∞—â–µ–Ω–∏–µ ac_type_mask
8. **`calculate_beyond_repair.py`** - –†–∞—Å—á–µ—Ç Beyond Repair (br)
9. **`md_components_enricher.py`** - –û–±–æ–≥–∞—â–µ–Ω–∏–µ MD Components

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (–≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞)

10. **`aircraft_number_processor.py`** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –í–° (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)
11. **`overhaul_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞ (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)
12. **`program_ac_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)  
13. **`inactive_planery_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤ (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)

### –£—Ç–∏–ª–∏—Ç—ã Extract

14. **`utils/create_all_dictionaries.py`** - —É—Ç–∏–ª–∏—Ç–∞-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π
15. **`utils/test_db_connection.py`** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –°–£–ë–î  
16. **`utils/cleanup_dictionaries.py`** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π (–¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å –∞–¥–¥–∏—Ç–∏–≤–Ω–æ–π –≥—Ä—è–∑—å—é)
17. **`code/archive/aircraft_number_dict_creator.py`** - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–æ–∑–¥–∞—Ç–µ–ª—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –í–° (–∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω)

## üîÑ –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract (–ø–æ ETL Master Pipeline)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–º

**–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä:** `etl_master.py`
- –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ (—Ç–µ—Å—Ç/–ø—Ä–æ–¥)
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

1. **md_components_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `md_components`
2. **status_overhaul_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `status_overhaul`
3. **program_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `flight_program`
4. **program_ac_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `program_ac`

### –≠—Ç–∞–ø 2: –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–æ–º (–∫—Ä–∏—Ç–∏—á–Ω–∞—è)

5. **dual_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `heli_pandas`
   - –ó–∞–≥—Ä—É–∑–∫–∞ Excel –¥–∞–Ω–Ω—ã—Ö
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–æ–≤:
     - overhaul_status_processor.py ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
     - program_ac_status_processor.py ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
     - inactive_planery_processor.py ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤
   - aircraft_number_processor.py ‚Üí –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –í–°
   - –†–∞—Å—á–µ—Ç repair_days ‚Üí `heli_pandas.repair_days`

### –≠—Ç–∞–ø 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π)

6. **dictionary_creator.py** ‚Üí —Ç–∞–±–ª–∏—Ü—ã —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤:
   - `dict_status_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ (–Ω–µ-–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_partno_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_serialno_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å–µ—Ä–∏–π–Ω–∏–∫–æ–≤ (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_owner_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_ac_type_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∏–ø–æ–≤ –í–° (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_aircraft_number_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –í–° —Å ac_type_mask (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)

### –≠—Ç–∞–ø 4: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

7. **enrich_heli_pandas.py** ‚Üí `heli_pandas.ac_type_mask`
8. **calculate_beyond_repair.py** ‚Üí `md_components.br`
9. **md_components_enricher.py** ‚Üí –æ–±–æ–≥–∞—â–µ–Ω–∏–µ `md_components`

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ Extract

### heli_pandas (–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- **partno** String - –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏  
- **serialno** String - —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **name** String - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **status_id** UInt8 - —Å—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (0-–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, 1-–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ, 2-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è, 4-—Ä–µ–º–æ–Ω—Ç)
- **oh** Float64 - –Ω–∞—Ä–∞–±–æ—Ç–∫–∞ –¥–æ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
- **ll** Float64 - —Å—Ä–æ–∫ —Å–ª—É–∂–±—ã
- **repair_days** Int16 - –æ—Å—Ç–∞—Ç–æ–∫ –¥–Ω–µ–π –¥–æ —Ä–µ–º–æ–Ω—Ç–∞
- **aircraft_number** String - –Ω–æ–º–µ—Ä –í–°
- **ac_type_mask** UInt64 - –±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–æ–≤ –í–°

### md_components (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- **partno** String - –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏
- **name** String - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- **br** Float64 - –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å Beyond Repair
- –î—Ä—É–≥–∏–µ –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –ø–æ–ª—è

### –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- **status_overhaul** - –¥–∞–Ω–Ω—ã–µ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
- **flight_program** - –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤  
- **program_ac** - —Ä–µ–µ—Å—Ç—Ä –í–°
- **dict_status_flat** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤
- **dict_aircraft_number_flat** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –í–° —Å ac_type_mask –¥–ª—è Flame GPU (279 –í–° —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –º–∞—Å–∫–∞–º–∏)

## üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ data_input

**–†–∞–∑–º–µ—â–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤:**
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –≤ `data_input/`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls
- –ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8 –∏–ª–∏ CP1251

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Excel:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: partno, serialno, name
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏: oh, ll, sne, ppr, oh_threshold
- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
- –î–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω: `Status_Components_YYYYMMDD.xlsx`

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤:**
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: –¥–æ 100MB
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–æ 1M –∑–∞–ø–∏—Å–µ–π –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–±–∏–µ–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name

**–ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name, oh, ll, sne, ppr, oh_threshold

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Extract

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- BATCH_SIZE=10000 (—Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –≤—Å—Ç–∞–≤–∫–∏)
- MAX_RETRIES=3 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫)
- TIMEOUT_SECONDS=300 (—Ç–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–π)

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Extract

### –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

**–ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø–∏—Å–µ–π
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã Extract

1. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π (partno, serialno)
2. **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∑–∞–º–µ–Ω–∞ –Ω–∞ NULL
3. **–ü—Ä–æ–±–ª–µ–º—ã –∫–æ–¥–∏—Ä–æ–≤–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CP1251/UTF-8
4. **–ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –ø–∞–∫–µ—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

## üöÅ –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ aircraft_number —Å ac_type_mask

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–ª–æ–≤–∞—Ä—è aircraft_number

**–ü—Ä–æ–±–ª–µ–º–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 18-07-2025):** –°–ª–æ–≤–∞—Ä—å `aircraft_number_dict_flat` —Å–æ–¥–µ—Ä–∂–∞–ª –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `ac_type_mask` –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ ETL —ç—Ç–∞–ø–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
1. **–ü–æ—Ä—è–¥–æ–∫ —ç—Ç–∞–ø–æ–≤**: `enrich_heli_pandas.py` –ø–µ—Ä–µ–º–µ—â–µ–Ω –ü–ï–†–ï–î `dictionary_creator.py`
2. **–°—Ç—Ä–æ–≥–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –¢–æ–ª—å–∫–æ –í–° —Å –ø–ª–∞–Ω–µ—Ä–Ω—ã–º–∏ partno –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Å–ª–æ–≤–∞—Ä—å
3. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å**: ac_type_mask –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –æ—Ç –ª—é–±—ã—Ö –∑–∞–ø–∏—Å–µ–π –í–° —á–µ—Ä–µ–∑ JOIN

**–ü–ª–∞–Ω–µ—Ä–Ω—ã–µ partno –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- –ú–ò-8–¢, –ú–ò-8–ü, –ú–ò-8–ü–°, –ú–ò-8–¢–ü, –ú–ò-8–ê–ú–¢, –ú–ò-8–ú–¢–í (ac_type_mask = 32)
- –ú–ò-17, –ú–ò-26 (ac_type_mask = 64)

**–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ **279 –í–°** –≤ —Å–ª–æ–≤–∞—Ä–µ (–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –ø–æ –ø–ª–∞–Ω–µ—Ä–∞–º)
- ‚úÖ **163 –í–° —Å ac_type_mask = 32** (–ú–∏-8 —Å–µ–º–µ–π—Å—Ç–≤–æ)
- ‚úÖ **116 –í–° —Å ac_type_mask = 64** (–ú–∏-17 —Å–µ–º–µ–π—Å—Ç–≤–æ)
- ‚úÖ **dictGet('aircraft_number_dict_flat', 'ac_type_mask', aircraft_number)** —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è Flame GPU

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ac_type_mask –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∏–ø–∞ –í–° –ø–æ –Ω–æ–º–µ—Ä—É —á–µ—Ä–µ–∑ dictGet:
- –ü–æ–ª—É—á–µ–Ω–∏–µ ac_type_mask –ø–æ aircraft_number
- –ü–æ–ª—É—á–µ–Ω–∏–µ registration_code –ø–æ aircraft_number  
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö heli_pandas —Å dict_aircraft_number_flat
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –í–° —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CASE –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

## üîß –ü—Ä–æ–±–ª–µ–º—ã —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 18-07-2025)

### –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥—ã OB-/OM-

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –∏—Å—Ö–æ–¥–Ω–æ–º Excel –±—ã–ª–∏ –∑–∞–ø–∏—Å–∏ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏ `OB-` –∏ `OM-` –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö `RA-`.

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ ETL:**
- `aircraft_number_processor.py` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `RA-` —Ñ–æ—Ä–º–∞—Ç
- –ó–∞–ø–∏—Å–∏ —Å `OB-/OM-` –ø–æ–ª—É—á–∞–ª–∏ `aircraft_number = 0` –∏ `location = ''`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 3100 –∑–∞–ø–∏—Å–µ–π "–º—É—Å–æ—Ä–∞" –≤ heli_pandas

**–†–µ—à–µ–Ω–∏–µ:**
1. **–†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Excel** - –∏—Å–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å `OB-/OM-` —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π
2. **–ò—Å–∫–ª—é—á–µ–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã** —ç—Ç–∏—Ö –í–°
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ 279 –í–° –≤–º–µ—Å—Ç–æ 284

### –ê–Ω–∞–ª–∏–∑ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –±–µ–∑ –í–°

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:** 3100 –∑–∞–ø–∏—Å–µ–π —Å `aircraft_number = 0` –≤ heli_pandas - —ç—Ç–æ –ù–ï –≥—Ä—è–∑—å, –∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- **–ê–≥—Ä–µ–≥–∞—Ç—ã –Ω–∞ —Å–∫–ª–∞–¥–µ** (–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –í–°)
- **–ó–∞–ø–∞—Å–Ω—ã–µ —á–∞—Å—Ç–∏** –≤ —Ä–µ–º–æ–Ω—Ç–µ  
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ —Ä–µ–∑–µ—Ä–≤–µ**

**–í–∞–∂–Ω–æ:** –≠—Ç–∏ –∑–∞–ø–∏—Å–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ –¥–ª—è —É—á–µ—Ç–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –Ω–æ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ —Å–ª–æ–≤–∞—Ä—è aircraft_number.

### –£—Ç–∏–ª–∏—Ç–∞ –æ—á–∏—Å—Ç–∫–∏ —Å–ª–æ–≤–∞—Ä–µ–π

**–§–∞–π–ª:** `code/utils/cleanup_dictionaries.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π –ø—Ä–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ "–∞–¥–¥–∏—Ç–∏–≤–Ω–æ–π –≥—Ä—è–∑–∏"

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
–ó–∞–ø—É—Å–∫ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º yes –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π.

**–ß—Ç–æ —É–¥–∞–ª—è–µ—Ç:**
- –í—Å–µ Dictionary –æ–±—ä–µ–∫—Ç—ã (aircraft_number_dict_flat, status_dict_flat –∏ –¥—Ä.)
- –í—Å–µ —Å–ª–æ–≤–∞—Ä–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (dict_aircraft_number_flat, dict_status_flat –∏ –¥—Ä.)
- –ù–ï —Ç—Ä–æ–≥–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (heli_pandas, md_components –∏ –¥—Ä.)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Å–ª–æ–≤–∞—Ä—è—Ö
- –ü–µ—Ä–µ–¥ —á–∏—Å—Ç–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π ETL
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–æ–≤–∞—Ä–µ–π

## üßπ –£—Ç–æ—á–Ω–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —É–±–æ—Ä–∫–µ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —É–±–æ—Ä–∫–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 18-07-2025)

**–ê–≥–µ–Ω—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–º–µ—Å—Ç–æ –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:**
- –ê–Ω–∞–ª–∏–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏—è–º–∏
- –¶–µ–ª–µ–≤–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–µ–∑ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

**–ß—Ç–æ –æ—á–∏—â–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã Python (__pycache__, *.pyc)
- –õ–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π –≤ logs/
- –§–∞–π–ª—ã *.tmp, *.backup, *.bak (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã)
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ–∞–π–ª—ã *_backup, *_copy (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã)

**–ß—Ç–æ –ù–ï —Ç—Ä–æ–≥–∞–µ—Ç—Å—è:**
- –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ code/
- –†–∞–±–æ—á–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ –ª—é–±—ã—Ö –ª–æ–∫–∞—Ü–∏—è—Ö
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (.cursorrules, .gitignore, requirements.txt)
- –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ (archive_vnv_cpu_project/, docs/, data_input/, config/)

**–û—Ç–ª–∏—á–∏–µ –æ—Ç –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª:**
- –û—Ç–∫–∞–∑ –æ—Ç –º–∞—Å—Å–æ–≤–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Ñ–∞–π–ª–æ–≤ –º–µ–∂–¥—É –ø–∞–ø–∫–∞–º–∏
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ë–æ–ª–µ–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ 