# Extract - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üì• –û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ Extract

–≠—Ç–∞–ø Extract –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤, –ø–µ—Ä–≤–∏—á–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –≤ ClickHouse –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

## üéØ –ï–¥–∏–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ (–î–∞—Ç–∞: 27-07-2025)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–Ω—Ü–∏–ø:** –í–°–ï –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ETL –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é –≤–µ—Ä—Å–∏—é –∏–∑ `Status_Components.xlsx`

| **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç** | **–ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏** | **–°—Ç–∞—Ç—É—Å** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|---------------|-------------------|-----------|--------------|
| **Extract Master** | `Status_Components.xlsx` | ‚úÖ **–ö–û–†–ù–ï–í–û–ô** | –ß–∏—Ç–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ Excel (–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è/–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏) |
| **–í—Å–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏** | CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Extract | ‚úÖ **–ü–†–ò–û–†–ò–¢–ï–¢** | `--version-date 2025-07-04 --version-id 1` |
| **Fallback –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤** | `Status_Components.xlsx` | ‚úÖ **–ï–î–ò–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö** | `utils.version_utils.extract_unified_version_date()` |
| **–°–ª–æ–≤–∞—Ä–∏** | `heli_pandas` | ‚úÖ **–¶–ï–ü–û–ß–ö–ê** | `get_version_from_heli_pandas()` |
| **–¢–µ–Ω–∑–æ—Ä—ã** | CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Extract | ‚úÖ **–ù–ê–°–õ–ï–î–û–í–ê–ù–ò–ï** | –ü–æ–ª—É—á–∞—é—Ç –≤–µ—Ä—Å–∏—é –∏–∑ Extract Master |

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞

| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–£—Å–ª–æ–≤–∏–µ** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|---------------|-------------|-------------|----------------|
| **1** | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è Excel | `abs(created_year - current_year) <= 1` | –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏ |
| **2** | –î–∞—Ç–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ Excel | –ï—Å–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ > 1 –≥–æ–¥–∞ | –†–µ–∑–µ—Ä–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |
| **3** | –í—Ä–µ–º—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –û–° | –ï—Å–ª–∏ Excel –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã | –ü–æ—Å–ª–µ–¥–Ω–∏–π fallback |

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ `docs/changelog.md` –æ—Ç 27-07-2025**

## üìã –ü–µ—Ä–µ—á–µ–Ω—å —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract (–∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ 28-07-2025)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (Extract Pipeline)

| **‚Ññ** | **–°–∫—Ä–∏–ø—Ç** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | **–í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å** |
|-------|-----------|----------------|------------------|
| **1** | `md_components_loader.py` | MD Components (–º–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤) - **–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù** | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |
| **2** | `status_overhaul_loader.py` | Status & Overhaul (—Å—Ç–∞—Ç—É—Å—ã –∏ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç) | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |
| **3** | `program_ac_loader.py` | Program AC (—Å–≤—è–∑–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –∏ –í–°) | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |
| **4** | `dual_loader.py` | Status Components (–æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ + –ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥) | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |

### –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (Extract Pipeline)

| **‚Ññ** | **–°–∫—Ä–∏–ø—Ç** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | **–í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å** |
|-------|-----------|----------------|------------------|
| **5** | `enrich_heli_pandas.py` | –û–±–æ–≥–∞—â–µ–Ω–∏–µ ac_type_mask | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç heli_pandas |
| **6** | `calculate_beyond_repair.py` | –†–∞—Å—á–µ—Ç Beyond Repair (br) - **–ò–°–ü–†–ê–í–õ–ï–ù** | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç md_components |
| **7** | `md_components_enricher.py` | –û–±–æ–≥–∞—â–µ–Ω–∏–µ MD Components | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç —Å–ª–æ–≤–∞—Ä–µ–π |
| **8** | `dictionary_creator.py` | –í—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (—Å—Ç–∞—Ç—É—Å—ã, –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞, —Å–µ—Ä–∏–π–Ω–∏–∫–∏, –≤–ª–∞–¥–µ–ª—å—Ü—ã, —Ç–∏–ø—ã –í–°, –Ω–æ–º–µ—Ä–∞ –í–°) | ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –∏–∑ heli_pandas |

### –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Ç–µ–Ω–∑–æ—Ä–æ–≤ (–≤ –∫–æ–Ω—Ü–µ –ø–∞–π–ø–ª–∞–π–Ω–∞)

| **‚Ññ** | **–°–∫—Ä–∏–ø—Ç** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | **–í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å** |
|-------|-----------|----------------|------------------|
| **9** | `program_fl_direct_loader.py` | –ü—Ä—è–º–æ–π —Ç–µ–Ω–∑–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º –ø–æ–ª–µ—Ç–æ–≤ –Ω–∞ 4000 –¥–Ω–µ–π | ‚úÖ CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Extract |
| **10** | `program_ac_direct_loader.py` | –ü—Ä—è–º–æ–π —Ç–µ–Ω–∑–æ—Ä –æ–ø–µ—Ä–∞—Ü–∏–π –í–° —Å –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–æ–º | ‚úÖ CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Extract |
| **11** | `digital_values_dictionary_creator.py` | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –≤—Å–µ—Ö –ø–æ–ª–µ–π –¥–ª—è Flame GPU - **–ò–°–ü–†–ê–í–õ–ï–ù** | ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –∏–∑ heli_pandas |

### –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

| **‚Ññ** | **–°–∫—Ä–∏–ø—Ç** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | **–í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å** |
|-------|-----------|----------------|------------------|
| **12** | `repair_days_calculator.py` | –†–∞—Å—á–µ—Ç repair_days –¥–ª—è –í–° –≤ —Ä–µ–º–æ–Ω—Ç–µ - **–ü–ï–†–ï–ú–ï–©–ï–ù –í –ö–û–ù–ï–¶** | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç heli_pandas |

## üöÄ –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞ Extract

### **–û—Å–Ω–æ–≤–Ω–æ–π Extract —Ü–∏–∫–ª**
```bash
# –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü + –µ–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å)
python3 code/extract_master.py
# –í—ã–±—Ä–∞—Ç—å: 1 (–¢–ï–°–¢)

# –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π –¥–∞–Ω–Ω—ã—Ö + –µ–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å)  
python3 code/extract_master.py
# –í—ã–±—Ä–∞—Ç—å: 2 (–ü–†–û–î)
```

### **–ü–µ—Ä–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–¥–∏–Ω —Ä–∞–∑)
python3 code/utils/auto_config.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
python3 code/utils/test_db_connection.py
```

### **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ**
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
python3 code/utils/auto_config.py --info

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç–º–æ–¥–∑–∏
python3 code/utils/display_manager.py

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–¥–ª—è Windows)
EMOJI_MODE=text python3 code/extract_master.py

# –û—á–∏—Å—Ç–∫–∞ –∞–¥–¥–∏—Ç–∏–≤–Ω–æ–π –≥—Ä—è–∑–∏ –≤ —Å–ª–æ–≤–∞—Ä—è—Ö
python3 code/utils/cleanup_dictionaries.py

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –ø—Ä–æ–µ–∫—Ç–∞
python3 code/utils/database_cleanup.py
```

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –¥–∞–Ω–Ω—ã—Ö

### **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π/–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫**
1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö Excel —Ñ–∞–π–ª–æ–≤** –≤ `data_input/source_data/`
2. **–ó–∞–ø—É—Å–∫ Extract –≤ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ**: `python3 code/extract_master.py` ‚Üí –≤—ã–±–æ—Ä 2
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** —á–µ—Ä–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ extract_master.py

### **–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ/–æ—Ç–ª–∞–¥–∫–µ**  
1. **–ó–∞–ø—É—Å–∫ Extract –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ**: `python3 code/extract_master.py` ‚Üí –≤—ã–±–æ—Ä 1
2. **–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** –∏ –æ—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º
3. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫** –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö**
1. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: `python3 code/utils/test_db_connection.py`
2. **–û—á–∏—Å—Ç–∫–∞ —Å–ª–æ–≤–∞—Ä–µ–π**: `python3 code/utils/cleanup_dictionaries.py` 
3. **–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞**: `python3 code/utils/database_cleanup.py`
4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Extract**: `python3 code/extract_master.py`

## üéØ –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã Extract

### **–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
- **`heli_pandas`** - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (2.4M –∑–∞–ø–∏—Å–µ–π)
- **`md_components`** - –ú–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å –æ–±–æ–≥–∞—â–µ–Ω–∏–µ–º (group_by, beyond_repair)
- **`status_overhaul`** - –°—Ç–∞—Ç—É—Å—ã –∏ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **`program_ac`** - –°–≤—è–∑–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –∏ –í–° –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

### **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (dictGet)**
- **`dict_status_flat`** - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **`dict_partno_flat`** - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **`dict_serialno_flat`** - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å–µ—Ä–∏–π–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤
- **`dict_owner_flat`** - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –í–°
- **`dict_ac_type_flat`** - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∏–ø–æ–≤ –í–° (–ú–ò-8, –ú–ò-17)
- **`dict_aircraft_number_flat`** - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –ø–ª–∞–Ω–µ—Ä–æ–≤ (279 –í–°)

### **–¢–µ–Ω–∑–æ—Ä—ã –¥–ª—è ABM**
- **`flight_program_fl`** - –ü—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ (279 –ø–ª–∞–Ω–µ—Ä–æ–≤ √ó 4000 –¥–Ω–µ–π = ~1.1M –∑–∞–ø–∏—Å–µ–π)
- **`flight_program_ac`** - –û–ø–µ—Ä–∞—Ü–∏–∏ –í–° —Å trigger –ø–æ–ª—è–º–∏ (–ø–æ–ª—è √ó —Ç–∏–ø—ã √ó 4000 –¥–Ω–µ–π)

### –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (–≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ dual_loader.py)

*–°–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –ù–ï —è–≤–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏, –∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –°–ö–†–ò–ü–¢ 4:*
- **`aircraft_number_processor.py`** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –í–° ‚Üí `heli_pandas.aircraft_number`
- **`overhaul_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞ ‚Üí `heli_pandas.status_id`
- **`program_ac_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ ‚Üí `heli_pandas.status_id`
- **`inactive_planery_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤ ‚Üí `heli_pandas.status_id`

### –£—Ç–∏–ª–∏—Ç—ã Extract

16. **`utils/create_all_dictionaries.py`** - —É—Ç–∏–ª–∏—Ç–∞-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π
17. **`utils/test_db_connection.py`** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –°–£–ë–î  
18. **`utils/cleanup_dictionaries.py`** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π (–¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å –∞–¥–¥–∏—Ç–∏–≤–Ω–æ–π –≥—Ä—è–∑—å—é)
19. **`code/archive/aircraft_number_dict_creator.py`** - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–æ–∑–¥–∞—Ç–µ–ª—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –í–° (–∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω)

## üîÑ –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract (–ø–æ Extract Master Pipeline)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–º

**–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä:** `extract_master.py`
- –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ (—Ç–µ—Å—Ç/–ø—Ä–æ–¥)
- **–ï–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å** –∏–∑ `Status_Components.xlsx`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –≠—Ç–∞–ø 1-4: –ë–∞–∑–æ–≤—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

| **–≠—Ç–∞–ø** | **–°–∫—Ä–∏–ø—Ç** | **–¢–∞–±–ª–∏—Ü–∞ –°–£–ë–î** | **–ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏** |
|----------|-----------|------------------|-------------------|
| **1** | `md_components_loader.py` | `md_components` | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |
| **2** | `status_overhaul_loader.py` | `status_overhaul` | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |
| **3** | `program_ac_loader.py` | `program_ac` | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |
| **4** | `dual_loader.py` | `heli_pandas` + `heli_raw` | ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ |

### –≠—Ç–∞–ø 5-8: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

| **–≠—Ç–∞–ø** | **–°–∫—Ä–∏–ø—Ç** | **–û–±–æ–≥–∞—â–∞–µ–º—ã–µ –ø–æ–ª—è** | **–ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏** |
|----------|-----------|---------------------|-------------------|
| **5** | `enrich_heli_pandas.py` | `heli_pandas.ac_type_mask` | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç heli_pandas |
| **6** | `calculate_beyond_repair.py` | `md_components.br` | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç md_components |
| **7** | `md_components_enricher.py` | `md_components.partno_comp` | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç —Å–ª–æ–≤–∞—Ä–µ–π |
| **8** | `dictionary_creator.py` | –í—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ | ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –∏–∑ heli_pandas |

### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –≠–¢–ê–ü 4)

‚ö†Ô∏è **–°–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –ù–ï —è–≤–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏:**

| **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä** | **–û–±–æ–≥–∞—â–∞–µ–º–æ–µ –ø–æ–ª–µ** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|---------------|---------------------|--------------|
| `aircraft_number_processor.py` | `heli_pandas.aircraft_number` | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –í–° |
| `overhaul_status_processor.py` | `heli_pandas.status_id` | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞ |
| `program_ac_status_processor.py` | `heli_pandas.status_id` | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ |
| `inactive_planery_processor.py` | `heli_pandas.status_id` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤ |

### –≠—Ç–∞–ø 9-12: –¢–µ–Ω–∑–æ—Ä—ã –¥–ª—è Flame GPU + —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã

| **–≠—Ç–∞–ø** | **–°–∫—Ä–∏–ø—Ç** | **–¢–∞–±–ª–∏—Ü–∞ –°–£–ë–î** | **–ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä—Å–∏–∏** |
|----------|-----------|------------------|-------------------|
| **9** | `program_fl_direct_loader.py` | `flight_program_fl` | ‚úÖ CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Extract |
| **10** | `program_ac_direct_loader.py` | `flight_program_ac` | ‚úÖ CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Extract |
| **11** | `digital_values_dictionary_creator.py` | `dict_digital_values_flat` | ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –∏–∑ heli_pandas |
| **12** | `repair_days_calculator.py` | `heli_pandas.repair_days` | ‚úÖ –ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç heli_pandas |

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ Extract

### heli_pandas (–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
*–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–ª–µ–π (–ø–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–°–ö–†–ò–ü–¢ 4")*
- **partno** Nullable(String) - —á–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **serialno** Nullable(String) - —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞  
- **status_id** UInt8 - —Å—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (1-–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ, 2-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è, 3-–∏—Å–ø—Ä–∞–≤–µ–Ω, 4-—Ä–µ–º–æ–Ω—Ç, 5-—Ä–µ–∑–µ—Ä–≤, 6-—Ö—Ä–∞–Ω–µ–Ω–∏–µ)
- **oh** Nullable(UInt32) - overhaul —Ä–µ—Å—É—Ä—Å
- **ll** Nullable(UInt32) - life limit —Ä–µ—Å—É—Ä—Å
- **repair_days** Nullable(UInt16) - –¥–Ω–∏ —Ä–µ–º–æ–Ω—Ç–∞ —É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–µ
- **aircraft_number** UInt32 - –Ω–æ–º–µ—Ä –í–°
- **ac_type_mask** UInt8 - –±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–∞ –í–° (multihot)

### md_components (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
*–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–ª–µ–π (–ø–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–°–ö–†–ò–ü–¢ 1")*
- **partno** Nullable(String) - —á–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä
- **comp_number** Nullable(UInt8) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ –í–°
- **group_by** Nullable(UInt8) - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (1-–ú–ò8, 2-–ú–ò17)
- **repair_time** Nullable(UInt16) - –≤—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞ –≤ –¥–Ω—è—Ö
- **br** Nullable(UInt32) - beyond repair (—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥ —Å–ø–∏—Å–∞–Ω–∏—è)
- **partno_comp** Nullable(UInt32) - component ID –¥–ª—è —Å–≤—è–∑–∏ —Å heli_pandas

### –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
*–ö—Ä–∞—Ç–∫–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è (–¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –°–ö–†–ò–ü–¢ 2-12)*
- **status_overhaul** - –¥–∞–Ω–Ω—ã–µ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞ –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –í–° (13 –ø–æ–ª–µ–π)
- **program_ac** - —Ä–µ–µ—Å—Ç—Ä –í–° –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ (11 –ø–æ–ª–µ–π)
- **dict_status_flat** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (6 –∑–Ω–∞—á–µ–Ω–∏–π)
- **dict_aircraft_number_flat** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –í–° —Å ac_type_mask (279 –í–°)
- **dict_digital_values_flat** - –º–µ—Ç–∞-—Å–ª–æ–≤–∞—Ä—å –≤—Å–µ—Ö –ø–æ–ª–µ–π Extract —Å–∏—Å—Ç–µ–º—ã

### **–¢–µ–Ω–∑–æ—Ä—ã –¥–ª—è Flame GPU (–î–∞—Ç–∞: 2025-07-20)**
- **`flight_program_fl`** - –ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–ª–µ—Ç—ã –ø–ª–∞–Ω–µ—Ä–æ–≤ (~1.1M –∑–∞–ø–∏—Å–µ–π)
  - **–ü–æ–ª—è**: aircraft_number, dates, daily_hours, ac_type_mask
  - **daily_hours**: –ù–û–†–ú–ê–¢–ò–í–ù–´–ô –Ω–∞–ª–µ—Ç (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏)
  - **daily_flight** (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è): –†–ï–ê–õ–¨–ù–´–ô –Ω–∞–ª–µ—Ç –ø–æ—Å–ª–µ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
  - **MultiBOM**: –ü–ª–∞–Ω–µ—Ä—ã –∫–∞–∫ –∫–æ—Ä–Ω–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤
- **`flight_program_ac`** - –û–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ø–æ—Å—Ç–∞–≤–∫–∏ –í–° (4000 –∑–∞–ø–∏—Å–µ–π)
  - **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è flat —Å –ª–µ–≥–∫–∏–º–∏ —Ç–∏–ø–∞–º–∏ (UInt16/UInt8/Int8)
  - **–ü–æ–ª—è**: dates, ops_counter_*, trigger_program_*, new_counter_mi17
  - **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: Trigger –ª–æ–≥–∏–∫–∞ —Å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–æ–π –ø–µ—Ä–≤–æ–π –¥–∞—Ç—ã

## üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ data_input

**–†–∞–∑–º–µ—â–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤:**
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –≤ `data_input/`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls
- –ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8 –∏–ª–∏ CP1251

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Excel:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: partno, serialno, name
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏: oh, ll, sne, ppr, oh_threshold
- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
- –î–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω: `Status_Components_YYYYMMDD.xlsx`

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤:**
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: –¥–æ 100MB
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–æ 1M –∑–∞–ø–∏—Å–µ–π –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–±–∏–µ–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name

**–ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name, oh, ll, sne, ppr, oh_threshold

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Extract

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- BATCH_SIZE=10000 (—Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –≤—Å—Ç–∞–≤–∫–∏)
- MAX_RETRIES=3 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫)
- TIMEOUT_SECONDS=300 (—Ç–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–π)

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Extract

### –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

**–ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø–∏—Å–µ–π
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã Extract

1. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π (partno, serialno)
2. **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∑–∞–º–µ–Ω–∞ –Ω–∞ NULL
3. **–ü—Ä–æ–±–ª–µ–º—ã –∫–æ–¥–∏—Ä–æ–≤–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CP1251/UTF-8
4. **–ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –ø–∞–∫–µ—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

## üöÅ –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ aircraft_number —Å ac_type_mask

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–ª–æ–≤–∞—Ä—è aircraft_number

**–ü—Ä–æ–±–ª–µ–º–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 19-07-2025):** –°–ª–æ–≤–∞—Ä—å `aircraft_number_dict_flat` —Å–æ–¥–µ—Ä–∂–∞–ª –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `ac_type_mask` –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ ETL —ç—Ç–∞–ø–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
1. **–ü–æ—Ä—è–¥–æ–∫ —ç—Ç–∞–ø–æ–≤**: `enrich_heli_pandas.py` –ø–µ—Ä–µ–º–µ—â–µ–Ω –ü–ï–†–ï–î `dictionary_creator.py`
2. **–°—Ç—Ä–æ–≥–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –¢–æ–ª—å–∫–æ –í–° —Å –ø–ª–∞–Ω–µ—Ä–Ω—ã–º–∏ partno –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Å–ª–æ–≤–∞—Ä—å
3. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å**: ac_type_mask –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –æ—Ç –ª—é–±—ã—Ö –∑–∞–ø–∏—Å–µ–π –í–° —á–µ—Ä–µ–∑ JOIN

**–ü–ª–∞–Ω–µ—Ä–Ω—ã–µ partno –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- –ú–ò-8–¢, –ú–ò-8–ü, –ú–ò-8–ü–°, –ú–ò-8–¢–ü, –ú–ò-8–ê–ú–¢, –ú–ò-8–ú–¢–í (ac_type_mask = 32)
- –ú–ò-17, –ú–ò-26 (ac_type_mask = 64)

**–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ **279 –í–°** –≤ —Å–ª–æ–≤–∞—Ä–µ (–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –ø–æ –ø–ª–∞–Ω–µ—Ä–∞–º)
- ‚úÖ **163 –í–° —Å ac_type_mask = 32** (–ú–∏-8 —Å–µ–º–µ–π—Å—Ç–≤–æ)
- ‚úÖ **116 –í–° —Å ac_type_mask = 64** (–ú–∏-17 —Å–µ–º–µ–π—Å—Ç–≤–æ)
- ‚úÖ **dictGet('aircraft_number_dict_flat', 'ac_type_mask', aircraft_number)** —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è Flame GPU

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ac_type_mask –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∏–ø–∞ –í–° –ø–æ –Ω–æ–º–µ—Ä—É —á–µ—Ä–µ–∑ dictGet:
- –ü–æ–ª—É—á–µ–Ω–∏–µ ac_type_mask –ø–æ aircraft_number
- –ü–æ–ª—É—á–µ–Ω–∏–µ registration_code –ø–æ aircraft_number  
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö heli_pandas —Å dict_aircraft_number_flat
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –í–° —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CASE –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

## üîß –ü—Ä–æ–±–ª–µ–º—ã —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 19-07-2025)

### –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥—ã OB-/OM-

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –∏—Å—Ö–æ–¥–Ω–æ–º Excel –±—ã–ª–∏ –∑–∞–ø–∏—Å–∏ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏ `OB-` –∏ `OM-` –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö `RA-`.

**–í–ª–∏—è–Ω–∏–µ –Ω–∞ ETL:**
- `aircraft_number_processor.py` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `RA-` —Ñ–æ—Ä–º–∞—Ç
- –ó–∞–ø–∏—Å–∏ —Å `OB-/OM-` –ø–æ–ª—É—á–∞–ª–∏ `aircraft_number = 0` –∏ `location = ''`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 3100 –∑–∞–ø–∏—Å–µ–π "–º—É—Å–æ—Ä–∞" –≤ heli_pandas

**–†–µ—à–µ–Ω–∏–µ:**
1. **–†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Excel** - –∏—Å–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å `OB-/OM-` —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π
2. **–ò—Å–∫–ª—é—á–µ–Ω—ã —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã** —ç—Ç–∏—Ö –í–°
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ 279 –í–° –≤–º–µ—Å—Ç–æ 284

### –ê–Ω–∞–ª–∏–∑ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –±–µ–∑ –í–°

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:** 3100 –∑–∞–ø–∏—Å–µ–π —Å `aircraft_number = 0` –≤ heli_pandas - —ç—Ç–æ –ù–ï –≥—Ä—è–∑—å, –∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- **–ê–≥—Ä–µ–≥–∞—Ç—ã –Ω–∞ —Å–∫–ª–∞–¥–µ** (–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –í–°)
- **–ó–∞–ø–∞—Å–Ω—ã–µ —á–∞—Å—Ç–∏** –≤ —Ä–µ–º–æ–Ω—Ç–µ  
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ —Ä–µ–∑–µ—Ä–≤–µ**

**–í–∞–∂–Ω–æ:** –≠—Ç–∏ –∑–∞–ø–∏—Å–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ –¥–ª—è —É—á–µ—Ç–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –Ω–æ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ —Å–ª–æ–≤–∞—Ä—è aircraft_number.

### –£—Ç–∏–ª–∏—Ç–∞ –æ—á–∏—Å—Ç–∫–∏ —Å–ª–æ–≤–∞—Ä–µ–π

**–§–∞–π–ª:** `code/utils/cleanup_dictionaries.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π –ø—Ä–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ "–∞–¥–¥–∏—Ç–∏–≤–Ω–æ–π –≥—Ä—è–∑–∏"

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
–ó–∞–ø—É—Å–∫ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º yes –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π.

**–ß—Ç–æ —É–¥–∞–ª—è–µ—Ç:**
- –í—Å–µ Dictionary –æ–±—ä–µ–∫—Ç—ã (aircraft_number_dict_flat, status_dict_flat –∏ –¥—Ä.)
- –í—Å–µ —Å–ª–æ–≤–∞—Ä–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (dict_aircraft_number_flat, dict_status_flat –∏ –¥—Ä.)
- –ù–ï —Ç—Ä–æ–≥–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (heli_pandas, md_components –∏ –¥—Ä.)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Å–ª–æ–≤–∞—Ä—è—Ö
- –ü–µ—Ä–µ–¥ —á–∏—Å—Ç–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π ETL
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–æ–≤–∞—Ä–µ–π

## üßπ –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —É–±–æ—Ä–∫–∏

*–ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —É–±–æ—Ä–∫–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ `.cursorrules` —Ä–∞–∑–¥–µ–ª "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É–±–æ—Ä–∫–∞ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞"*

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è repair_days –∏ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–î–∞—Ç–∞: 26-07-2025)

## üéØ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–ª–µ–π MacroProperty1 –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (–î–∞—Ç–∞: 28-07-2025)

### –ó–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö GPU

**–¶–µ–ª—å:** –ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç Float64 –∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º GPU-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ `md_components`.

#### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ–ª—è—Ö:

| **–ü–æ–ª–µ** | **–ë—ã–ª–æ** | **–°—Ç–∞–ª–æ** | **–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è** |
|----------|----------|-----------|----------------------|
| `ac_typ` | `Nullable(String)` | `ac_type_mask` `Nullable(UInt8)` | **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ + –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** String‚Üí–±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ –¥–ª—è GPU |
| `sne` | `Nullable(Float64)` | `sne_new` `Nullable(UInt32)` | **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ + –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** Float64‚ÜíUInt32 –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| `ppr` | `Nullable(Float64)` | `ppr_new` `Nullable(UInt32)` | **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ + –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** Float64‚ÜíUInt32 –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ | `Float64` | `UInt8/UInt16/UInt32/Float32` | **–ú–∞—Å—Å–æ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥ GPU –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É |

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

**1. `calculate_beyond_repair.py`:**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —É—Å—Ç–∞—Ä–µ–≤—à–µ–µ –ø–æ–ª–µ `ac_typ`
- **–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ `ac_type_mask`

**2. `digital_values_dictionary_creator.py`:**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `field_key` —Å–æ–∑–¥–∞–≤–∞–ª –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–æ–ª–µ–π
- **–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω –Ω–∞ `(table_name, field_name)` –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏

**3. `flame_macroproperty1_loader.py`:**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≥—Ä—É–∂–∞–ª –≤—Å–µ –ø–æ–ª—è –≤–º–µ—Å—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
- **–†–µ—à–µ–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ 20 –ø–æ–ª–µ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤–∫–ª—é—á–∞—è `ac_type_mask`, `sne_new`, `ppr_new`

#### –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

‚úÖ **–í—Å–µ –ø–æ–ª—è MacroProperty1 –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è GPU**  
‚úÖ **Extract –ø–∞–π–ø–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ (12/12 —ç—Ç–∞–ø–æ–≤)**  
‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –µ–¥–∏–Ω–∞: 2025-07-04 v1 –ø–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º**  
‚úÖ **Flame GPU –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

### –ü—Ä–æ–±–ª–µ–º–∞ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ò—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- `dual_loader.py` (–≠–¢–ê–ü 4) —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–ª `repair_days`, –Ω–æ –Ω—É–∂–¥–∞–ª—Å—è –≤ `repair_time` –∏–∑ `md_components`
- `md_components_enricher.py` (–≠–¢–ê–ü 7) –∑–∞–ø–æ–ª–Ω—è–ª `repair_time`, –Ω–æ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è –ü–û–°–õ–ï `dual_loader.py`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `repair_days`

### –†–µ—à–µ–Ω–∏–µ: –í—ã–Ω–æ—Å —Ä–∞—Å—á–µ—Ç–∞ repair_days –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø

**–ù–æ–≤—ã–π —ç—Ç–∞–ø 8: `repair_days_calculator.py`**
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: md_components (—Å repair_time), heli_pandas (—Å status_id=4), status_overhaul
- **–ü–æ–∑–∏—Ü–∏—è**: –ü–û–°–õ–ï md_components_enricher.py
- **–§–æ—Ä–º—É–ª–∞**: `repair_days = repair_time - (target_date - version_date)`

### –ù–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞ repair_days

**–ë—ã–ª–æ (–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ):**
```python
repair_days = (target_date - version_date).days  # –î–Ω–∏ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–∞
```

**–°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```python
repair_days = repair_time - (target_date - version_date).days  # –î–Ω–∏ —Ä–µ–º–æ–Ω—Ç–∞ —É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–µ
```

**–õ–æ–≥–∏–∫–∞:**
- `repair_time` - –æ–±—â–µ–µ –≤—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞ (–∏–∑ md_components, –Ω–∞–ø—Ä–∏–º–µ—Ä 180 –¥–Ω–µ–π)
- `(target_date - version_date)` - –¥–Ω–∏ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–∞
- `repair_days` - —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π —Ä–µ–º–æ–Ω—Ç–∞ —É–∂–µ –ø—Ä–æ—à–ª–æ

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á–µ—Ç–∞:**
- –í–° 22215: `repair_days = 180 - (2025-09-05 - 2025-07-04) = 180 - 63 = 117` ‚úÖ
- –í–° 22431: `repair_days = 180 - (2025-07-27 - 2025-07-04) = 180 - 23 = 157` ‚úÖ

### –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è status=4

**–ù–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ status=4 (–†–µ–º–æ–Ω—Ç):**
1. `sched_start_date` –Ω–µ –ø—É—Å—Ç–∞—è –ò –º–µ–Ω—å—à–µ `version_date` –ò–õ–ò
2. `act_start_date` –Ω–µ –ø—É—Å—Ç–∞—è –ò –º–µ–Ω—å—à–µ `version_date`
3. –ü—Ä–∏ –æ–±–µ–∏—Ö –ø—É—Å—Ç—ã—Ö –¥–∞—Ç–∞—Ö ‚Üí –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å status=4
4. –ü—Ä–∏ –¥–∞—Ç–∞—Ö –±–æ–ª—å—à–µ `version_date` ‚Üí –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å status=4

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ò—Å–∫–ª—é—á–µ–Ω—ã –í–° —Å –±—É–¥—É—â–∏–º–∏ –¥–∞—Ç–∞–º–∏ –Ω–∞—á–∞–ª–∞ —Ä–µ–º–æ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –í–° 24116)

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ Extract –ø–∞–π–ø–ª–∞–π–Ω–∞ (–∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ 28-07-2025)

```
–≠–¢–ê–ü 7: md_components_enricher.py              ‚Üí –∑–∞–ø–æ–ª–Ω—è–µ—Ç repair_time
–≠–¢–ê–ü 8: dictionary_creator.py                  ‚Üí —Å–æ–∑–¥–∞–µ—Ç —Å–ª–æ–≤–∞—Ä–∏
–≠–¢–ê–ü 9-11: program_fl/ac/digital_values       ‚Üí —Ç–µ–Ω–∑–æ—Ä—ã –∏ –º–µ—Ç–∞-—Å–ª–æ–≤–∞—Ä–∏
–≠–¢–ê–ü 12: repair_days_calculator.py            ‚Üí —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç repair_days (–§–ò–ù–ê–õ–¨–ù–´–ô)
```

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- `code/repair_days_calculator.py` - –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç —Ä–∞—Å—á–µ—Ç–∞
- `code/overhaul_status_processor.py` - —É–±—Ä–∞–Ω —Ä–∞—Å—á–µ—Ç repair_days  
- `code/extract_master.py` - repair_days_calculator.py –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ –∫–æ–Ω–µ—Ü (—ç—Ç–∞–ø 12)
- `docs/extract.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ –í—Å–µ 7 –í–° –≤ —Ä–µ–º–æ–Ω—Ç–µ –ø–æ–ª—É—á–∏–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è repair_days

---

## üìä –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ETL —Å–∫—Ä–∏–ø—Ç–æ–≤

### –°–ö–†–ò–ü–¢ 1: `md_components_loader.py` (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 28-07-2025)

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 1 (–ø–µ—Ä–≤—ã–π –≤ Extract –ø–∞–π–ø–ª–∞–π–Ω–µ) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –°–£–ë–î** | ‚úÖ `md_components` (MergeTree) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚úÖ `df` (pandas from Excel) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | `data_input/master_data/MD_–°omponents.xlsx` |
| **–õ–∏—Å—Ç Excel** | "–ê–≥—Ä–µ–≥–∞—Ç—ã" (header=1, –≤—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞) |
| **ENGINE ClickHouse** | `MergeTree()` |
| **ORDER BY** | `(version_date, version_id)` |
| **PARTITION BY** | `toYYYYMM(version_date)` |

#### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `md_components` (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è MacroProperty1):

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty1** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `partno` | `Nullable(String)` | - | ‚ùå | Excel | –ß–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä |
| 2 | `comp_number` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ –í–° (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 3 | `group_by` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 4 | `ac_type_mask` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | **–¢–∏–ø –í–° –º–∞—Å–∫–∞ (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –∏–∑ ac_typ, String‚ÜíUInt8)** |
| 5 | `type_restricted` | `Nullable(UInt8)` | `multihot[u8]` | ‚úÖ | Excel | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ —Ç–∏–ø—É (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 6 | `common_restricted1` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | –û–±—â–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 7 | `common_restricted2` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | –û–±—â–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 2 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 8 | `trigger_interval` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 9 | `partout_time` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | –í—Ä–µ–º—è —Å–Ω—è—Ç–∏—è (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 10 | `assembly_time` | `Nullable(UInt8)` | `uint8` | ‚úÖ | Excel | –í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt8) |
| 11 | `repair_time` | `Nullable(UInt16)` | `uint16` | ‚úÖ | Excel | –í—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt16) |
| 12 | `ll_mi8` | `Nullable(UInt32)` | `uint32` | ‚úÖ | Excel | LL –ú–ò-8 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt32) |
| 13 | `oh_mi8` | `Nullable(UInt32)` | `uint32` | ‚úÖ | Excel | OH –ú–ò-8 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt32) |
| 14 | `oh_threshold_mi8` | `Nullable(UInt32)` | `uint32` | ‚úÖ | Excel | –ü–æ—Ä–æ–≥ OH –ú–ò-8 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt32) |
| 15 | `ll_mi17` | `Nullable(UInt32)` | `uint32` | ‚úÖ | Excel | LL –ú–ò-17 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt32) |
| 16 | `oh_mi17` | `Nullable(UInt32)` | `uint32` | ‚úÖ | Excel | OH –ú–ò-17 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíUInt32) |
| 17 | `repair_price` | `Nullable(Float32)` | - | ‚ùå | Excel | –¶–µ–Ω–∞ —Ä–µ–º–æ–Ω—Ç–∞ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíFloat32) |
| 18 | `purchase_price` | `Nullable(Float32)` | - | ‚ùå | Excel | –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ Float64‚ÜíFloat32) |
| 19 | `sne_new` | `Nullable(UInt32)` | `uint32` | ‚úÖ | Excel | **SNE (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –∏–∑ sne, Float64‚ÜíUInt32)** |
| 20 | `ppr_new` | `Nullable(UInt32)` | `uint32` | ‚úÖ | Excel | **PPR (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –∏–∑ ppr, Float64‚ÜíUInt32)** |
| 21 | `version_date` | `Date` | `Date` | ‚ùå | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ |
| 22 | `version_id` | `UInt8` | `uint8` | ‚ùå | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | ID –≤–µ—Ä—Å–∏–∏ |
| 23 | `br` | `Nullable(UInt32)` | `uint32` | ‚úÖ | **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | Beyond Repair (calculate_beyond_repair.py) |
| 24 | `partno_comp` | `Nullable(UInt32)` | `uint32` | ‚úÖ | **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | Component ID (md_components_enricher.py) |
| 25 | `restrictions_mask` | `UInt8` | `multihot[u8]` | ‚úÖ | **–†–∞—Å—á–µ—Ç** | –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (type_restricted*1+common_restricted1*2+common_restricted2*4+trigger_interval*8) |

### –°–ö–†–ò–ü–¢ 2: `status_overhaul_loader.py`

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 2 (–≤—Ç–æ—Ä–æ–π –≤ Extract –ø–∞–π–ø–ª–∞–π–Ω–µ) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –°–£–ë–î** | ‚úÖ `status_overhaul` (MergeTree) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚úÖ `df` (pandas from Excel) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | `data_input/source_data/Status_Overhaul.xlsx` |
| **–õ–∏—Å—Ç Excel** | "Status_Overhaul" (header=0, –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞) |
| **ENGINE ClickHouse** | `MergeTree()` |
| **ORDER BY** | `(ac_registr, wpno, status, version_date, version_id)` |
| **PARTITION BY** | `toYYYYMM(version_date)` |

#### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `status_overhaul`:

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `ac_registr` | `UInt32` | - | ‚ùå | Excel | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –í–° |
| 2 | `ac_typ` | `String` | - | ‚ùå | Excel | –¢–∏–ø –í–° (–ú–ò8, –ú–ò8–ê–ú–¢) |
| 3 | `wpno` | `String` | - | ‚ùå | Excel | –ù–æ–º–µ—Ä —Ä–∞–±–æ—á–µ–≥–æ –ø–∞–∫–µ—Ç–∞ |
| 4 | `description` | `String` | - | ‚ùå | Excel | –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç |
| 5 | `sched_start_date` | `Nullable(Date)` | - | ‚ùå | Excel | –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ |
| 6 | `sched_end_date` | `Nullable(Date)` | - | ‚ùå | Excel | –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è |
| 7 | `act_start_date` | `Nullable(Date)` | - | ‚ùå | Excel | –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ |
| 8 | `act_end_date` | `Nullable(Date)` | - | ‚ùå | Excel | –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è |
| 9 | `status` | `String` | - | ‚ùå | Excel | –°—Ç–∞—Ç—É—Å (–ó–∞–∫—Ä—ã—Ç–æ, –í –ø—Ä–æ—Ü–µ—Å—Å–µ, –û—Ç–∫—Ä—ã—Ç–æ) |
| 10 | `owner` | `String` | - | ‚ùå | Excel | –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ |
| 11 | `operator` | `String` | - | ‚ùå | Excel | –û–ø–µ—Ä–∞—Ç–æ—Ä |
| 12 | `version_date` | `Date` | - | ‚ùå | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö |
| 13 | `version_id` | `UInt8` | - | ‚ùå | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | ID –≤–µ—Ä—Å–∏–∏ |

### –°–ö–†–ò–ü–¢ 3: `program_ac_loader.py`

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 3 (—Ç—Ä–µ—Ç–∏–π –≤ Extract –ø–∞–π–ø–ª–∞–π–Ω–µ) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –°–£–ë–î** | ‚úÖ `program_ac` (MergeTree) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚úÖ `df` (pandas from Excel) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | `data_input/source_data/Program_AC.xlsx` |
| **–õ–∏—Å—Ç Excel** | "Program_AC" (header=0, –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞) |
| **ENGINE ClickHouse** | `MergeTree()` |
| **ORDER BY** | `(ac_registr, ac_typ, version_date, version_id)` |
| **PARTITION BY** | `toYYYYMM(version_date)` |

#### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `program_ac`:

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `ac_registr` | `UInt32` | - | ‚ùå | Excel | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –í–° |
| 2 | `ac_typ` | `String` | - | ‚ùå | Excel | –¢–∏–ø –í–° (350B3, 355NP, –ú–ò8–ú–¢–í, –ú–ò26–¢) |
| 3 | `object_type` | `String` | - | ‚ùå | Excel | –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ (HELICOPTER) |
| 4 | `description` | `String` | - | ‚ùå | Excel | –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –í–° |
| 5 | `owner` | `String` | - | ‚ùå | Excel | –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ (–Æ–¢-–í–£, CHOPPER LL, –ì–¢–õ–ö) |
| 6 | `operator` | `String` | - | ‚ùå | Excel | –≠–∫—Å–ø–ª—É–∞—Ç–∞–Ω—Ç (–Æ–¢-–í–£) |
| 7 | `homebase` | `String` | - | ‚ùå | Excel | –ö–æ–¥ –±–∞–∑—ã –ø—Ä–∏–ø–∏—Å–∫–∏ (–¢–Æ–ú, –°–£–†, –ù–û–Ø) |
| 8 | `homebase_name` | `String` | - | ‚ùå | Excel | –ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –ø—Ä–∏–ø–∏—Å–∫–∏ |
| 9 | `directorate` | `String` | - | ‚ùå | Excel | –î–∏—Ä–µ–∫—Ü–∏—è (–ó–ê–ü–ê–î–ù–û-–°–ò–ë–ò–†–°–ö–ê–Ø –î–ò–†–ï–ö–¶–ò–Ø) |
| 10 | `version_date` | `Date` | - | ‚ùå | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö |
| 11 | `version_id` | `UInt8` | - | ‚ùå | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | ID –≤–µ—Ä—Å–∏–∏ |

### –°–ö–†–ò–ü–¢ 4: `dual_loader.py`

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 4 (—á–µ—Ç–≤–µ—Ä—Ç—ã–π –≤ Extract –ø–∞–π–ø–ª–∞–π–Ω–µ) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –°–£–ë–î** | ‚úÖ `heli_raw` + `heli_pandas` (MergeTree) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚úÖ `df` (pandas from Excel) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | `data_input/source_data/Status_Components.xlsx` |
| **–õ–∏—Å—Ç Excel** | "Status_Components" (header=0, –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞) |
| **ENGINE ClickHouse** | `MergeTree()` |
| **ORDER BY** | `(version_date, version_id)` |
| **PARTITION BY** | `toYYYYMM(version_date)` |

#### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `heli_pandas` (–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞):

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `partno` | `Nullable(String)` | - | ‚ùå | Excel | –ß–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |
| 2 | `serialno` | `Nullable(String)` | - | ‚ùå | Excel | –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |
| 3 | `ac_typ` | `Nullable(String)` | - | ‚ùå | Excel | –¢–∏–ø –í–° |
| 4 | `location` | `Nullable(String)` | - | ‚ùå | Excel | –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |
| 5 | `mfg_date` | `Nullable(Date)` | `Date` | ‚úÖ MacroProperty3 | Excel | –î–∞—Ç–∞ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è |
| 6 | `removal_date` | `Nullable(Date)` | - | ‚ùå | Excel | –î–∞—Ç–∞ —Å–Ω—è—Ç–∏—è |
| 7 | `target_date` | `Nullable(Date)` | - | ‚ùå | Excel | –¶–µ–ª–µ–≤–∞—è –¥–∞—Ç–∞ |
| 8 | `condition` | `Nullable(String)` | - | ‚ùå | Excel | –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |
| 9 | `owner` | `Nullable(String)` | - | ‚ùå | Excel | –í–ª–∞–¥–µ–ª–µ—Ü |
| 10 | `lease_restricted` | `UInt8` | `uint8` | ‚úÖ MacroProperty3 | Excel | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ª–∏–∑–∏–Ω–≥–∞ |
| 11 | `oh` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty3 | Excel | Overhaul —Ä–µ—Å—É—Ä—Å |
| 12 | `oh_threshold` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty3 | Excel | –ü–æ—Ä–æ–≥ Overhaul |
| 13 | `ll` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty3 | Excel | Life limit —Ä–µ—Å—É—Ä—Å |
| 14 | `sne` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty3 | Excel | SNE —Ä–µ—Å—É—Ä—Å |
| 15 | `ppr` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty3 | Excel | PPR —Ä–µ—Å—É—Ä—Å |
| 16 | `version_date` | `Date` | `Date` | ‚úÖ Property | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ |
| 17 | `version_id` | `UInt8` | `uint8` | ‚úÖ Property | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | ID –≤–µ—Ä—Å–∏–∏ |
| 18 | `partseqno_i` | `Nullable(UInt32)` | `uint16` | ‚úÖ MacroProperty3 | Excel | ID –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞ –∏–∑ Excel |
| 19 | `psn` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty3 | Excel | ID —Å–µ—Ä–∏–π–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∏–∑ Excel |
| 20 | `address_i` | `Nullable(UInt16)` | `uint16` | ‚úÖ MacroProperty3 | Excel | ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏–∑ Excel |
| 21 | `ac_type_i` | `Nullable(UInt16)` | - | ‚ùå | Excel | ID —Ç–∏–ø–∞ –í–° –∏–∑ Excel |
| 22 | `status_id` | `UInt8` | `uint8` | ‚úÖ MacroProperty3 | **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (status_processor.py) |
| 23 | `repair_days` | `Nullable(UInt16)` | `uint16` | ‚úÖ MacroProperty3 | **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | –î–Ω–∏ —Ä–µ–º–æ–Ω—Ç–∞ (repair_days_calculator.py) |
| 24 | `aircraft_number` | `UInt32` | `uint32` | ‚úÖ MacroProperty3 | **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | –ù–æ–º–µ—Ä –í–° (aircraft_number_processor.py) |
| 25 | `ac_type_mask` | `UInt8` | `multihot[u8]` | ‚úÖ MacroProperty3 | **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–∞ –í–° (enrich_heli_pandas.py) |

### –°–ö–†–ò–ü–¢ 5: `enrich_heli_pandas.py`

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 5 (–ø—è—Ç—ã–π –≤ Extract –ø–∞–π–ø–ª–∞–π–Ω–µ) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –°–£–ë–î** | ‚ùå (–æ–±–æ–≥–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é `heli_pandas`) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚ùå (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å ClickHouse –Ω–∞–ø—Ä—è–º—É—é) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | `dict_ac_type_flat` –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–∞—Å–∫–∏ |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—è `ac_type_mask` –±–∏—Ç–æ–≤—ã–º–∏ –º–∞—Å–∫–∞–º–∏ |
| **–û–ø–µ—Ä–∞—Ü–∏—è** | `ALTER TABLE heli_pandas UPDATE` |

#### –û–±–æ–≥–∞—â–∞–µ–º–æ–µ –ø–æ–ª–µ:

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `ac_type_mask` | `UInt8` | `multihot[u8]` | ‚úÖ MacroProperty3 | **–û–±–æ–≥–∞—â–µ–Ω–∏–µ** | –ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ —Ç–∏–ø–æ–≤ –í–° –¥–ª—è multihot –æ–ø–µ—Ä–∞—Ü–∏–π |

#### –ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ —Ç–∏–ø–æ–≤ –í–° (–•–ê–†–î–ö–û–î):

‚ö†Ô∏è **–•–ê–†–î–ö–û–î –ö–û–ù–°–¢–ê–ù–¢–´** –≤ `code/enrich_heli_pandas.py` (—Å—Ç—Ä–æ–∫–∏ 32-48):

| **–¢–∏–ø –í–°** | **–ú–∞—Å–∫–∞** | **–î–≤–æ–∏—á–Ω–æ–µ** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|------------|-----------|--------------|--------------|
| `–ú–∏-26`, `–ú–ò26–¢` | 128 | `0b10000000` | –¢—è–∂–µ–ª—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –≤–µ—Ä—Ç–æ–ª–µ—Ç |
| `–ú–∏-17`, `–ú–ò171`, `171–ê2`, `–ú–ò171–ï` | 64 | `0b01000000` | –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ-–±–æ–µ–≤–æ–π –≤–µ—Ä—Ç–æ–ª–µ—Ç |
| `–ú–∏-8–¢`, `–ú–ò8–ú–¢–í`, `–ú–ò8`, `–ú–ò8–ê–ú–¢` | 32 | `0b00100000` | –ú–Ω–æ–≥–æ—Ü–µ–ª–µ–≤–æ–π –≤–µ—Ä—Ç–æ–ª–µ—Ç |
| `–ö–ê32–¢` | 16 | `0b00010000` | –ü–∞–ª—É–±–Ω—ã–π –≤–µ—Ä—Ç–æ–ª–µ—Ç –ö–∞–º–æ–≤ |
| `350B3` | 8 | `0b00001000` | Airbus H350 |
| `355NP`, `355N` | 4 | `0b00000100` | Airbus H355 |
| `R44`, `R44I`, `R44II` | 2 | `0b00000010` | Robinson R44 |



### –°–ö–†–ò–ü–¢ 6: `calculate_beyond_repair.py` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 28-07-2025)

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 6 (—à–µ—Å—Ç–æ–π –≤ Extract –ø–∞–π–ø–ª–∞–π–Ω–µ) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –°–£–ë–î** | ‚ùå (–æ–±–æ–≥–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é `md_components`) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚ùå (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å ClickHouse –Ω–∞–ø—Ä—è–º—É—é) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | –ü–æ–ª—è `md_components`: `repair_price`, `purchase_price`, `ll_mi8/mi17`, `oh_threshold_mi8/mi17`, **`ac_type_mask`** |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Ä–æ–≥–∞ —Å–ø–∏—Å–∞–Ω–∏—è (Beyond Repair) |
| **–û–ø–µ—Ä–∞—Ü–∏—è** | `ALTER TABLE md_components UPDATE` |

#### –û–±–æ–≥–∞—â–∞–µ–º–æ–µ –ø–æ–ª–µ:

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `br` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty1 | **–†–∞—Å—á–µ—Ç** | Beyond Repair - –ø–æ—Ä–æ–≥–æ–≤–∞—è –Ω–∞—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è |

#### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ Beyond Repair:

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞:**
```
BR = NR - (RepairPrice / ((PurchasePrice - RepairPrice) / NR + RepairPrice / MRR))
```

**–ì–¥–µ:**
- `NR` = –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å (`ll_mi8` –∏–ª–∏ `ll_mi17`)
- `MRR` = –ú–µ–∂—Ä–µ–º–æ–Ω—Ç–Ω—ã–π —Ä–µ—Å—É—Ä—Å (`oh_threshold_mi8` –∏–ª–∏ `oh_threshold_mi17`) 
- `RepairPrice` = –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–º–æ–Ω—Ç–∞ (`repair_price`)
- `PurchasePrice` = –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏ (`purchase_price`)

### –°–ö–†–ò–ü–¢ 7: `md_components_enricher.py`

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 7 (—Å–µ–¥—å–º–æ–π –≤ Extract –ø–∞–π–ø–ª–∞–π–Ω–µ) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –°–£–ë–î** | ‚ùå (–æ–±–æ–≥–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é `md_components`) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚ùå (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å ClickHouse –Ω–∞–ø—Ä—è–º—É—é) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | `dict_partno_flat` (—Å–ª–æ–≤–∞—Ä—å –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ ID –∏–∑ AMOS) |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –û–±–æ–≥–∞—â–µ–Ω–∏–µ –ø–æ–ª—è `partno_comp` —Ü–∏—Ñ—Ä–æ–≤—ã–º–∏ ID –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ |
| **–û–ø–µ—Ä–∞—Ü–∏—è** | `ALTER TABLE md_components UPDATE` |

#### –û–±–æ–≥–∞—â–∞–µ–º–æ–µ –ø–æ–ª–µ:

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `partno_comp` | `Nullable(UInt32)` | `uint32` | ‚úÖ MacroProperty1 | **–°–ª–æ–≤–∞—Ä—å** | Component ID –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞ –∏–∑ AMOS (partseqno_i) |

#### –õ–æ–≥–∏–∫–∞ –æ–±–æ–≥–∞—â–µ–Ω–∏—è:

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:**
```sql
SELECT partseqno_i, partno FROM dict_partno_flat
```


**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ `partno_comp`:**
- –°–≤—è–∑—ã–≤–∞–µ—Ç `md_components.partno` —Å `heli_pandas.partseqno_i`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `repair_days_calculator.py` –¥–ª—è –ø–æ–∏—Å–∫–∞ `repair_time`
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—É—é –Ω—É–º–µ—Ä–∞—Ü–∏—é –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ –≤ Flame GPU MacroProperty1

### –°–ö–†–ò–ü–¢ 8: `repair_days_calculator.py` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 28-07-2025)

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 12 (–ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ –∫–æ–Ω–µ—Ü –ø–∞–π–ø–ª–∞–π–Ω–∞) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –°–£–ë–î** | ‚ùå (–æ–±–æ–≥–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é `heli_pandas`) |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚ùå (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å ClickHouse –Ω–∞–ø—Ä—è–º—É—é) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | `md_components.repair_time`, `heli_pandas.target_date`, `status_overhaul.sched_end_date` |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –†–∞—Å—á–µ—Ç –¥–Ω–µ–π —Ä–µ–º–æ–Ω—Ç–∞ –¥–ª—è –í–° –≤ —Å—Ç–∞—Ç—É—Å–µ 4 (–†–µ–º–æ–Ω—Ç) |
| **–û–ø–µ—Ä–∞—Ü–∏—è** | `ALTER TABLE heli_pandas UPDATE` |

#### –û–±–æ–≥–∞—â–∞–µ–º–æ–µ –ø–æ–ª–µ:

| **‚Ññ** | **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty** | **–ò—Å—Ç–æ—á–Ω–∏–∫** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|----------|-------------------|--------------|-------------------|--------------|--------------|
| 1 | `repair_days` | `Nullable(UInt16)` | `uint16` | ‚úÖ MacroProperty3 | **–†–∞—Å—á–µ—Ç** | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π —Ä–µ–º–æ–Ω—Ç–∞ (–±—ã–ª–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ) |

#### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ repair_days:

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞:**
```
repair_days = repair_time - (sched_end_date - version_date)
```

**–ì–¥–µ:**
- `repair_time` = –ù–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ –≤—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞ –∏–∑ `md_components` (–¥–Ω–∏)
- `sched_end_date` = –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–∞ –∏–∑ `target_date` –≤ `heli_pandas`
- `version_date` = –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**–õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞:**
1. –í—ã–±–∏—Ä–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –í–° –≤ —Å—Ç–∞—Ç—É—Å–µ 4 (–†–µ–º–æ–Ω—Ç)
2. –ü–æ–∏—Å–∫ `repair_time` –ø–æ `partno_comp` –≤ `md_components`
3. –ï—Å–ª–∏ `repair_time` –Ω–∞–π–¥–µ–Ω–æ ‚Üí —Ä–∞—Å—á–µ—Ç –ø–æ —Ñ–æ—Ä–º—É–ª–µ
4. –ï—Å–ª–∏ `repair_time` –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí `repair_days = NULL`

### –°–ö–†–ò–ü–¢ 9: `dictionary_creator.py` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 28-07-2025)

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä** | 8 (–ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è repair_days) |
| **–°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –°–£–ë–î** | ‚úÖ `dict_partno_flat`, `dict_serialno_flat`, `dict_owner_flat`, `dict_ac_type_flat`, `dict_status_flat`, `dict_aircraft_number_flat` |
| **–°–æ–∑–¥–∞–µ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º** | ‚ùå (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å ClickHouse –Ω–∞–ø—Ä—è–º—É—é) |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | DISTINCT –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `heli_pandas` –∏ `md_components` |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ dictGet –æ–ø–µ—Ä–∞—Ü–∏–π |
| **ENGINE** | `MergeTree()` (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–µ) |

#### –°–æ–∑–¥–∞–≤–∞–µ–º—ã–µ —Å–ª–æ–≤–∞—Ä–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

| **‚Ññ** | **–¢–∞–±–ª–∏—Ü–∞** | **–ö–ª—é—á** | **–ó–Ω–∞—á–µ–Ω–∏–µ** | **MacroProperty** | **–¢–∏–ø** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|-------|-------------|----------|--------------|-------------------|---------|--------------|
| 1 | `dict_partno_flat` | `partseqno_i` | `partno` | ‚ùå | –ê–¥–¥–∏—Ç–∏–≤–Ω–∞—è | –ü–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
| 2 | `dict_serialno_flat` | `psn` | `serialno` | ‚ùå | –ê–¥–¥–∏—Ç–∏–≤–Ω–∞—è | –°–µ—Ä–∏–π–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ |
| 3 | `dict_owner_flat` | `address_i` | `owner` | ‚ùå | –ê–¥–¥–∏—Ç–∏–≤–Ω–∞—è | –í–ª–∞–¥–µ–ª—å—Ü—ã –í–° |
| 4 | `dict_ac_type_flat` | `ac_type_mask` | `ac_typ` | ‚ùå | –ê–¥–¥–∏—Ç–∏–≤–Ω–∞—è | –¢–∏–ø—ã –í–° —Å –±–∏—Ç–æ–≤—ã–º–∏ –º–∞—Å–∫–∞–º–∏ |
| 5 | `dict_status_flat` | `status_id` | `status_name` | ‚ùå | –ù–µ-–∞–¥–¥–∏—Ç–∏–≤–Ω–∞—è | –°—Ç–∞—Ç—É—Å—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
| 6 | `dict_aircraft_number_flat` | `aircraft_number` | `ac_type_mask` | ‚ùå | –ù–µ-–∞–¥–¥–∏—Ç–∏–≤–Ω–∞—è | –ù–æ–º–µ—Ä–∞ –í–° —Å –º–∞—Å–∫–∞–º–∏ —Ç–∏–ø–æ–≤ |

#### –°–ª–æ–≤–∞—Ä—å 1: `dict_partno_flat`

| **–ü–æ–ª–µ** | **–¢–∏–ø** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|---------|----------------|
| `partseqno_i` | `UInt32` | ID –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞ –∏–∑ Excel (–∫–ª—é—á) |
| `partno` | `String` | –ß–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |
| `load_timestamp` | `DateTime` | –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å–∏ |

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `SELECT DISTINCT partseqno_i, partno FROM heli_pandas`
**–õ–æ–≥–∏–∫–∞:** –ê–¥–¥–∏—Ç–∏–≤–Ω–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ, MergeTree

#### –°–ª–æ–≤–∞—Ä—å 2: `dict_serialno_flat`

| **–ü–æ–ª–µ** | **–¢–∏–ø** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|---------|----------------|
| `psn` | `UInt32` | ID —Å–µ—Ä–∏–π–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∏–∑ Excel (–∫–ª—é—á) |
| `serialno` | `String` | –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |
| `load_timestamp` | `DateTime` | –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å–∏ |

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `SELECT DISTINCT psn, serialno FROM heli_pandas`
**–õ–æ–≥–∏–∫–∞:** –ê–¥–¥–∏—Ç–∏–≤–Ω–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ, MergeTree

#### –°–ª–æ–≤–∞—Ä—å 3: `dict_owner_flat`

| **–ü–æ–ª–µ** | **–¢–∏–ø** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|---------|----------------|
| `address_i` | `UInt32` | ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏–∑ Excel (–∫–ª—é—á) |
| `owner` | `String` | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –í–° |
| `load_timestamp` | `DateTime` | –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å–∏ |

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `SELECT DISTINCT address_i, owner FROM heli_pandas`
**–õ–æ–≥–∏–∫–∞:** –ê–¥–¥–∏—Ç–∏–≤–Ω–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ, MergeTree

#### –°–ª–æ–≤–∞—Ä—å 4: `dict_ac_type_flat`

| **–ü–æ–ª–µ** | **–¢–∏–ø** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|---------|----------------|
| `ac_type_mask` | `UInt8` | –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–∞ –í–° (–∫–ª—é—á) |
| `ac_typ` | `String` | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –í–° |
| `load_timestamp` | `DateTime` | –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å–∏ |

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `SELECT DISTINCT ac_typ FROM heli_pandas` + **–•–ê–†–î–ö–û–î –º–∞—Å–æ–∫**
**–õ–æ–≥–∏–∫–∞:** –ê–¥–¥–∏—Ç–∏–≤–Ω–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ + –±–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏, MergeTree
**–•–∞—Ä–¥–∫–æ–¥:** –ú–ò-8‚Üí32, –ú–ò-17‚Üí64, –ú–ò-26‚Üí128, Airbus‚Üí2/4/8/16

#### –°–ª–æ–≤–∞—Ä—å 5: `dict_status_flat`

| **–ü–æ–ª–µ** | **–¢–∏–ø** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|---------|----------------|
| `status_id` | `UInt8` | ID —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–∫–ª—é—á) |
| `status_name` | `String` | –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ |

**–ò—Å—Ç–æ—á–Ω–∏–∫:** **–•–ê–†–î–ö–û–î –∫–æ–Ω—Å—Ç–∞–Ω—Ç** (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è)
**–õ–æ–≥–∏–∫–∞:** –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å, MergeTree
**–•–∞—Ä–¥–∫–æ–¥:** 1-–ù–µ–∞–∫—Ç–∏–≤–Ω–æ, 2-–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è, 3-–ò—Å–ø—Ä–∞–≤–µ–Ω, 4-–†–µ–º–æ–Ω—Ç, 5-–†–µ–∑–µ—Ä–≤, 6-–•—Ä–∞–Ω–µ–Ω–∏–µ

#### –°–ª–æ–≤–∞—Ä—å 6: `dict_aircraft_number_flat`

| **–ü–æ–ª–µ** | **–¢–∏–ø** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|---------|----------------|
| `aircraft_number` | `UInt32` | –ù–æ–º–µ—Ä –í–° (–∫–ª—é—á) |
| `ac_type_mask` | `UInt8` | –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–∞ –í–° |

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `SELECT DISTINCT aircraft_number FROM heli_pandas` + –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –º–∞—Å–∫–∞–º–∏
**–õ–æ–≥–∏–∫–∞:** –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å, MergeTree

---

### –°–ö–†–ò–ü–¢ 10: `program_fl_direct_loader.py` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 28-07-2025)

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–æ–∫** | 9 (–ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è repair_days) |
| **–¢–∞–±–ª–∏—Ü–∞ –≤ –°–£–ë–î** | ‚úÖ –°–æ–∑–¥–∞–µ—Ç `flight_program_fl` (MergeTree) |
| **DataFrame** | ‚úÖ –°–æ–∑–¥–∞–µ—Ç `df` (pandas –∏–∑ Excel `Program.xlsx`, –ª–∏—Å—Ç "2025") |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | `dict_aircraft_number_flat` |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ Excel** | `Program.xlsx` |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ –Ω–∞ 4000 –¥–Ω–µ–π (~1.1M –∑–∞–ø–∏—Å–µ–π) |

#### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `flight_program_fl`:

| **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty5** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|-------------------|--------------|-------------------|----------------|
| `aircraft_number` | `UInt16` | `uint16` | ‚úÖ | –ù–æ–º–µ—Ä –í–° |
| `dates` | `Date` | `Date` | ‚úÖ | –î–∞—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ |
| `daily_hours` | `UInt32` | `uint32` | ‚úÖ | –î–Ω–µ–≤–Ω–æ–π –Ω–∞–ª–µ—Ç –≤ –º–∏–Ω—É—Ç–∞—Ö |
| `ac_type_mask` | `UInt8` | `uint8` | ‚úÖ | –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–∞ –í–° |
| `version_date` | `Date` | `Date` | ‚ùå | –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö |
| `version_id` | `UInt8` | `uint8` | ‚ùå | ID –≤–µ—Ä—Å–∏–∏ |

#### –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:

- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:** 1-serialno (—ç–∫–∑–µ–º–ø–ª—è—Ä—ã), 2-ac_type_mask (—Ç–∏–ø—ã)

**–†–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
- **–ë–∞–∑–æ–≤–∞—è –¥–∞—Ç–∞:** –ø–æ—Å–ª–µ–¥–Ω—è—è `version_date` –∏–∑ `heli_pandas`
- **–ü–µ—Ä–∏–æ–¥:** 4000 –¥–Ω–µ–π –≤–ø–µ—Ä–µ–¥
- **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ:** –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∞—Ç—É ‚Üí –±–µ—Ä–µ–º –ø–æ –¥–Ω—é/–º–µ—Å—è—Ü—É –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –≥–æ–¥–∞

**–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–Ω–∑–æ—Ä–∞:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–µ—Ä–æ–≤ –ø–æ serialno
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—É—Å—Ç—ã—Ö –∏ –Ω—É–ª–µ–≤—ã—Ö –ø–æ–ª–µ–π –≤ –º–∞—Å—Å–∏–≤–µ

---

### –°–ö–†–ò–ü–¢ 11: `program_ac_direct_loader.py` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 28-07-2025)

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–æ–∫** | 10 (–ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è repair_days) |
| **–¢–∞–±–ª–∏—Ü–∞ –≤ –°–£–ë–î** | ‚úÖ –°–æ–∑–¥–∞–µ—Ç `flight_program_ac` (MergeTree) |
| **DataFrame** | ‚úÖ –°–æ–∑–¥–∞–µ—Ç `df` (pandas –∏–∑ Excel `Program_heli.xlsx`, –ª–∏—Å—Ç "2025") |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | `heli_pandas`, `md_components` |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ Excel** | `Program_heli.xlsx` |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–ø–µ—Ä–∞—Ü–∏–π –í–° –Ω–∞ 4000 –¥–Ω–µ–π —Å –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–æ–º |

#### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `flight_program_ac`:

| **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **MacroProperty4** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|-------------------|--------------|-------------------|----------------|
| `dates` | `Date` | `Date` | ‚úÖ | –î–∞—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–ø–µ—Ä–∞—Ü–∏–π |
| `ops_counter_mi8` | `UInt16` | `uint16` | ‚úÖ | –°—á–µ—Ç—á–∏–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –ú–ò-8 |
| `ops_counter_mi17` | `UInt16` | `uint16` | ‚úÖ | –°—á–µ—Ç—á–∏–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –ú–ò-17 |
| `ops_counter_total` | `UInt16` | `uint16` | ‚úÖ | –û–±—â–∏–π —Å—á–µ—Ç—á–∏–∫ –æ–ø–µ—Ä–∞—Ü–∏–π (–≤—ã—á–∏—Å–ª—è–µ–º–æ–µ) |
| `new_counter_mi17` | `UInt8` | `uint8` | ‚úÖ | –ù–æ–≤—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏ –ú–ò-17 |
| `trigger_program_mi8` | `Int8` | `int8` | ‚úÖ | –¢—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã –ú–ò-8 |
| `trigger_program_mi17` | `Int8` | `int8` | ‚úÖ | –¢—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã –ú–ò-17 |
| `trigger_program` | `Int8` | `int8` | ‚úÖ | –û–±—â–∏–π —Ç—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã (–≤—ã—á–∏—Å–ª—è–µ–º–æ–µ) |
| `version_date` | `Date` | `Date` | ‚ùå | –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö |
| `version_id` | `UInt8` | `uint8` | ‚ùå | ID –≤–µ—Ä—Å–∏–∏ |

#### –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö Excel:**
- **–°—Ç—Ä–æ–∫–∞ —Å "–ì–æ–¥":** –≥–æ–¥—ã –ø–æ –º–µ—Å—è—Ü–∞–º/–∫–æ–ª–æ–Ω–∫–∞–º
- **`ops_counter_*`:** –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –í–° –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ (—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–æ –¥–Ω—è–º –º–µ—Å—è—Ü–∞)
- **`new_counter_*`:** –Ω–æ–≤—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞)

**–ü–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥:**
- **`ops_counter_total`** = `ops_counter_mi8` + `ops_counter_mi17`
- **`trigger_program_*`** = —Ç—Ä–∏–≥–≥–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è
- **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π** –ø–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º –≤ —Å—Ç–∞—Ç—É—Å–µ 2 –∏–∑ `heli_pandas`

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ 4000 –¥–∞—Ç
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º
- –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –ø–æ–ª–µ–π

---

### –°–ö–†–ò–ü–¢ 12: `digital_values_dictionary_creator.py` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 28-07-2025)

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **–ó–Ω–∞—á–µ–Ω–∏–µ** |
|-------------------|--------------|
| **–ü–æ—Ä—è–¥–æ–∫** | 11 (–ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª—Å—è –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è repair_days) |
| **–¢–∞–±–ª–∏—Ü–∞ –≤ –°–£–ë–î** | ‚úÖ –°–æ–∑–¥–∞–µ—Ç `dict_digital_values_flat` (MergeTree) + Dictionary –æ–±—ä–µ–∫—Ç |
| **DataFrame** | ‚ùå –ù–µ —Å–æ–∑–¥–∞–µ—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –°–£–ë–î) |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | `heli_pandas`, `md_components`, `flight_program_ac`, `flight_program_fl` |
| **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ClickHouse (`DESCRIBE TABLE`) |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–¥–∏—Ç–∏–≤–Ω–æ–≥–æ –º–µ—Ç–∞-—Å–ª–æ–≤–∞—Ä—è –≤—Å–µ—Ö –ø–æ–ª–µ–π Extract —Å–∏—Å—Ç–µ–º—ã –¥–ª—è Flame GPU |

#### –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã `dict_digital_values_flat`:

| **–ü–æ–ª–µ** | **–¢–∏–ø ClickHouse** | **–¢–∏–ø cuDF** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|----------|-------------------|--------------|----------------|
| `field_id` | `UInt16` | `uint16` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—è (1-65535) |
| `primary_table` | `String` | `string` | –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª—è |
| `field_name` | `String` | `string` | –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è |
| `field_description` | `String` | `string` | –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—è |
| `data_type` | `String` | `string` | –†–µ–∞–ª—å–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö ClickHouse |
| `is_nullable` | `UInt8` | `uint8` | –ú–æ–∂–µ—Ç –ª–∏ –±—ã—Ç—å NULL (0/1) |
| `load_timestamp` | `DateTime` | `datetime` | –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ (–∞–¥–¥–∏—Ç–∏–≤–Ω–æ—Å—Ç—å) |

#### –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:

**–ê–Ω–∞–ª–∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:**
- **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:** –≤—Å–µ 12 Extract —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ `DESCRIBE TABLE`
- **DISTINCT –ø–æ–ª—è:** —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –∏–∑ ClickHouse
- **–ê–¥–¥–∏—Ç–∏–≤–Ω–æ—Å—Ç—å:** –Ω–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

**Dictionary –æ–±—ä–µ–∫—Ç:**
- **`digital_values_dict_flat`** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ `dictGet()` –¥–æ—Å—Ç—É–ø–∞
- **PRIMARY KEY:** `field_id`
- **LAYOUT:** FLAT() –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- **Flame GPU macroproperty:** –º–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π –ø–æ `field_id`
- **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã:** `dictGet('digital_values_dict_flat', 'field_description', field_id)`
- **Direct join:** –ø—Ä—è–º–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ `field_id`

---

## –°–í–û–î–ö–ê –í–ï–†–°–ò–û–ù–ù–û–°–¢–ò –¢–ê–ë–õ–ò–¶ –°–£–ë–î

### –í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å —Ç–∞–±–ª–∏—Ü ClickHouse –≤ Extract —Å–∏—Å—Ç–µ–º–µ

#### –û–°–ù–û–í–ù–´–ï –¢–ê–ë–õ–ò–¶–´ –î–ê–ù–ù–´–• (7 —Ç–∞–±–ª–∏—Ü)

| **–¢–∞–±–ª–∏—Ü–∞ –°–£–ë–î** | **–í–µ—Ä—Å–∏–æ–Ω–Ω—ã–µ –ø–æ–ª—è** | **–°—Ç–∞—Ç—É—Å** | **–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|------------------|---------------------|------------|----------------|----------------|
| `heli_pandas` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `Date`, `UInt8` | **–ö–û–†–ù–ï–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
| `heli_raw` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `Date`, `UInt8` | –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
| `md_components` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `Date`, `UInt8` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
| `status_overhaul` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `Date`, `UInt8` | –°—Ç–∞—Ç—É—Å—ã –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–æ–≤ |
| `program_ac` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `Date`, `UInt8` | –†–µ–µ—Å—Ç—Ä –í–° –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ |
| `flight_program_fl` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `Date`, `UInt8` | –¢–µ–Ω–∑–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º –ø–æ–ª–µ—Ç–æ–≤ |
| `flight_program_ac` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `Date`, `UInt8` | –¢–µ–Ω–∑–æ—Ä –æ–ø–µ—Ä–∞—Ü–∏–π –í–° |

#### –ê–î–î–ò–¢–ò–í–ù–´–ï –°–õ–û–í–ê–†–ò (6 —Ç–∞–±–ª–∏—Ü) - –û–ë–ù–û–í–õ–ï–ù–û 27-07-2025

| **–¢–∞–±–ª–∏—Ü–∞ –°–£–ë–î** | **–í–µ—Ä—Å–∏–æ–Ω–Ω—ã–µ –ø–æ–ª—è** | **–°—Ç–∞—Ç—É—Å** | **–ü–æ–ª–µ –≤—Ä–µ–º–µ–Ω–∏** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|------------------|---------------------|------------|------------------|----------------|
| `dict_partno_flat` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `load_timestamp` | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ |
| `dict_serialno_flat` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `load_timestamp` | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å —Å–µ—Ä–∏–π–Ω–∏–∫–æ–≤ |
| `dict_owner_flat` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `load_timestamp` | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ |
| `dict_ac_type_flat` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `load_timestamp` | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å —Ç–∏–ø–æ–≤ –í–° |
| `dict_aircraft_number_flat` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `load_timestamp` | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –Ω–æ–º–µ—Ä–æ–≤ –í–° |
| `dict_digital_values_flat` | ‚úÖ `version_date`, `version_id` | **–í–ï–†–°–ò–û–ù–ò–†–û–í–ê–ù–ê** | `load_timestamp` | –ê–¥–¥–∏—Ç–∏–≤–Ω—ã–π –º–µ—Ç–∞-—Å–ª–æ–≤–∞—Ä—å –ø–æ–ª–µ–π |

#### –ù–ï-–ê–î–î–ò–¢–ò–í–ù–´–ï –°–õ–û–í–ê–†–ò (1 —Ç–∞–±–ª–∏—Ü–∞)

| **–¢–∞–±–ª–∏—Ü–∞ –°–£–ë–î** | **–í–µ—Ä—Å–∏–æ–Ω–Ω—ã–µ –ø–æ–ª—è** | **–°—Ç–∞—Ç—É—Å** | **–ü–æ–ª–µ –≤—Ä–µ–º–µ–Ω–∏** | **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** |
|------------------|---------------------|------------|------------------|----------------|
| `dict_status_flat` | ‚ùå –ù–ï–¢ –ø–æ–ª–µ–π | **–ü–ï–†–ï–ó–ê–ü–ò–°–´–í–ê–ï–¢–°–Ø** | `load_timestamp` | –°–ª–æ–≤–∞—Ä—å —Å—Ç–∞—Ç—É—Å–æ–≤ (–ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑) |

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ Extract:

**‚úÖ –û–°–ù–û–í–ù–´–ï –¢–ê–ë–õ–ò–¶–´ –î–ê–ù–ù–´–• (7 –∏–∑ 14 —Ç–∞–±–ª–∏—Ü):**
- –í—Å–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª—è `version_date` (Date) –∏ `version_id` (UInt8)
- –ö–æ—Ä–Ω–µ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `heli_pandas` - –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ ETL
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ `toYYYYMM(version_date)` –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**‚úÖ –ê–î–î–ò–¢–ò–í–ù–´–ï –°–õ–û–í–ê–†–ò (6 –∏–∑ 14 —Ç–∞–±–ª–∏—Ü) - –í–ï–†–°–ò–û–ù–ù–û–°–¢–¨ –î–û–ë–ê–í–õ–ï–ù–ê 27-07-2025:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `version_date` –∏ `version_id` –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- –°–æ—Ö—Ä–∞–Ω–µ–Ω –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω + –≤–µ—Ä—Å–∏–æ–Ω–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ `heli_pandas`
- `load_timestamp` + –≤–µ—Ä—Å–∏–æ–Ω–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –ø–æ–ª–Ω–æ–π —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç–∏
- –ó–∞—â–∏—â–µ–Ω—ã –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –≤ –¢–ï–°–¢ —Ä–µ–∂–∏–º–µ Extract

**‚úÖ –ù–ï-–ê–î–î–ò–¢–ò–í–ù–´–ï –°–õ–û–í–ê–†–ò (1 –∏–∑ 14 —Ç–∞–±–ª–∏—Ü):**
- `dict_status_flat` - **–Ø–î–†–û –ê–†–•–ò–¢–ï–ö–¢–£–†–´ –ú–û–î–ï–õ–ò** 
- –ë–ï–ó –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ (–Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π Extract —Ü–∏–∫–ª

**üîß –û–ë–û–ì–ê–©–ï–ù–ò–ï –í–ù–£–¢–†–ò –¶–ò–ö–õ–ê:**
- UPDATE –æ–ø–µ—Ä–∞—Ü–∏–∏ (ac_type_mask, br, partno_comp, repair_days) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ Extract —Ü–∏–∫–ª–∞
- –ù–ï —Ç—Ä–µ–±—É—é—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ - –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è `version_date`/`version_id`
- –î–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∫ —Ç–∞–±–ª–∏—Ü–∞–º –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã

**üìã –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï –ï–î–ò–ù–û–ì–û –ü–ê–ô–ü–õ–ê–ô–ù–ê –í–ï–†–°–ò–û–ù–ù–û–°–¢–ò (27-07-2025):**
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ó–ê–í–ï–†–®–ï–ù–ê**: –í–°–ï –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω—ã (100% –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü)
- **–°–ª–æ–≤–∞—Ä–∏ –£–ù–ò–§–ò–¶–ò–†–û–í–ê–ù–´**: 6 –∞–¥–¥–∏—Ç–∏–≤–Ω—ã—Ö –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö + 1 –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–π
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¶–ï–ù–¢–†–ê–õ–ò–ó–û–í–ê–ù**: –µ–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ `Status_Components.xlsx`
- **–¶–µ–ø–æ—á–∫–∞ –ù–ê–î–ï–ñ–ù–ê–Ø**: Extract Master ‚Üí CLI –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí heli_pandas ‚Üí —Å–ª–æ–≤–∞—Ä–∏
- **–û–±—â–∏–π –æ–±—ä–µ–º**: 14 —Ç–∞–±–ª–∏—Ü –≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π Extract —Å–∏—Å—Ç–µ–º–µ

---


