# Extract - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üì• –û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ Extract

–≠—Ç–∞–ø Extract –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤, –ø–µ—Ä–≤–∏—á–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –≤ ClickHouse –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

## üìã –ü–µ—Ä–µ—á–µ–Ω—å —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract (–∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ ETL Master)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (ETL Pipeline)

1. **`md_components_loader.py`** - MD Components (–º–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
2. **`status_overhaul_loader.py`** - Status & Overhaul (—Å—Ç–∞—Ç—É—Å—ã –∏ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç)
3. **`program_loader.py`** - Flight Program (–ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤)
4. **`program_ac_loader.py`** - Program AC (—Å–≤—è–∑–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –∏ –í–°)
5. **`dual_loader.py`** - Status Components (–æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ + –ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥)

### –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (ETL Pipeline)

6. **`dictionary_creator.py`** - –í—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (—Å—Ç–∞—Ç—É—Å—ã, –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞, —Å–µ—Ä–∏–π–Ω–∏–∫–∏, –≤–ª–∞–¥–µ–ª—å—Ü—ã, —Ç–∏–ø—ã –í–°, –Ω–æ–º–µ—Ä–∞ –í–°)
7. **`enrich_heli_pandas.py`** - –û–±–æ–≥–∞—â–µ–Ω–∏–µ ac_type_mask
8. **`calculate_beyond_repair.py`** - –†–∞—Å—á–µ—Ç Beyond Repair (br)
9. **`md_components_enricher.py`** - –û–±–æ–≥–∞—â–µ–Ω–∏–µ MD Components

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (–≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞)

10. **`aircraft_number_processor.py`** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –í–° (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)
11. **`overhaul_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞ (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)
12. **`program_ac_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)  
13. **`inactive_planery_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤ (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ dual_loader)

### –£—Ç–∏–ª–∏—Ç—ã Extract

14. **`utils/create_all_dictionaries.py`** - —É—Ç–∏–ª–∏—Ç–∞-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π
15. **`utils/test_db_connection.py`** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –°–£–ë–î
16. **`code/archive/aircraft_number_dict_creator.py`** - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–æ–∑–¥–∞—Ç–µ–ª—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –í–° (–∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω)

## üîÑ –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract (–ø–æ ETL Master Pipeline)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–º

**–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä:** `etl_master.py`
- –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ (—Ç–µ—Å—Ç/–ø—Ä–æ–¥)
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

1. **md_components_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `md_components`
2. **status_overhaul_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `status_overhaul`
3. **program_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `flight_program`
4. **program_ac_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `program_ac`

### –≠—Ç–∞–ø 2: –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–æ–º (–∫—Ä–∏—Ç–∏—á–Ω–∞—è)

5. **dual_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `heli_pandas`
   - –ó–∞–≥—Ä—É–∑–∫–∞ Excel –¥–∞–Ω–Ω—ã—Ö
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–æ–≤:
     - overhaul_status_processor.py ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
     - program_ac_status_processor.py ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
     - inactive_planery_processor.py ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤
   - aircraft_number_processor.py ‚Üí –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –í–°
   - –†–∞—Å—á–µ—Ç repair_days ‚Üí `heli_pandas.repair_days`

### –≠—Ç–∞–ø 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–π)

6. **dictionary_creator.py** ‚Üí —Ç–∞–±–ª–∏—Ü—ã —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤:
   - `dict_status_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ (–Ω–µ-–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_partno_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_serialno_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å–µ—Ä–∏–π–Ω–∏–∫–æ–≤ (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_owner_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `dict_ac_type_flat` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∏–ø–æ–≤ –í–° (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)
   - `aircraft_number_dict` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –í–° (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–π)

### –≠—Ç–∞–ø 4: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

7. **enrich_heli_pandas.py** ‚Üí `heli_pandas.ac_type_mask`
8. **calculate_beyond_repair.py** ‚Üí `md_components.br`
9. **md_components_enricher.py** ‚Üí –æ–±–æ–≥–∞—â–µ–Ω–∏–µ `md_components`

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ Extract

### heli_pandas (–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- **partno** String - –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏  
- **serialno** String - —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **name** String - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **status_id** UInt8 - —Å—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (0-–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, 1-–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ, 2-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è, 4-—Ä–µ–º–æ–Ω—Ç)
- **oh** Float64 - –Ω–∞—Ä–∞–±–æ—Ç–∫–∞ –¥–æ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
- **ll** Float64 - —Å—Ä–æ–∫ —Å–ª—É–∂–±—ã
- **repair_days** Int16 - –æ—Å—Ç–∞—Ç–æ–∫ –¥–Ω–µ–π –¥–æ —Ä–µ–º–æ–Ω—Ç–∞
- **aircraft_number** String - –Ω–æ–º–µ—Ä –í–°
- **ac_type_mask** UInt64 - –±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–æ–≤ –í–°

### md_components (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- **partno** String - –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏
- **name** String - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- **br** Float64 - –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å Beyond Repair
- –î—Ä—É–≥–∏–µ –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –ø–æ–ª—è

### –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- **status_overhaul** - –¥–∞–Ω–Ω—ã–µ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
- **flight_program** - –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤  
- **program_ac** - —Ä–µ–µ—Å—Ç—Ä –í–°
- **dict_status_flat** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤
- **aircraft_number_dict** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –í–°

## üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ data_input

**–†–∞–∑–º–µ—â–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤:**
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –≤ `data_input/`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls
- –ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8 –∏–ª–∏ CP1251

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Excel:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: partno, serialno, name
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏: oh, ll, sne, ppr, oh_threshold
- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
- –î–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω: `Status_Components_YYYYMMDD.xlsx`

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤:**
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: –¥–æ 100MB
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–æ 1M –∑–∞–ø–∏—Å–µ–π –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–±–∏–µ–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name

**–ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name, oh, ll, sne, ppr, oh_threshold

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Extract

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- BATCH_SIZE=10000 (—Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –≤—Å—Ç–∞–≤–∫–∏)
- MAX_RETRIES=3 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫)
- TIMEOUT_SECONDS=300 (—Ç–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–π)

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Extract

### –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

**–ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø–∏—Å–µ–π
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã Extract

1. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π (partno, serialno)
2. **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∑–∞–º–µ–Ω–∞ –Ω–∞ NULL
3. **–ü—Ä–æ–±–ª–µ–º—ã –∫–æ–¥–∏—Ä–æ–≤–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CP1251/UTF-8
4. **–ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –ø–∞–∫–µ—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ 