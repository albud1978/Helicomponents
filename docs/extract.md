# Extract - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üì• –û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ Extract

–≠—Ç–∞–ø Extract –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤, –ø–µ—Ä–≤–∏—á–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –≤ ClickHouse –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

## üìã –ü–µ—Ä–µ—á–µ–Ω—å —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract

### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

1. **`md_components_loader.py`** - –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. **`status_overhaul_loader.py`** - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–∞ –∏ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞  
3. **`program_loader.py`** - –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º –ø–æ–ª–µ—Ç–æ–≤
4. **`program_ac_loader.py`** - –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–µ—Å—Ç—Ä–∞ –í–°
5. **`dual_loader.py`** - –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ + –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–æ–≤

### –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

6. **`dictionary_creator.py`** - —Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
7. **`aircraft_number_dict_creator.py`** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –í–°
8. **`aircraft_number_processor.py`** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –í–°
9. **`enrich_heli_pandas.py`** - –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –ø–æ–ª—è ac_type_mask
10. **`md_components_enricher.py`** - –æ–±–æ–≥–∞—â–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
11. **`calculate_beyond_repair.py`** - —Ä–∞—Å—á–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è Beyond Repair (br)

### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–æ–≤ (–≤ dual_loader.py)

12. **`overhaul_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
13. **`program_ac_status_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏  
14. **`inactive_planery_processor.py`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ä–æ–≤

### –£—Ç–∏–ª–∏—Ç—ã Extract

15. **`utils/status_dict_loader.py`** - –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ª–æ–≤–∞—Ä–µ–π —Å—Ç–∞—Ç—É—Å–æ–≤
16. **`test_db_connection.py`** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –°–£–ë–î

## üîÑ –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ Extract

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏

1. **md_components_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `md_components`
2. **status_overhaul_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `status_overhaul`
3. **program_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `flight_program`
4. **program_ac_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `program_ac`

### –≠—Ç–∞–ø 2: –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å—Ç–∞—Ç—É—Å–æ–≤

5. **dual_loader.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `heli_pandas`
   - –ó–∞–≥—Ä—É–∑–∫–∞ Excel –¥–∞–Ω–Ω—ã—Ö
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–æ–≤:
     - overhaul_status_processor.py ‚Üí `heli_pandas.status_id` = 4 (–†–µ–º–æ–Ω—Ç)
     - program_ac_status_processor.py ‚Üí `heli_pandas.status_id` = 2 (–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è)
     - inactive_planery_processor.py ‚Üí `heli_pandas.status_id` = 1 (–ù–µ–∞–∫—Ç–∏–≤–Ω–æ)
   - aircraft_number_processor.py ‚Üí `heli_pandas.aircraft_number`
   - –†–∞—Å—á–µ—Ç repair_days ‚Üí `heli_pandas.repair_days`

### –≠—Ç–∞–ø 3: –û–±–æ–≥–∞—â–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

6. **dictionary_creator.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `dict_status_flat`
7. **aircraft_number_dict_creator.py** ‚Üí —Ç–∞–±–ª–∏—Ü–∞ `aircraft_number_dict`

### –≠—Ç–∞–ø 4: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

8. **enrich_heli_pandas.py** ‚Üí `heli_pandas.ac_type_mask`
9. **calculate_beyond_repair.py** ‚Üí `md_components.br`
10. **md_components_enricher.py** ‚Üí –æ–±–æ–≥–∞—â–µ–Ω–∏–µ `md_components`

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ Extract

### heli_pandas (–æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- **partno** String - –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏  
- **serialno** String - —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **name** String - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- **status_id** UInt8 - —Å—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (0-–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, 1-–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ, 2-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è, 4-—Ä–µ–º–æ–Ω—Ç)
- **oh** Float64 - –Ω–∞—Ä–∞–±–æ—Ç–∫–∞ –¥–æ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
- **ll** Float64 - —Å—Ä–æ–∫ —Å–ª—É–∂–±—ã
- **repair_days** Int16 - –æ—Å—Ç–∞—Ç–æ–∫ –¥–Ω–µ–π –¥–æ —Ä–µ–º–æ–Ω—Ç–∞
- **aircraft_number** String - –Ω–æ–º–µ—Ä –í–°
- **ac_type_mask** UInt64 - –±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–æ–≤ –í–°

### md_components (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- **partno** String - –Ω–æ–º–µ—Ä –¥–µ—Ç–∞–ª–∏
- **name** String - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- **br** Float64 - –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å Beyond Repair
- –î—Ä—É–≥–∏–µ –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –ø–æ–ª—è

### –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- **status_overhaul** - –¥–∞–Ω–Ω—ã–µ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞
- **flight_program** - –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤  
- **program_ac** - —Ä–µ–µ—Å—Ç—Ä –í–°
- **dict_status_flat** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–∞—Ç—É—Å–æ–≤
- **aircraft_number_dict** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –í–°

## üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ data_input

**–†–∞–∑–º–µ—â–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤:**
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –≤ `data_input/`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls
- –ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8 –∏–ª–∏ CP1251

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Excel:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: partno, serialno, name
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏: oh, ll, sne, ppr, oh_threshold
- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
- –î–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω: `Status_Components_YYYYMMDD.xlsx`

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤:**
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: –¥–æ 100MB
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–æ 1M –∑–∞–ø–∏—Å–µ–π –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑–±–∏–µ–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name

**–ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**
- partno, serialno, name, oh, ll, sne, ppr, oh_threshold

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Extract

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
- CLICKHOUSE_HOST=localhost
- CLICKHOUSE_PORT=9000 (Native –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
- CLICKHOUSE_USER=default
- CLICKHOUSE_PASSWORD=
- CLICKHOUSE_DATABASE=helicopter_lifecycle

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- BATCH_SIZE=10000 (—Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –≤—Å—Ç–∞–≤–∫–∏)
- MAX_RETRIES=3 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫)
- TIMEOUT_SECONDS=300 (—Ç–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–π)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**
- INFO - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- WARNING - –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏  
- ERROR - –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏, —Å–±–æ–∏ –∑–∞–≥—Ä—É–∑–∫–∏

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–æ–≤:** `logs/dual_loader_YYYYMMDD.log`

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Extract

### –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

**–ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø–∏—Å–µ–π
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã Extract

1. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π (partno, serialno)
2. **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∑–∞–º–µ–Ω–∞ –Ω–∞ NULL
3. **–ü—Ä–æ–±–ª–µ–º—ã –∫–æ–¥–∏—Ä–æ–≤–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CP1251/UTF-8
4. **–ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –ø–∞–∫–µ—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ 