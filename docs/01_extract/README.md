# EXTRACT: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞
–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –≤ ClickHouse –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ ABM –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

## üìä –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã
- `data_input/VnV_Dataset_for_CBM.xlsx` - 108,623 –∑–∞–ø–∏—Å–∏ –≤–µ—Ä—Ç–æ–ª–µ—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `data_input/master_data/MD_Components.xlsx` - 37 –∑–∞–ø–∏—Å–µ–π –º–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `data_input/source_data/Program.xlsx` - 8 –∑–∞–ø–∏—Å–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ (96 –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö)
- `data_input/source_data/Status_Overhaul.xlsx` - 19 –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- **heli_raw**: –≤—Å–µ 108,623 –∑–∞–ø–∏—Å–∏ (16 –∫–æ–ª–æ–Ω–æ–∫)
- **heli_pandas**: 6,677 –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (–ø–æ 37 –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞–º –∏–∑ MD_Components)  
- **md_components**: 37 –∑–∞–ø–∏—Å–µ–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **flight_program**: 96 –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ –Ω–∞ 2025 –≥–æ–¥
- **status_overhaul**: 19 –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞ –í–°

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü ClickHouse

### heli_raw - –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
```sql
CREATE TABLE heli_raw (
    -- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    `partno` Nullable(String),              -- –ß–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä
    `serialno` Nullable(String),            -- –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä
    `ac_typ` Nullable(String),              -- –¢–∏–ø –í–° (32=–ú–ò-8, 64=–ú–ò-17, 128=–ú–ò-26)
    
    -- –í–ª–∞–¥–µ–ª–µ—Ü –∏ –ª–æ–∫–∞—Ü–∏—è
    `owner` Nullable(String),               -- –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫
    `location` Nullable(String),            -- –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
    
    -- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    `installation_date` Nullable(Date),     -- –î–∞—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    `removal_date` Nullable(Date),          -- –î–∞—Ç–∞ —Å–Ω—è—Ç–∏—è
    
    -- –†–µ—Å—É—Ä—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—á–∞—Å—ã)
    `oh` Nullable(Float64),                 -- –ù–∞—Ä–∞–±–æ—Ç–∫–∞ —Å –Ω–∞—á–∞–ª–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
    `oh_threshold` Nullable(Float64),       -- –ü–æ—Ä–æ–≥ –¢–û
    `ll` Nullable(Float64),                 -- –ù–∞–ª–µ—Ç —Å –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
    `sne` Nullable(Float64),                -- –ù–∞—Ä–∞–±–æ—Ç–∫–∞ —Å —Ä–µ–º–æ–Ω—Ç–∞
    `ppr` Nullable(Float64),                -- –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥ —Ä–µ–º–æ–Ω—Ç–∞
    
    -- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    `condition` Nullable(String),           -- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    `lease_restricted` UInt8 DEFAULT 0,     -- –õ–∏–∑–∏–Ω–≥–æ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (0/1)
    
    -- –ü—Ä–∏—á–∏–Ω–∞ —Å–Ω—è—Ç–∏—è
    `removal_reason` Nullable(String),      -- –ü—Ä–∏—á–∏–Ω–∞ —Å–Ω—è—Ç–∏—è —Å –í–°
    
    -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞
    `version_date` Date DEFAULT today()     -- –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö
    
) ENGINE = MergeTree()
ORDER BY version_date
PARTITION BY toYYYYMM(version_date)
SETTINGS index_granularity = 8192
```

### heli_pandas - –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
```sql
-- –ò–¥–µ–Ω—Ç–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å heli_raw, –Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏
-- –ø–æ 37 –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞–º –∏–∑ MD_Components (6,677 –∑–∞–ø–∏—Å–µ–π –∏–∑ 108,623)
CREATE TABLE heli_pandas AS heli_raw
```

### md_components - –º–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```sql
CREATE TABLE md_components (
    -- –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
    `partno` Nullable(String),              -- –ß–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä
    `comp_number` Nullable(Float64),        -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ –í–°
    `group_by` Nullable(String),            -- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞
    `ac_typ` Nullable(String),              -- –¢–∏–ø –í–°
    
    -- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    `type_restricted` Nullable(Float64),    -- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ —Ç–∏–ø—É
    `common_restricted1` Nullable(Float64), -- –û–±—â–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1
    `common_restricted2` Nullable(Float64), -- –û–±—â–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 2
    
    -- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    `trigger_interval` Nullable(Float64),   -- –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
    `partout_time` Nullable(Float64),       -- –í—Ä–µ–º—è —Å–Ω—è—Ç–∏—è
    `assembly_time` Nullable(Float64),      -- –í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    `repair_time` Nullable(Float64),        -- –í—Ä–µ–º—è —Ä–µ–º–æ–Ω—Ç–∞
    
    -- –†–µ—Å—É—Ä—Å—ã –ú–ò-8
    `ll_mi8` Nullable(Float64),             -- LL –ú–ò-8
    `oh_mi8` Nullable(Float64),             -- OH –ú–ò-8
    `oh_threshold_mi8` Nullable(Float64),   -- –ü–æ—Ä–æ–≥ OH –ú–ò-8
    
    -- –†–µ—Å—É—Ä—Å—ã –ú–ò-17
    `ll_mi17` Nullable(Float64),            -- LL –ú–ò-17
    `oh_mi17` Nullable(Float64),            -- OH –ú–ò-17
    
    -- –°—Ç–æ–∏–º–æ—Å—Ç–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    `repair_price` Nullable(Float64),       -- –¶–µ–Ω–∞ —Ä–µ–º–æ–Ω—Ç–∞ (0‚ÇΩ-21M‚ÇΩ)
    `purchase_price` Nullable(Float64),     -- –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (274k‚ÇΩ-137M‚ÇΩ)
    
    -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
    `sne` Nullable(Float64),                -- SNE
    `ppr` Nullable(Float64),                -- PPR
    
    -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞
    `version_date` Date DEFAULT today()     -- –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏
    
) ENGINE = MergeTree()
ORDER BY version_date
PARTITION BY toYYYYMM(version_date)
```

### flight_program - –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª–µ—Ç–æ–≤ (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è)
```sql
CREATE TABLE flight_program (
    -- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –í–°
    `partno` Nullable(UInt8),               -- –¢–∏–ø –í–° (32=–ú–ò-8, 64=–ú–ò-17)
    `serialno` Nullable(UInt32),            -- –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –í–°
    `ac_type` String,                       -- –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ç–∏–ø (–ú–ò-8, –ú–ò-17)
    
    -- –¢–∏–ø –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –ø–æ–ª—è
    `field_type` String,                    -- ops_counter_mi8/mi17, daily_flight
    
    -- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    `program_date` Date,                    -- –î–∞—Ç–∞ (YYYY-MM-01)
    `month_number` UInt8,                   -- –ù–æ–º–µ—Ä –º–µ—Å—è—Ü–∞ (1-12)
    `program_year` UInt16,                  -- –ì–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã (2025)
    
    -- –ü–ª–∞–Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    `value` UInt32,                         -- –ü–ª–∞–Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –º–µ—Å—è—Ü
    
    -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    `version_date` Date DEFAULT today()     -- –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö
    
) ENGINE = MergeTree()
ORDER BY (program_year, month_number, field_type)
PARTITION BY toYYYYMM(version_date)
SETTINGS index_granularity = 8192
```

### status_overhaul - —Å—Ç–∞—Ç—É—Å –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞
```sql
CREATE TABLE status_overhaul (
    -- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –í–°
    `ac_registr` UInt32,                    -- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –í–°
    `ac_typ` String,                        -- –¢–∏–ø –í–° (–ú–∏-8–¢, –ú–∏-17)
    
    -- –ù–æ–º–µ—Ä —Ä–∞–±–æ—Ç—ã –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    `wpno` String,                          -- –ù–æ–º–µ—Ä —Ä–∞–±–æ—á–µ–≥–æ –ø–∞–∫–µ—Ç–∞ (22774/H-24)
    `description` String,                   -- –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç
    
    -- –ü–ª–∞–Ω–æ–≤—ã–µ –¥–∞—Ç—ã
    `sched_start_date` Nullable(Date),      -- –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
    `sched_end_date` Nullable(Date),        -- –ü–ª–∞–Ω–æ–≤–∞—è –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
    
    -- –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞—Ç—ã
    `act_start_date` Nullable(Date),        -- –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞
    `act_end_date` Nullable(Date),          -- –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
    
    -- –°—Ç–∞—Ç—É—Å –∏ —É—á–∞—Å—Ç–Ω–∏–∫–∏
    `status` String,                        -- –°—Ç–∞—Ç—É—Å (–ó–∞–∫—Ä—ã—Ç–æ, –í –ø—Ä–æ—Ü–µ—Å—Å–µ, –û—Ç–∫—Ä—ã—Ç–æ)
    `owner` String,                         -- –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫
    `operator` String,                      -- –û–ø–µ—Ä–∞—Ç–æ—Ä
    
    -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    `version_date` Date DEFAULT today()     -- –î–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö
    
) ENGINE = MergeTree()
ORDER BY (ac_registr, wpno, status)
PARTITION BY toYYYYMM(version_date)
SETTINGS index_granularity = 8192
```

## üí° –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –∏–∑ Excel –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
**–¢—Ä—É–¥–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö:
```python
def extract_version_date_from_excel(file_path):
    workbook = openpyxl.load_workbook(file_path, read_only=True)
    props = workbook.properties
    
    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≥–æ–¥–∞)
    if props.created and abs(props.created.year - current_year) <= 1:
        return props.created.date()
    
    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –î–∞—Ç–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if props.modified:
        return props.modified.date()
        
    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –í—Ä–µ–º—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞ –≤ –û–°
    return datetime.fromtimestamp(os.path.getmtime(file_path)).date()
```

### 2. –î–≤–æ–π–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–∞—á–µ—Å—Ç–≤–∞
**–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**:
- `heli_raw`: 108,623 –∑–∞–ø–∏—Å–µ–π (–≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
- `heli_pandas`: 6,677 –∑–∞–ø–∏—Å–µ–π (6.1% –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å 100% –ø–æ–∫—Ä—ã—Ç–∏—è 37 –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ –∏–∑ MD_Components

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
**–¢—Ä—É–¥–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è Excel ‚Üí ClickHouse —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:
```python
# lease_restricted: —Ç–µ–∫—Å—Ç–æ–≤–æ–µ "Y" ‚Üí —á–∏—Å–ª–æ–≤–æ–µ 1
df['lease_restricted'] = df['lease_restricted'].apply(
    lambda x: 1 if str(x).upper() in ['Y', '1'] else 0
).astype('uint8')

# Python native —Ç–∏–ø—ã –¥–ª—è clickhouse_driver (–ù–ï numpy/pandas —Ç–∏–ø—ã!)
df[col] = pd.to_numeric(df[col], errors='coerce')
df[col] = df[col].where(df[col].notnull(), None)  # NULL –≤–º–µ—Å—Ç–æ NaN
```

### 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ MD_Components
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ**:
```
Row 0: [–ß–µ—Ä—Ç–µ–∂–Ω—ã–π –Ω–æ–º–µ—Ä | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö...]  ‚Üê –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨ (—Ä—É—Å—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏)
Row 1: [partno | comp_number | group_by | ac_typ | ...] ‚Üê HEADER (header=1)
Row 2: [–¢–í2-117–ê | 1 | 1 | 32 | ...]                  ‚Üê DATA
```

### 5. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–ª—è nullable –ø–æ–ª–µ–π (program_loader.py)
**–¢—Ä—É–¥–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è numpy ‚Üí ClickHouse —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:
```python
# –ü—Ä–æ–±–ª–µ–º–∞: Pandas –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Python int ‚Üí numpy.float64
# –†–µ—à–µ–Ω–∏–µ: –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –ø—Ä—è–º–æ –≤ –∫–æ—Ä—Ç–µ–∂–∞—Ö –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
for _, row in df.iterrows():
    row_tuple = []
    for col_name, value in row.items():
        if col_name in ['partno', 'serialno']:
            # Nullable UInt8/UInt32 - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ Python —Ç–∏–ø—ã
            if pd.isna(value) or str(value).lower() == 'nan':
                row_tuple.append(None)  # Python None
            else:
                row_tuple.append(int(float(value)))  # Python int
```

### 6. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —à–∏—Ä–æ–∫–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (program_loader.py) 
**–£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**:
```python
# 8 —Å—Ç—Ä–æ–∫ √ó 12 –º–µ—Å—è—á–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ ‚Üí 96 –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
# –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: [partno, serialno, field_type, 1, 2, ..., 12]
# –†–µ–∑—É–ª—å—Ç–∞—Ç: [partno, serialno, field_type, program_date, month_number, value]

for month in [1,2,3,4,5,6,7,8,9,10,11,12]:
    normalized_row = {
        'partno': row['partno'],
        'serialno': row['serialno'], 
        'field_type': row['–ü–æ–ª–µ'],
        'program_date': date(2025, month, 1),
        'month_number': month,
        'value': row[month]  # –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –º–µ—Å—è—á–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏
    }
```

### 7. –û–±—Ä–∞–±–æ—Ç–∫–∞ nullable –¥–∞—Ç (status_overhaul_loader.py)
**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏**:
```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç –¥–ª—è ClickHouse - nullable –ø–æ–ª—è
date_columns = ['sched_start_date', 'sched_end_date', 'act_start_date', 'act_end_date']
for col in date_columns:
    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ date –æ–±—ä–µ–∫—Ç—ã
    result_df[col] = pd.to_datetime(result_df[col], errors='coerce').dt.date
    # –ó–∞–º–µ–Ω—è–µ–º NaT –Ω–∞ None –¥–ª—è nullable –ø–æ–ª–µ–π (act_end_date –º–æ–∂–µ—Ç –±—ã—Ç—å NULL)
    result_df[col] = result_df[col].where(result_df[col].notnull(), None)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: act_end_date = None –¥–ª—è —Ä–∞–±–æ—Ç "–í –ø—Ä–æ—Ü–µ—Å—Å–µ" –∏ "–û—Ç–∫—Ä—ã—Ç–æ"
```

## üöÄ –ó–∞–≥—Ä—É–∑—á–∏–∫–∏

**8 –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ 2 –ø–æ–¥—ç—Ç–∞–ø–∞—Ö + 1 –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç 5-–¥–Ω–µ–≤–Ω–æ–π –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### ‚ö†Ô∏è –ü–û–î–≠–¢–ê–ü 1: –ë–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (5 —Å–∫—Ä–∏–ø—Ç–æ–≤)

```bash
# –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –ü–ï–†–ï–ú–ï–ù–ù–´–• –û–ö–†–£–ñ–ï–ù–ò–Ø
# (—Å –≤–µ—Ä—Å–∏–∏ v3.0 –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è source load_env.sh)

# –®–ê–ì 1: md_components_loader.py (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ü–ï–†–í–´–ô!)
python3 code/md_components_loader.py

# –®–ê–ì 2: program_ac_loader.py (—Ä–µ–µ—Å—Ç—Ä –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏)
python3 code/program_ac_loader.py

# –®–ê–ì 3: status_overhaul_loader.py (–î–û–õ–ñ–ï–ù –ë–´–¢–¨ –î–û dual_loader!)
python3 code/status_overhaul_loader.py

# –®–ê–ì 4: dual_loader.py (–¢–†–ï–ë–£–ï–¢ md_components + status_overhaul!)
python3 code/dual_loader.py

# –®–ê–ì 5: program_loader.py (–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª–µ—Ç–æ–≤ –Ω–∞ –≥–æ–¥)
python3 code/program_loader.py
```

### ‚ö†Ô∏è –ü–û–î–≠–¢–ê–ü 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ GPU –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é (3 —Å–∫—Ä–∏–ø—Ç–∞)

```bash
# –®–ê–ì 6: dictionary_creator.py (—Å–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–µ–π, —Ç—Ä–µ–±—É–µ—Ç heli_pandas)
python3 code/dictionary_creator.py

# –®–ê–ì 7: process_location_field.py (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤, —Ç—Ä–µ–±—É–µ—Ç heli_pandas)
python3 code/process_location_field.py

# –®–ê–ì 8: enrich_heli_pandas.py (—á–∏—Å–ª–æ–≤–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ, —Ç—Ä–µ–±—É–µ—Ç dictionary_creator)
python3 code/enrich_heli_pandas.py

# –®–ê–ì 9: calculate_beyond_repair.py (—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã, —Ç—Ä–µ–±—É–µ—Ç md_components)
python3 code/calculate_beyond_repair.py
```

### md_components_loader.py - –∑–∞–≥—Ä—É–∑—á–∏–∫ –º–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã—Ö (–®–∞–≥ 1)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –ü–ï–†–í–´–ú** - —Å–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É `md_components`

```bash
python3 code/md_components_loader.py
```

**–§–æ—Ä–º–∏—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞:** `md_components`

**–§—É–Ω–∫—Ü–∏–∏:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ 37 –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ (—Ä–µ—Å—É—Ä—Å—ã, —Å—Ç–æ–∏–º–æ—Å—Ç–∏, –ø–æ—Ä–æ–≥–∏) –∏–∑ MD_Components.xlsx –≤ —Ç–∞–±–ª–∏—Ü—É `md_components`. –°–æ–∑–¥–∞–µ—Ç –±–∞–∑—É –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
- –†–µ—Å—É—Ä—Å—ã –ú–ò-8/–ú–ò-17 (LL, OH –ø–æ—Ä–æ–≥–∏)
- –°—Ç–æ–∏–º–æ—Å—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ä–µ–º–æ–Ω—Ç: 0‚ÇΩ-21M‚ÇΩ, –ø–æ–∫—É–ø–∫–∞: 274k‚ÇΩ-137M‚ÇΩ)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–ª—è ABM
- **37 –∑–∞–ø–∏—Å–µ–π** —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

### program_ac_loader.py - –∑–∞–≥—Ä—É–∑—á–∏–∫ —Ä–µ–µ—Å—Ç—Ä–∞ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ (–®–∞–≥ 2)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –í–¢–û–†–´–ú** - –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥—Ä—É–≥–∏—Ö –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤

```bash
python3 code/program_ac_loader.py
```

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** `data_input/source_data/Program_AC.xlsx`
**–§–æ—Ä–º–∏—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞:** `program_ac`

**–§—É–Ω–∫—Ü–∏–∏:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–µ–µ—Å—Ç—Ä 178 –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –∏–∑ Program_AC.xlsx –≤ —Ç–∞–±–ª–∏—Ü—É `program_ac`. –°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, –±–∞–∑–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ —Ç–∏–ø–∞—Ö –í–°.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–†–µ–µ—Å—Ç—Ä –≤–æ–∑–¥—É—à–Ω—ã—Ö —Å—É–¥–æ–≤ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏** - 178 –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤
- **8 —Ç–∏–ø–æ–≤ –í–°:** 350B3, 355NP, –ú–ò8–ú–¢–í, –ú–ò26–¢, –ú–ò8, –ö–ê32–¢, –ú–ò8–ê–ú–¢, 355N
- **5 —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤:** –Æ–¢-–í–£, CHOPPER LL, –ì–¢–õ–ö, –†–ï–ì –õ–ò–ó–ò–ù–ì, –°–ë–ï–† –õ–ò–ó–ò–ù–ì
- **40 –±–∞–∑ –ø—Ä–∏–ø–∏—Å–∫–∏** –ø–æ 8 –¥–∏—Ä–µ–∫—Ü–∏—è–º –†–æ—Å—Å–∏–∏
- **–°–∏—Å—Ç–µ–º–∞ –±–∞–∑–∏—Ä–æ–≤–∞–Ω–∏—è:** homebase –∫–æ–¥ + –ø–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**
```
ac_registr | ac_typ  | owner      | homebase | homebase_name | directorate
-----------|---------|------------|----------|---------------|---------------------------
4043       | 350B3   | –Æ–¢-–í–£      | –¢–Æ–ú      | –¢–Æ–ú–ï–ù–¨        | –ó–ê–ü–ê–î–ù–û-–°–ò–ë–ò–†–°–ö–ê–Ø –î–ò–†–ï–ö–¶–ò–Ø
7241       | 355NP   | CHOPPER LL | –¢–Æ–ú      | –¢–Æ–ú–ï–ù–¨        | –ó–ê–ü–ê–î–ù–û-–°–ò–ë–ò–†–°–ö–ê–Ø –î–ò–†–ï–ö–¶–ò–Ø
22123      | –ú–ò8–ú–¢–í  | –ì–¢–õ–ö       | –ù–û–Ø      | –ù–û–Ø–ë–†–¨–°–ö      | –ó–ê–ü–ê–î–ù–û-–°–ò–ë–ò–†–°–ö–ê–Ø –î–ò–†–ï–ö–¶–ò–Ø
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏:**
- ‚úÖ **178 –∑–∞–ø–∏—Å–µ–π** –≤ program_ac
- ‚úÖ **178 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –í–°** (–±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤)
- ‚úÖ **8 —Ç–∏–ø–æ–≤ –í–°** –æ—Ç –ª–µ–≥–∫–∏—Ö AS-350 –¥–æ —Ç—è–∂–µ–ª—ã—Ö –ú–ò-26–¢
- ‚úÖ **40 –±–∞–∑ –ø—Ä–∏–ø–∏—Å–∫–∏** –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏
- ‚úÖ **–ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –±–∞–∑–∏—Ä–æ–≤–∞–Ω–∏—è

### status_overhaul_loader.py - –∑–∞–≥—Ä—É–∑—á–∏–∫ —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞ (–®–∞–≥ 3)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –¢–†–ï–¢–¨–ò–ú** - –ö–†–ò–¢–ò–ß–ù–û –î–û dual_loader!

```bash
python3 code/status_overhaul_loader.py
```

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** `data_input/source_data/Status_Overhaul.xlsx`
**–§–æ—Ä–º–∏—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞:** `status_overhaul`

**–§—É–Ω–∫—Ü–∏–∏:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞ 19 —Ä–∞–±–æ—Ç –∏–∑ Status_Overhaul.xlsx –≤ —Ç–∞–±–ª–∏—Ü—É `status_overhaul`. –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–ª–∞–Ω–µ—Ä–æ–≤ –≤ dual_loader.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞** –ø–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º –Ω–æ–º–µ—Ä–∞–º –í–°
- **–ü–ª–∞–Ω–æ–≤—ã–µ vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞—Ç—ã** –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç
- **–°—Ç–∞—Ç—É—Å—ã —Ä–∞–±–æ—Ç:** –ó–∞–∫—Ä—ã—Ç–æ, –í –ø—Ä–æ—Ü–µ—Å—Å–µ, –û—Ç–∫—Ä—ã—Ç–æ
- **–†–∞–±–æ—á–∏–µ –ø–∞–∫–µ—Ç—ã:** –Ω–æ–º–µ—Ä–∞ –≤–∏–¥–∞ 22774/H-24 (–í–°/—Ç–∏–ø-–≤–µ—Ä—Å–∏—è)
- **–ú–Ω–æ–≥–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏, –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**
```
ac_registr | ac_typ  | wpno         | status      | sched_dates | act_dates
-----------|---------|--------------|-------------|-------------|----------
22774      | –ú–∏-8–¢  | 22774/H-24   | –ó–∞–∫—Ä—ã—Ç–æ     | 2024-01-16  | 2024-05-30
24593      | –ú–∏-17   | 24593/H-24-3 | –í –ø—Ä–æ—Ü–µ—Å—Å–µ | 2024-12-02  | NULL
22482      | –ú–∏-17   | 22482/H-24-2 | –ó–∞–∫—Ä—ã—Ç–æ     | 2024-04-05  | 2024-12-30
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏:**
- ‚úÖ **19 –∑–∞–ø–∏—Å–µ–π** –≤ status_overhaul
- ‚úÖ **12 –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ä–∞–±–æ—Ç** (91.7% —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ–º)
- ‚úÖ **6 —Ä–∞–±–æ—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ** (–≤—Å–µ –ú–∏-17, –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –Ω–∞ 2025) 
- ‚úÖ **1 –æ—Ç–∫—Ä—ã—Ç–∞—è —Ä–∞–±–æ—Ç–∞** (–ú–∏-17, –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å)
- ‚úÖ **18 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –í–°** (–ú–∏-8–¢: 8 –í–° —Å 9 —Ä–∞–±–æ—Ç–∞–º–∏, –ú–∏-17: 10 –í–° —Å 10 —Ä–∞–±–æ—Ç–∞–º–∏)

### dual_loader.py - –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫ (–®–∞–≥ 4)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –ß–ï–¢–í–ï–†–¢–´–ú** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `md_components` –∏ `status_overhaul`

```bash
python3 code/dual_loader.py
```

**–§–æ—Ä–º–∏—Ä—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã:** `heli_raw` + `heli_pandas`

**–§—É–Ω–∫—Ü–∏–∏:** –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫ 108,623 –∑–∞–ø–∏—Å–µ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–∑ Status_Components.xlsx. –°–æ–∑–¥–∞–µ—Ç –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: `heli_raw` (–≤—Å–µ –¥–∞–Ω–Ω—ã–µ) –∏ `heli_pandas` (6,677 –∑–∞–ø–∏—Å–µ–π, —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ md_components). **–í–°–¢–†–û–ï–ù–ù–´–ô –ü–û–î–ü–†–û–¶–ï–°–°:** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –ø–ª–∞–Ω–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ `status_processor.py` –º–æ–¥—É–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ status_overhaul.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö Excel
- –î–≤–æ–π–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ + —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ MD_Components
- –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –î–∏–∞–ª–æ–≥–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö –≤–µ—Ä—Å–∏–π
- **–í–°–¢–†–û–ï–ù–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –°–¢–ê–¢–£–°–û–í** —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å `status_processor.py`

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:**
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –∏–∑ Excel –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π –≤ ClickHouse
3. **–ß—Ç–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã md_components** ‚Üê –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å!
4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ heli_raw (–≤—Å–µ 108,623 –∑–∞–ø–∏—Å–∏)
5. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ MD_Components ‚Üí heli_pandas (6,677 –∑–∞–ø–∏—Å–µ–π)
6. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–ª–∞–Ω–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ status_processor** ‚Üê –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç status_overhaul!
7. –í–∞–ª–∏–¥–∞—Ü–∏—è 100% –ø–æ–∫—Ä—ã—Ç–∏—è –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤

**üîó –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–í–ò–°–ò–ú–û–°–¢–ò:** 
- dual_loader.py —á–∏—Ç–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `md_components` (–®–ê–ì 1)
- dual_loader.py –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã —á–µ—Ä–µ–∑ `status_processor.py`, –∫–æ—Ç–æ—Ä—ã–π —Ç—Ä–µ–±—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É `status_overhaul` (–®–ê–ì 3)

### program_loader.py - –∑–∞–≥—Ä—É–∑—á–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ (–®–∞–≥ 5)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –ü–Ø–¢–´–ú** - –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤

```bash
python3 code/program_loader.py
```

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** `data_input/source_data/Program.xlsx`
**–§–æ—Ä–º–∏—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞:** `flight_program`

**–§—É–Ω–∫—Ü–∏–∏:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –ø–æ–ª–µ—Ç–æ–≤ –Ω–∞ 2025 –≥–æ–¥ –∏–∑ Program.xlsx –≤ —Ç–∞–±–ª–∏—Ü—É `flight_program`. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —à–∏—Ä–æ–∫–∏–π —Ñ–æ—Ä–º–∞—Ç (8 —Å—Ç—Ä–æ–∫ ‚Üí 96 –∑–∞–ø–∏—Å–µ–π) —Å –º–µ—Å—è—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Å—á–µ—Ç—á–∏–∫–æ–≤ –∏ –Ω–∞–ª–µ—Ç–∞.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** 8 —Å—Ç—Ä–æ–∫ ‚Üí 96 –∑–∞–ø–∏—Å–µ–π (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç 12x)
- **–¢–∏–ø—ã –ø–æ–ª–µ–π:** ops_counter_mi8, ops_counter_mi17, daily_flight  
- **–í—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** –ø–æ–ª–Ω—ã–π 2025 –≥–æ–¥ (12 –º–µ—Å—è—Ü–µ–≤)
- **–°–º–µ—à–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** partno (—Ç–∏–ø—ã –í–°) + serialno (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –í–°)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤:** Python int/None –¥–ª—è ClickHouse —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏:**
- ‚úÖ **96 –∑–∞–ø–∏—Å–µ–π** –≤ flight_program
- ‚úÖ **3 —Ç–∏–ø–∞ –ø–æ–ª–µ–π** (ops_counter_mi8/17, daily_flight)  
- ‚úÖ **12/12 –º–µ—Å—è—Ü–µ–≤** –ø–æ–∫—Ä—ã—Ç–∏–µ 2025 –≥–æ–¥–∞
- ‚úÖ **–°–º–µ—à–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** 2 —Ç–∏–ø–∞ –í–° + 4 —Å–µ—Ä–∏–π–Ω—ã—Ö –Ω–æ–º–µ—Ä–∞

### dictionary_creator.py - —Å–æ–∑–¥–∞—Ç–µ–ª—å —Å–ª–æ–≤–∞—Ä–µ–π GPU (–®–∞–≥ 6)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –®–ï–°–¢–´–ú** - —Ç—Ä–µ–±—É–µ—Ç heli_pandas –∏–∑ dual_loader

```bash
python3 code/dictionary_creator.py
```

**–§—É–Ω–∫—Ü–∏–∏:** –°–æ–∑–¥–∞–µ—Ç ClickHouse Dictionary —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ —á–∏—Å–ª–æ–≤—ã–µ ID. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç heli_pandas –∏ —Å–æ–∑–¥–∞–µ—Ç —Å–ª–æ–≤–∞—Ä–∏: partno‚ÜíID, serialno‚ÜíID, ac_typ‚Üí–±–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏, owner‚ÜíID. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç 100x —É—Å–∫–æ—Ä–µ–Ω–∏–µ GPU –æ–±—Ä–∞–±–æ—Ç–∫–∏.

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ ClickHouse Dictionary –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç ‚Üí —á–∏—Å–ª–æ–≤—ã–µ ID

**–§–æ—Ä–º–∏—Ä—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã:** 
- `dict_partno_flat` - –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞ ‚Üí UInt16 ID
- `dict_ac_type_flat` - —Ç–∏–ø—ã –í–° ‚Üí –±–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ UInt8  
- `dict_owner_flat` - –≤–ª–∞–¥–µ–ª—å—Ü—ã ‚Üí UInt8 ID
- `dict_serialno_flat` - —Å–µ—Ä–∏–π–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ ‚Üí UInt16 ID

**–ë–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ —Ç–∏–ø–æ–≤ –í–°:**
```
–ú–∏-26: 128 (0b10000000)
–ú–∏-17: 64  (0b01000000)  
–ú–∏-8–¢: 32  (0b00100000)
```

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```
–¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è (–º–µ–¥–ª–µ–Ω–Ω–æ) ‚Üí Dictionary ID (–±—ã—Å—Ç—Ä–æ) ‚Üí GPU –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Üí JOIN Dictionary ‚Üí –ß–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º—ã–µ –æ—Ç—á–µ—Ç—ã
```

### process_location_field.py - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–æ–º–µ—Ä–æ–≤ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ (–®–∞–≥ 7)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –°–ï–î–¨–ú–´–ú** - —Ç—Ä–µ–±—É–µ—Ç heli_pandas –∏–∑ dual_loader

```bash
python3 code/process_location_field.py
```

**–§—É–Ω–∫—Ü–∏–∏:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª–µ location –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ RA-XXXXX. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ –ø–æ–ª–µ `aircraft_number` (UInt16) —Å 5-–∑–Ω–∞—á–Ω—ã–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ –í–°. –û—á–∏—â–∞–µ—Ç location –æ—Ç –Ω–µ-–≤–µ—Ä—Ç–æ–ª–µ—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ –í–° –∏–∑ –ø–æ–ª—è location

**–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã:** –¥–æ–±–∞–≤–ª—è–µ—Ç `aircraft_number UInt16` –≤ `heli_pandas`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–∞—Ä—Å–∏–Ω–≥ RA-XXXXX ‚Üí XXXXX (5 —Ü–∏—Ñ—Ä)
2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–æ–º–µ—Ä–æ–≤  
3. –û—á–∏—Å—Ç–∫–∞ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö location –∑–Ω–∞—á–µ–Ω–∏–π
4. –û–±–æ–≥–∞—â–µ–Ω–∏–µ aircraft_number

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** RA-12345 ‚Üí aircraft_number = 12345

### enrich_heli_pandas.py - —á–∏—Å–ª–æ–≤–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ GPU (–®–∞–≥ 8)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –í–û–°–¨–ú–´–ú** - —Ç—Ä–µ–±—É–µ—Ç Dictionary –º–∞–ø–ø–∏–Ω–≥–∏ –∏–∑ dictionary_creator

```bash
python3 code/enrich_heli_pandas.py
```

**–§—É–Ω–∫—Ü–∏–∏:** –û–±–æ–≥–∞—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É heli_pandas —á–∏—Å–ª–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏ –¥–ª—è Flame GPU. –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—è: `partno_id`, `serialno_id`, `ac_type_mask`, `owner_id` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤–∞—Ä–µ–π. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è –≤ —á–∏—Å–ª–æ–≤—ã–µ –¥–ª—è GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ —á–∏—Å–ª–æ–≤—ã–µ ID –¥–ª—è 100x —É—Å–∫–æ—Ä–µ–Ω–∏—è GPU

**üîó –ó–ê–í–ò–°–ò–ú–û–°–¢–¨:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Dictionary –º–∞–ø–ø–∏–Ω–≥–∏ –∏–∑ `dictionary_creator.py`

**–î–æ–±–∞–≤–ª—è–µ–º—ã–µ –ø–æ–ª—è –≤ heli_pandas:**
- `partno_id UInt16` - —á–∏—Å–ª–æ–≤–æ–π ID –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–∞
- `serialno_id UInt16` - —á–∏—Å–ª–æ–≤–æ–π ID —Å–µ—Ä–∏–π–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞
- `ac_type_mask UInt8` - –±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ —Ç–∏–ø–∞ –í–°
- `owner_id UInt8` - —á–∏—Å–ª–æ–≤–æ–π ID –≤–ª–∞–¥–µ–ª—å—Ü–∞

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å GPU:**
```
–î–û:  partno='–¢–í3-117–í–ú' (–º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–æ–∫)
–ü–û–°–õ–ï: partno_id=15 (–±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∏—Å–µ–ª)
```

### calculate_beyond_repair.py - —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã (–®–∞–≥ 9)
**–ó–ê–ü–£–°–ö–ê–ï–¢–°–Ø –î–ï–í–Ø–¢–´–ú** - —Ç—Ä–µ–±—É–µ—Ç md_components –∏–∑ md_components_loader

```bash
python3 code/calculate_beyond_repair.py
```

**–§—É–Ω–∫—Ü–∏–∏:** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ—Ä–æ–≥–∏ —Å–ø–∏—Å–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ `br` (Beyond Repair) –≤ md_components –ø–æ —Ñ–æ—Ä–º—É–ª–µ, —É—á–∏—Ç—ã–≤–∞—é—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–º–æ–Ω—Ç–∞ vs –ø–æ–∫—É–ø–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è ABM.

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ä–æ–≥–æ–≤ —Å–ø–∏—Å–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã:** –¥–æ–±–∞–≤–ª—è–µ—Ç `br UInt16` –≤ `md_components`

**–§–æ—Ä–º—É–ª—ã Beyond Repair:**
```
BR = NR - (RepairPrice / ((PurchasePrice - RepairPrice) / NR + RepairPrice / MRR))

–ì–¥–µ:
- NR: –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å (ll_mi8/ll_mi17)  
- MRR: –ú–µ–∂—Ä–µ–º–æ–Ω—Ç–Ω—ã–π —Ä–µ—Å—É—Ä—Å (oh_threshold_mi8/oh_threshold_mi17)
- RepairPrice: –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–º–æ–Ω—Ç–∞
- PurchasePrice: –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏
```

**–õ–æ–≥–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –í–°:**
- **–ï—Å–ª–∏ MRR = 0**: BR = NR (–Ω–µ—Ä–µ–º–æ–Ω—Ç–æ–ø—Ä–∏–≥–æ–¥–Ω—ã–π –∞–≥—Ä–µ–≥–∞—Ç)
- **–ï—Å–ª–∏ RepairPrice ‚â• PurchasePrice**: BR = 0 (—Å—Ä–∞–∑—É —Å–ø–∏—Å–∞–Ω–∏–µ)
- **–ï—Å–ª–∏ NR = 0**: BR = NULL (–∞–≥—Ä–µ–≥–∞—Ç –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –í–°)

## üìù –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏ (–ù–ï –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã)

### status_processor.py - –º–æ–¥—É–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤
**–í–°–¢–†–û–ï–ù –í dual_loader.py** –∫–∞–∫ –ø–æ–¥–ø—Ä–æ—Ü–µ—Å—Å

**–§—É–Ω–∫—Ü–∏–∏:** –ú–æ–¥—É–ª—å-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö status_overhaul –∏ –∞—Ä—Ö–∏–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –ø–ª–∞–Ω–µ—Ä–æ–≤ –í–°: –µ—Å–ª–∏ –í–° –≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–µ (status != '–ó–∞–∫—Ä—ã—Ç–æ') ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å 4 (–†–µ–º–æ–Ω—Ç). –ü–µ—Ä–µ–Ω–æ—Å–∏—Ç –¥–∞—Ç—ã –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞ –≤ –ø–æ–ª—è removal_date –∏ target_date.

**–ö–ª—é—á–µ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
- **–£–°–õ–û–í–ò–ï –°–í–Ø–ó–ò:** ac_registr (status_overhaul) = serialno (heli_pandas)
- **–°–¢–ê–¢–£–° –†–ï–ú–û–ù–¢–ê:** –ï—Å–ª–∏ –í–° –≤ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–µ ‚Üí status = 4 (–†–µ–º–æ–Ω—Ç)
- **–ü–ï–†–ï–ù–û–° –î–ê–¢:** act_start_date ‚Üí removal_date, sched_end_date ‚Üí target_date

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã GPU –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏

### Dictionary —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **37 –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤** ‚Üí –ø–ª–æ—Ç–Ω—ã–µ ID 1-37
- **3 —Ç–∏–ø–∞ –í–°** ‚Üí –±–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ 32/64/128  
- **~6,000 —Å–µ—Ä–∏–π–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤** ‚Üí –ø–ª–æ—Ç–Ω—ã–µ ID
- **–í–ª–∞–¥–µ–ª—å—Ü—ã** ‚Üí –ø–ª–æ—Ç–Ω—ã–µ ID

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **100x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** GPU –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–µ—Ä–µ–∑ —á–∏—Å–ª–æ–≤—ã–µ ID
- **61% —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏** —á–µ—Ä–µ–∑ –±–∏—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏
- **O(1) lookup** —á–µ—Ä–µ–∑ ClickHouse Dictionary
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Flame GPU
‚úÖ **–ß–∏—Å–ª–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π  
‚úÖ **–ë–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –í–°  
‚úÖ **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ—Ä–æ–≥–∏** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–π  
‚úÖ **–ù–æ–º–µ—Ä–∞ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤** –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è  
‚úÖ **Dictionary –º–∞–ø–ø–∏–Ω–≥–∏** –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## ‚û°Ô∏è –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: TRANSFORM
–î–∞–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ Flame GPU —Å Agent-Based –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

---

## üîß –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï HELI_PANDAS (–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π)

### ‚ö†Ô∏è –ö–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è heli_pandas:**
- –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞ (0 –∑–∞–ø–∏—Å–µ–π –≤–º–µ—Å—Ç–æ ~6,677)
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π (`installation_date` ‚Üí `mfg_date`)
- –õ–∏—à–Ω–∏–µ/–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è (`target_date`, `status`)
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π

### üéØ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–í–ê–ñ–ù–û:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ **3 —Å–∫—Ä–∏–ø—Ç–∞** (–∏–∑ 9 –æ–±—â–∏—Ö)

#### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ md_components –Ω–∞ –º–µ—Å—Ç–µ (37 –∑–∞–ø–∏—Å–µ–π)
python3 -c "
from code.utils.config_loader import get_clickhouse_client
client = get_clickhouse_client()
count = client.execute('SELECT COUNT(*) FROM md_components')[0][0]
print(f'md_components: {count} –∑–∞–ø–∏—Å–µ–π')
"
```

**–ï—Å–ª–∏ md_components –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
```bash
python3 code/md_components_loader.py
```

#### –®–∞–≥ 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
```bash
# –û–°–ù–û–í–ù–û–ô –°–ö–†–ò–ü–¢ - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç heli_raw + heli_pandas –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
python3 code/dual_loader.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç —à–∞–≥–∞ 2:**
- ‚úÖ `heli_raw`: 108,623 –∑–∞–ø–∏—Å–µ–π (–≤—Å–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ `heli_pandas`: 6,677 –∑–∞–ø–∏—Å–µ–π (—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ MD_Components)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

#### –®–∞–≥ 3: GPU –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–º–µ—Ä–∞ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ (aircraft_number)
python3 code/process_location_field.py

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–∏—Å–ª–æ–≤—ã–µ ID –¥–ª—è GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏  
python3 code/enrich_heli_pandas.py
```

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

#### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π:
```bash
python3 -c "
from code.utils.config_loader import get_clickhouse_client
client = get_clickhouse_client()

# –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
heli_raw = client.execute('SELECT COUNT(*) FROM heli_raw')[0][0]
heli_pandas = client.execute('SELECT COUNT(*) FROM heli_pandas')[0][0]
print(f'heli_raw: {heli_raw:,} –∑–∞–ø–∏—Å–µ–π')
print(f'heli_pandas: {heli_pandas:,} –∑–∞–ø–∏—Å–µ–π')

# –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
ratio = (heli_pandas / heli_raw * 100) if heli_raw > 0 else 0
print(f'–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: {ratio:.1f}% (–æ–∂–∏–¥–∞–µ—Ç—Å—è ~6.1%)')
"
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã:
```bash
python3 -c "
from code.utils.config_loader import get_clickhouse_client
client = get_clickhouse_client()

print('=== –°–¢–†–£–ö–¢–£–†–ê heli_pandas ===')
result = client.execute('DESCRIBE heli_pandas')
for row in result:
    print(f'{row[0]:<20} {row[1]:<15}')
"
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
- `partno`, `serialno`, `ac_typ` (–±–∞–∑–æ–≤—ã–µ)
- `installation_date`, `removal_date` (–ù–ï mfg_date!)
- `aircraft_number` (–ø–æ—Å–ª–µ process_location_field.py)
- `partno_id`, `serialno_id`, `ac_type_mask`, `owner_id` (–ø–æ—Å–ª–µ enrich_heli_pandas.py)

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ GPU –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
```bash
python3 -c "
from code.utils.config_loader import get_clickhouse_client
client = get_clickhouse_client()

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ GPU –ø–æ–ª–µ–π
result = client.execute('''
SELECT 
    COUNT(*) as total,
    COUNT(partno_id) as partno_ids,
    COUNT(aircraft_number) as aircraft_nums,
    COUNT(DISTINCT partno) as unique_partnos
FROM heli_pandas
''')[0]

total, partno_ids, aircraft_nums, unique_partnos = result
print(f'–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: {total:,} –∑–∞–ø–∏—Å–µ–π')
print(f'GPU –ø–æ–ª—è partno_id: {partno_ids:,} ({partno_ids/total*100:.1f}%)')
print(f'–ù–æ–º–µ—Ä–∞ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤: {aircraft_nums:,} ({aircraft_nums/total*100:.1f}%)')
print(f'–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤: {unique_partnos} (–æ–∂–∏–¥–∞–µ—Ç—Å—è 37)')
"
```

### ‚ö° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- `dual_loader.py` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö (–ó–ê–ú–ï–ù–ò–¢–¨/–û–¢–ú–ï–ù–ò–¢–¨)
- –ù–∏–∫–∞–∫–∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–µ—Ä–µ–∑–∞–ø–∏—Å–µ–π –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤:**
- `dual_loader.py` –¢–†–ï–ë–£–ï–¢ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è `md_components` (37 –∑–∞–ø–∏—Å–µ–π)
- `enrich_heli_pandas.py` –¢–†–ï–ë–£–ï–¢ Dictionary —Ç–∞–±–ª–∏—Ü (—Å–æ–∑–¥–∞–Ω–Ω—ã—Ö dictionary_creator.py)
- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã ETL –ù–ï –≤–ª–∏—è—é—Ç –Ω–∞ heli_pandas

**3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:**
- dual_loader.py: ~3-5 –º–∏–Ω—É—Ç (108k‚Üí6.7k –∑–∞–ø–∏—Å–µ–π)
- process_location_field.py: ~30 —Å–µ–∫—É–Ω–¥ (4k –Ω–æ–º–µ—Ä–æ–≤ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤)
- enrich_heli_pandas.py: ~1 –º–∏–Ω—É—Ç–∞ (6.7k —á–∏—Å–ª–æ–≤—ã—Ö ID)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è: ~5-7 –º–∏–Ω—É—Ç –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è**

**4. –ü—Ä–∏–∑–Ω–∞–∫–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:**
- ‚úÖ heli_pandas: —Ä–æ–≤–Ω–æ 6,677 –∑–∞–ø–∏—Å–µ–π
- ‚úÖ aircraft_number: ~4,011 –∑–∞–ø–∏—Å–µ–π (60.1% –æ—Ç –æ–±—â–∏—Ö)
- ‚úÖ partno_id, serialno_id: 6,677 –∑–∞–ø–∏—Å–µ–π (100%)
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤: 37 (–∫–∞–∫ –≤ md_components)

### üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

**–û—à–∏–±–∫–∞:** "ModuleNotFoundError: clickhouse_connect"
```bash
python3 -m pip install clickhouse-connect
```

**–û—à–∏–±–∫–∞:** "—Ç–∞–±–ª–∏—Ü–∞ md_components –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
```bash
python3 code/md_components_loader.py
```

**–û—à–∏–±–∫–∞:** "—Å–ª–æ–≤–∞—Ä–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã" –ø—Ä–∏ enrich_heli_pandas.py
```bash  
python3 code/dictionary_creator.py
```

**–û—à–∏–±–∫–∞:** pandas ‚Üí ClickHouse —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
- **–†–µ—à–µ–Ω–∏–µ:** dual_loader.py –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–∏–ø—ã
- **–ü—Ä–∏–Ω—Ü–∏–ø:** –¢–û–õ–¨–ö–û —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Python —Ç–∏–ø—ã (int, str, date, None)
- **–ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨:** numpy.uint32, pandas.Timestamp

### üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

- –°–∫—Ä–∏–ø—Ç—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è **idempotent** - –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
- –°–∏—Å—Ç–µ–º–∞ `.env` + `load_env.sh` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- Dictionary —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- GPU –ø–æ–ª—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º (–ù–ï –∑–∞–º–µ–Ω—è—é—Ç)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è 

## üîß –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–°–∏—Å—Ç–µ–º–∞ environment variables:**
- –ü–∞—Ä–æ–ª–∏ —Ç–æ–ª—å–∫–æ –≤ `.env` —Ñ–∞–π–ª–µ (–≤ .gitignore)
- –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ `source load_env.sh`
- –ù—É–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π –≤ –∫–æ–¥–µ

**–§–∞–π–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- `.env` - —Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)
- `load_env.sh` - —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏
- `code/utils/config_loader.py` - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```
.env —Ñ–∞–π–ª (–ª–æ–∫–∞–ª—å–Ω–æ, –≤ .gitignore) ‚Üí Environment Variables ‚Üí ClickHouse –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–∞–ø–∞

‚úÖ **108,623 –∑–∞–ø–∏—Å–µ–π** –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ heli_raw  
‚úÖ **6,677 –∑–∞–ø–∏—Å–µ–π** –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –≤ heli_pandas (6.1% –æ—Ç –æ–±—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö)  
‚úÖ **37 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –≤ md_components + –ø–æ–ª–µ `br`  
‚úÖ **178 –∑–∞–ø–∏—Å–µ–π** —Ä–µ–µ—Å—Ç—Ä–∞ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ –≤ program_ac  
‚úÖ **96 –∑–∞–ø–∏—Å–µ–π** –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ –≤ flight_program (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ)  
‚úÖ **19 –∑–∞–ø–∏—Å–µ–π** —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–ø—Ä–µ–º–æ–Ω—Ç–∞ –≤ status_overhaul  
‚úÖ **100% –ø–æ–∫—Ä—ã—Ç–∏–µ** –ø–∞—Ä—Ç–Ω–æ–º–µ—Ä–æ–≤ –∏–∑ MD_Components  
‚úÖ **GPU –ø–æ–ª—è** –≤ heli_pandas (partno_id, serialno_id, ac_type_mask, owner_id, aircraft_number)  
‚úÖ **Dictionary —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** –¥–ª—è 100x —É—Å–∫–æ—Ä–µ–Ω–∏—è GPU –æ–±—Ä–∞–±–æ—Ç–∫–∏  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** –ø–∞—Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ environment variables (–∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ v3.0)

### –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
- **167k –∑–∞–ø–∏—Å–µ–π/—Å–µ–∫** —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Å—Ç–∞–≤–∫–∏ –≤ ClickHouse
- **100% –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å** –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª–µ–π (partno, comp_number)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å** —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤** –¥–ª—è clickhouse_driver —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **12x –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏** –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–µ—Ç–æ–≤ (8‚Üí96 –∑–∞–ø–∏—Å–µ–π)
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤** –≤ —Ä–µ–µ—Å—Ç—Ä–µ –í–° (178/178)
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤** –ø–ª–∞–Ω–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ status_processor –º–æ–¥—É–ª—å

### –ò—Ç–æ–≥–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã ClickHouse
1. **md_components** (37 –∑–∞–ø–∏—Å–µ–π) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ + –ø–æ–ª–µ `br`
2. **program_ac** (178 –∑–∞–ø–∏—Å–µ–π) - —Ä–µ–µ—Å—Ç—Ä –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏  
3. **heli_raw** (108,623 –∑–∞–ø–∏—Å–µ–π) - –ø–æ–ª–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
4. **heli_pandas** (6,677 –∑–∞–ø–∏—Å–µ–π) - GPU-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ + —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è
5. **flight_program** (96 –∑–∞–ø–∏—Å–µ–π) - –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª–µ—Ç–æ–≤ –Ω–∞ 2025 –≥–æ–¥
6. **status_overhaul** (19 –∑–∞–ø–∏—Å–µ–π) - —Å—Ç–∞—Ç—É—Å—ã –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞
7. **Dictionary —Ç–∞–±–ª–∏—Ü—ã** (4 —Ç–∞–±–ª–∏—Ü—ã) - –º–∞–ø–ø–∏–Ω–≥–∏ —Ç–µ–∫—Å—Ç‚Üí—á–∏—Å–ª–æ–≤—ã–µ ID –¥–ª—è GPU

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ETL —Ü–µ–ø–æ—á–∫–∏
```
–ü–û–î–≠–¢–ê–ü 1 (5 —Å–∫—Ä–∏–ø—Ç–æ–≤):
md_components ‚Üí program_ac ‚Üí status_overhaul ‚Üí dual_loader(+status_processor) ‚Üí program_loader

–ü–û–î–≠–¢–ê–ü 2 (3 —Å–∫—Ä–∏–ø—Ç–∞): 
dictionary_creator ‚Üí process_location_field ‚Üí enrich_heli_pandas ‚Üí calculate_beyond_repair
``` 