# ETL Pipeline Master Scripts

## –ú–∞—Å—Ç–µ—Ä-—Å–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞

### üöÄ `etl_pipeline_runner.py`
**–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ ETL –ø–∞–π–ø–ª–∞–π–Ω–∞ —Å –∑–∞—á–∏—Å—Ç–∫–æ–π –∏ –æ—Ç—á–µ—Ç–æ–º**

```bash
python3 code/etl_pipeline_runner.py
```

**–ß—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:**
1. üóëÔ∏è –ó–∞—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö 10 ETL —Ç–∞–±–ª–∏—Ü –≤ ClickHouse
2. üìä –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö 9 ETL —Å–∫—Ä–∏–ø—Ç–æ–≤
3. ‚è±Ô∏è –ó–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
4. üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
5. üìà –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç —Å –∑–∞–∫–ª—é—á–µ–Ω–∏–µ–º

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
1. `md_components_loader.py` - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. `program_ac_loader.py` - –†–µ–µ—Å—Ç—Ä –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏  
3. `status_overhaul_loader.py` - –°—Ç–∞—Ç—É—Å –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞
4. `dual_loader.py` - –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
5. `program_loader.py` - –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª–µ—Ç–æ–≤
6. `dictionary_creator.py` - –°–ª–æ–≤–∞—Ä–∏ –¥–ª—è GPU –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
7. `process_location_field.py` - –ù–æ–º–µ—Ä–∞ –≤–µ—Ä—Ç–æ–ª–µ—Ç–æ–≤ –∏–∑ location
8. `enrich_heli_pandas.py` - –û–±–æ–≥–∞—â–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏ –¥–ª—è GPU
9. `calculate_beyond_repair.py` - –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ä–æ–≥–æ–≤

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö**
- –ü—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç
- –ö–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞: 0 = —É—Å–ø–µ—Ö, 1 = –æ—à–∏–±–∫–∞

---

## –£—Ç–∏–ª–∏—Ç–∞ –±—ã—Å—Ç—Ä–æ–π –∑–∞—á–∏—Å—Ç–∫–∏

### üóëÔ∏è `database_cleanup.py`
**–¢–æ–ª—å–∫–æ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö ETL —Ç–∞–±–ª–∏—Ü**

```bash
python3 code/utils/database_cleanup.py
```

**–ß—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:**
- –£–¥–∞–ª—è–µ—Ç –≤—Å–µ 10 ETL —Ç–∞–±–ª–∏—Ü
- –ë—ã—Å—Ç—Ä–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (~1 —Å–µ–∫—É–Ω–¥–∞)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Ä—É—á–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É —Å–∫—Ä–∏–ø—Ç–æ–≤

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –æ—Ç—á–µ—Ç–æ–º
```bash
# –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
python3 code/etl_pipeline_runner.py

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# üöÄ === –ú–ê–°–¢–ï–†-–°–ö–†–ò–ü–¢ ETL –ü–ê–ô–ü–õ–ê–ô–ù–ê ===
# üóëÔ∏è === –ó–ê–ß–ò–°–¢–ö–ê –ë–ê–ó–´ –î–ê–ù–ù–´–• ===
# üöÄ === –ó–ê–ü–£–°–ö ETL –°–ö–†–ò–ü–¢–û–í ===
# üîç === –ü–†–û–í–ï–†–ö–ê –ö–ê–ß–ï–°–¢–í–ê –î–ê–ù–ù–´–• ===
# üéØ === –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢ ETL –ü–ê–ô–ü–õ–ê–ô–ù–ê ===
```

### –¢–æ–ª—å–∫–æ –∑–∞—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü
```bash
# –ë—ã—Å—Ç—Ä–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
python3 code/utils/database_cleanup.py

# –ó–∞—Ç–µ–º —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –Ω—É–∂–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
python3 code/md_components_loader.py
python3 code/program_ac_loader.py
# –∏ —Ç.–¥.
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ú–∞—Å—Ç–µ—Ä-—Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
- üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å GPU –ø–æ–ª–µ–π
- ‚úÖ –°—Ç–∞—Ç—É—Å —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

**–¢–∏–ø–∏—á–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**
- –û–±—â–µ–µ –≤—Ä–µ–º—è: ~15-20 —Å–µ–∫—É–Ω–¥
- –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫: ~10 —Å–µ–∫—É–Ω–¥
- GPU –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞: ~3 —Å–µ–∫—É–Ω–¥—ã
- –û–±—â–∏–π –æ–±—ä–µ–º: ~115,000 –∑–∞–ø–∏—Å–µ–π 