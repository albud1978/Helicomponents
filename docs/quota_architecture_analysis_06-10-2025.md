# –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (06-10-2025)

**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç (–±–µ–∑ –∫–æ–¥–∞)  
**–¶–µ–ª—å:** –ò–∑—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–µ–∫—Ç–Ω—ã—Ö –Ω–∞—Ä–∞–±–æ—Ç–æ–∫ –ø–æ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—é  
**–ü—Ä–∞–≤–∏–ª–æ:** –†–∞–±–æ—Ç–∞ —Ç–æ–ª—å–∫–æ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](#—Ç–µ–∫—É—â–∞—è-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
2. [–ü—Ä–æ–µ–∫—Ç–Ω—ã–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏](#–ø—Ä–æ–µ–∫—Ç–Ω—ã–µ-–Ω–∞—Ä–∞–±–æ—Ç–∫–∏)
3. [–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑](#—Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π-–∞–Ω–∞–ª–∏–∑)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-—Ä–µ—à–µ–Ω–∏—è)
5. [–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#–≤—ã–≤–æ–¥—ã-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## 1. –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1.1. –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–æ–¥–∞

**–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å:**
- `code/sim_v2/rtc_quota_ops_excess.py` ‚Äî –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ operations (–¥–µ–º–æ—É—Ç 2‚Üí3)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- `code/sim_v2/base_model.py` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `add_rtc_module()`
- `code/sim_v2/orchestrator_v2.py` ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π
- `code/sim_v2/rtc_modules/` ‚Äî –∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è RTC –º–æ–¥—É–ª–µ–π (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ spawn_v2)

**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç:**
- –ú–æ–¥—É–ª–∏ –ø—Ä–æ–º–æ—É—Ç–∞ (serviceable/reserve/inactive ‚Üí operations)
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–≤–æ—Ç
- –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π (repair, reserve, storage)

---

### 1.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### –¢—Ä—ë—Ö—Ñ–∞–∑–Ω–∞—è —Å—Ö–µ–º–∞ (–¥–µ–º–æ—É—Ç 2‚Üí3)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–õ–û–ô S1: rtc_quota_clear_masks                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –¶–µ–ª—å: –û—á–∏—Å—Ç–∫–∞ –º–∞—Å–æ–∫ –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º —Ü–∏–∫–ª–æ–º                  ‚îÇ
‚îÇ –î–µ–π—Å—Ç–≤–∏–µ:                                                ‚îÇ
‚îÇ   - mi8_approve[idx] = 0                                 ‚îÇ
‚îÇ   - mi17_approve[idx] = 0                                ‚îÇ
‚îÇ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –í–°–ï–• –∞–≥–µ–Ω—Ç–æ–≤               ‚îÇ
‚îÇ              (–±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ state)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–õ–û–ô S2: rtc_quota_mark_candidates                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –¶–µ–ª—å: –ü–æ–º–µ—Ç–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –¥–µ–º–æ—É—Ç                      ‚îÇ
‚îÇ –§–∏–ª—å—Ç—Ä: state=operations, intent != 4 –∏ != 6             ‚îÇ
‚îÇ –î–µ–π—Å—Ç–≤–∏–µ:                                                ‚îÇ
‚îÇ   - –ê–≥–µ–Ω—Ç—ã –≤ operations –ø–æ–º–µ—á–∞—é—Ç —Å–µ–±—è:                   ‚îÇ
‚îÇ     mask[idx].exchange(1u)                               ‚îÇ
‚îÇ –†–µ–∑—É–ª—å—Ç–∞—Ç: mask[i] = 1 –¥–ª—è –≤—Å–µ—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–õ–û–ô S3: rtc_quota_manager                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –¶–µ–ª—å: –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ –¥–µ–º–æ—É—Ç         ‚îÇ
‚îÇ –ê–ª–≥–æ—Ä–∏—Ç–º (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ group_by):                         ‚îÇ
‚îÇ   1. –ü–æ–¥—Å—á—ë—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤:                                 ‚îÇ
‚îÇ      Curr = Œ£ mask[i] –≥–¥–µ i ‚àà [0, frames)                ‚îÇ
‚îÇ   2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞:                                   ‚îÇ
‚îÇ      Target = mp4_ops_counter[day+1]                     ‚îÇ
‚îÇ   3. –ï—Å–ª–∏ Curr > Target:                                 ‚îÇ
‚îÇ      K = Curr - Target                                   ‚îÇ
‚îÇ      –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ (mask[idx]=1):                ‚îÇ
‚îÇ        - –í—ã—á–∏—Å–ª–∏—Ç—å rank –ø–æ mfg_date (oldest_first)       ‚îÇ
‚îÇ        - –ï—Å–ª–∏ rank < K ‚Üí intent_state = 3                ‚îÇ
‚îÇ   4. –ò–Ω–∞—á–µ (Curr ‚â§ Target):                              ‚îÇ
‚îÇ      - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å intent_state = 2 (–æ—Å—Ç–∞—Ç—å—Å—è)           ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è:                                           ‚îÇ
‚îÇ   - –ü–æ–ª–µ: mp3_mfg_date_days                              ‚îÇ
‚îÇ   - –ü–æ—Ä—è–¥–æ–∫: oldest_first (–º–µ–Ω—å—à–µ = —Å—Ç–∞—Ä—à–µ = –≤—ã—à–µ)       ‚îÇ
‚îÇ   - –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º: –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ mfg_date ‚Üí –ø–æ idx         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### 1.3. –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

1. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:**
   - Rank-based –∞–ª–≥–æ—Ä–∏—Ç–º –±–µ–∑ –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –ü–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –æ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –Ø–≤–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ (mfg_date, –∑–∞—Ç–µ–º idx)

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ race conditions:**
   - –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑: write ‚Üí read ‚Üí decide
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `exchange()` –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏
   - –ú–∞—Å–∫–∏ –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è –≤ —Ñ–∞–∑–µ —á—Ç–µ–Ω–∏—è

3. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:**
   - –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å `rtc_quota_ops_excess.py`
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `register_rtc(model, agent)`
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ `add_rtc_module()`

4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
   - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö –¥–Ω—è—Ö (180-182)
   - –í—ã–≤–æ–¥ Curr, Target, K –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   - –õ–æ–≥–∏ –¥–µ–º–æ—É—Ç–∞ —Å idx –∏ rank

#### ‚ö†Ô∏è –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞:**
   - –õ–æ–≥–∏–∫–∞ –¥–ª—è Mi-8 –∏ Mi-17 –∏–¥–µ–Ω—Ç–∏—á–Ω–∞, –Ω–æ –ø—Ä–æ–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∞
   - ~100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –Ω–∞ –∫–∞–∂–¥—ã–π group_by

2. **–ñ—ë—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞:**
   - –¢–æ–ª—å–∫–æ –¥–ª—è operations (state_2)
   - –¢–æ–ª—å–∫–æ –¥–µ–º–æ—É—Ç (2‚Üí3)
   - –¢–æ–ª—å–∫–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç oldest_first

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–º–æ—É—Ç–∞:**
   - –ù–µ—Ç –ª–æ–≥–∏–∫–∏ –ø–æ–≤—ã—à–µ–Ω–∏—è (3/5/1‚Üí2)
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø—Ä–æ–º–æ—É—Ç–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
   - –î–µ—Ñ–∏—Ü–∏—Ç –∫–≤–æ—Ç—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å
   - ~400 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –Ω–∞ –∫–∞–∂–¥—ã–π —Å–ª—É—á–∞–π
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å—Ç—ë—Ç –ª–∏–Ω–µ–π–Ω–æ

---

### 1.4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ V2 Orchestrator

#### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

```python
# orchestrator_v2.py
def build_model(self, rtc_modules: List[str]):
    for module_name in rtc_modules:
        self.base_model.add_rtc_module(module_name)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ù–ï –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏!

```bash
# –¢–µ–∫—É—â–∏–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):
python3 code/sim_v2/orchestrator_v2.py \
  --modules spawn_v2 state_2_operations quota_ops_excess \
            states_stub state_manager_operations \
  --steps 3650 --enable-mp2
```

**–°—Ç–∞—Ç—É—Å:** `quota_ops_excess` –≤ —Å–ø–∏—Å–∫–µ –º–æ–¥—É–ª–µ–π, –Ω–æ:
- –ù–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `base_model.add_rtc_module()`
- –ü—Ä–æ–º–æ—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ù–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞

---

## 2. –ü—Ä–æ–µ–∫—Ç–Ω—ã–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏

### 2.1. –î–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

| –î–æ–∫—É–º–µ–Ω—Ç | –î–∞—Ç–∞ | –°—Ç–∞—Ç—É—Å | –§–æ–∫—É—Å |
|----------|------|--------|-------|
| `universal_quota_manager_design.md` | 02-10-2025 | –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | API —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ |
| `quota_manager_intent_based.md` | 02-10-2025 | –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | Intent-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ |
| `refactoring_plan_quota_optimization.md` | 02-10-2025 | –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ª–æ—ë–≤ (30‚Üí11) |

---

### 2.2. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–≤–æ—Ç

#### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**–ò–¥–µ—è:** –û–¥–∏–Ω –º–æ–¥—É–ª—å –¥–ª—è –í–°–ï–• —Å–ª—É—á–∞–µ–≤ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```python
QuotaManager(
    target_state="operations",
    limit_source="mp4_ops_counter",
    demount_to="serviceable",
    promote_from=["serviceable", "reserve", "inactive"],
    priority_field="mp3_mfg_date_days",
    priority_order="oldest_first"
)
```

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –ú–ï–ù–ï–î–ñ–ï–† –ö–í–û–¢                          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –§–ê–ó–ê 1: CLEAR MASKS                                   ‚îÇ
‚îÇ - –û—á–∏—Å—Ç–∫–∞ –º–∞—Å–æ–∫ –¥–ª—è –≤—Å–µ—Ö group_by                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –§–ê–ó–ê 2: MARK & DECIDE                                 ‚îÇ
‚îÇ                                                        ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ ‚îÇ 1. –ü–æ–¥—Å—á—ë—Ç Curr –∏ Target                        ‚îÇ   ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                        ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ ‚îÇ 2. –ï–°–õ–ò Curr > Target (–ò–ó–ë–´–¢–û–ö)                ‚îÇ   ‚îÇ
‚îÇ ‚îÇ    ‚îî‚îÄ> –î–µ–º–æ—É—Ç: target ‚Üí demount_to              ‚îÇ   ‚îÇ
‚îÇ ‚îÇ        - –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ priority_field          ‚îÇ   ‚îÇ
‚îÇ ‚îÇ        - K = Curr - Target                       ‚îÇ   ‚îÇ
‚îÇ ‚îÇ        - –í—ã–±–æ—Ä K –∞–≥–µ–Ω—Ç–æ–≤ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º ‚îÇ   ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                        ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ ‚îÇ 3. –ï–°–õ–ò Curr < Target (–î–ï–§–ò–¶–ò–¢)                 ‚îÇ   ‚îÇ
‚îÇ ‚îÇ    ‚îî‚îÄ> –ü—Ä–æ–º–æ—É—Ç (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º): ‚îÇ   ‚îÇ
‚îÇ ‚îÇ        –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: promote_from[0] ‚Üí target     ‚îÇ   ‚îÇ
‚îÇ ‚îÇ        –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: promote_from[1] ‚Üí target     ‚îÇ   ‚îÇ
‚îÇ ‚îÇ        –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: promote_from[2] ‚Üí target     ‚îÇ   ‚îÇ
‚îÇ ‚îÇ        ...                                        ‚îÇ   ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –§–ê–ó–ê 3: APPLY (—á–µ—Ä–µ–∑ state_transitions)               ‚îÇ
‚îÇ - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö intent                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### API –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```python
class QuotaManager:
    def __init__(
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        # –û–°–ù–û–í–ù–´–ï
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        target_state: str,              # "operations", "repair"
        
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        # –õ–ò–ú–ò–¢
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        limit_source: str = None,       # "mp4_ops_counter" (PropertyArray)
        limit_value: int = None,        # 50 (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞)
        limit_per_group: bool = True,   # –†–∞–∑–¥–µ–ª—å–Ω–æ Mi-8/Mi-17
        
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        # –î–ï–ú–û–£–¢ (–°–ù–ò–ñ–ï–ù–ò–ï)
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        demount_enabled: bool = True,
        demount_to_state: str = None,   # "serviceable"
        demount_priority_field: str = None,  # "mp3_mfg_date_days"
        demount_priority_order: str = "oldest_first",
        
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        # –ü–†–û–ú–û–£–¢ (–ü–û–í–´–®–ï–ù–ò–ï)
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        promote_enabled: bool = True,
        promote_from_states: List[str] = None,  # ["serviceable", "reserve", "inactive"]
        promote_priority_field: str = None,
        promote_priority_order: str = "fcfs",
        promote_conditions: Dict[str, str] = None,  # {"inactive": "day > repair_time"}
        
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        # –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï
        # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        mask_name_prefix: str = "quota_mask",
        enable_logging: bool = False
    )
```

---

### 2.3. Intent-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

#### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è

**–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–≤–æ—Ç = –∞—Ä–±–∏—Ç—Ä –º–µ–∂–¥—É –∏–Ω—Ç–µ–Ω—Ç–∞–º–∏**

```
State Processing (—Å–ª–æ–π 3):
‚îú‚îÄ> operations:  intent=2 (–æ—Å—Ç–∞—é—Å—å)  ‚îÄ‚îÄ‚îÄ‚îê
‚îú‚îÄ> serviceable: intent=2 (—Ö–æ—á—É –≤ ops) ‚îÄ‚î§
‚îú‚îÄ> reserve:     intent=2 (—Ö–æ—á—É –≤ ops) ‚îÄ‚îº‚îÄ‚îÄ> QuotaManager
‚îú‚îÄ> inactive:    intent=2 (—Ö–æ—á—É –≤ ops) ‚îÄ‚î§    ‚îú‚îÄ> –°—á–∏—Ç–∞–µ—Ç Curr –∏ Target
‚îî‚îÄ> repair:      intent=4 (–æ—Å—Ç–∞—é—Å—å)     ‚îò    ‚îú‚îÄ> –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã
                                              ‚îî‚îÄ> –û–¥–æ–±—Ä—è–µ—Ç/–æ—Ç–∫–ª–æ–Ω—è–µ—Ç

State Transitions (—Å–ª–æ–π 8):
‚îî‚îÄ> –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ–Ω—Ç—ã
```

#### –ê–ª–≥–æ—Ä–∏—Ç–º

```
–î–õ–Ø –ö–ê–ñ–î–û–ì–û group_by (Mi-8, Mi-17):

1. –ü–æ–¥—Å—á—ë—Ç —Ç–µ–∫—É—â–∏—Ö –≤ target_state:
   Curr = count(agents –≥–¥–µ intent == target_state_id)

2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞:
   Target = limit_source[day+1] –ò–õ–ò limit_value

3. –ï–°–õ–ò Curr > Target (–ò–ó–ë–´–¢–û–ö):
   ‚îî‚îÄ> –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–µ–º–æ—É—Ç —Å–ª–æ–π:
       - –ù–∞–π—Ç–∏ –∞–≥–µ–Ω—Ç–æ–≤: state=target AND intent=demount_intent
       - –†–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å –ø–æ priority_field
       - K = Curr - Target
       - K –∞–≥–µ–Ω—Ç–æ–≤ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å intent

4. –ï–°–õ–ò Curr < Target (–î–ï–§–ò–¶–ò–¢):
   ‚îî‚îÄ> –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–º–æ—É—Ç —Å–ª–æ–∏ (–ü–û –ü–û–†–Ø–î–ö–£):
       –î–ª—è –∫–∞–∂–¥–æ–≥–æ source_state –≤ promote_from_states:
         - –ù–∞–π—Ç–∏ –∞–≥–µ–Ω—Ç–æ–≤: state=source AND intent=target_state_id
         - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ª–æ–≤–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
         - –†–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å —Å —É—á—ë—Ç–æ–º rank_offset
         - –û–¥–æ–±—Ä–∏—Ç—å –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞ Curr < Target
         - –û–±–Ω–æ–≤–∏—Ç—å Curr
         - –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É source_state

5. –ï–°–õ–ò Curr == Target:
   ‚îî‚îÄ> –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å (–∫–≤–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞)
```

---

### 2.4. –ü–ª–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–ª–æ—ë–≤ (30‚Üí11)

#### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞

```
–°–ª–æ–π 1:    rtc_probe_mp5
–°–ª–æ–π 2:    rtc_quota_begin_day

–°–ª–æ–π 3-5:  State processing (status 2/4/6)

–°–ª–æ–π 6-9:  Quota —Ü–∏–∫–ª –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ 2  ‚Üê –î–£–ë–õ–ò–ö–ê–¢
–°–ª–æ–π 10-13: Quota —Ü–∏–∫–ª –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ 3 ‚Üê –î–£–ë–õ–ò–ö–ê–¢
–°–ª–æ–π 14:   status_3_post
–°–ª–æ–π 15-18: Quota —Ü–∏–∫–ª –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ 5 ‚Üê –î–£–ë–õ–ò–ö–ê–¢
–°–ª–æ–π 19-22: Quota —Ü–∏–∫–ª –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ 1 ‚Üê –î–£–ë–õ–ò–ö–ê–¢

–°–ª–æ–π 23-25: Post-–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
–°–ª–æ–π 26:   rtc_log_day
–°–ª–æ–π 27-28: Spawn
–°–ª–æ–π 29-30: MP2 export

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ò–¢–û–ì–û: 30 –°–õ–û–Å–í
–ü—Ä–æ–±–ª–µ–º—ã: 16 –ª–∏—à–Ω–∏—Ö —Å–ª–æ—ë–≤ –Ω–∞ –∫–≤–æ—Ç—ã (4√ó4)
```

#### –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

```
‚îå‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îì
‚ïë –§–ê–ó–ê 0: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø (2 —Å–ª–æ—è)                   ‚ïë
‚îó‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îõ
–°–ª–æ–π 1:  HostFunction MP5 Init (—Ç–æ–ª—å–∫–æ step=0)
–°–ª–æ–π 2:  rtc_begin_day

‚îå‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îì
‚ïë –§–ê–ó–ê 1: STATE PROCESSING (1 —Å–ª–æ–π, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!)  ‚ïë
‚îó‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îõ
–°–ª–æ–π 3:  State processing (–í–°–ï —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ)
         ‚îú‚îÄ> rtc_state_1_inactive
         ‚îú‚îÄ> rtc_state_2_operations
         ‚îú‚îÄ> rtc_state_3_serviceable
         ‚îú‚îÄ> rtc_state_4_repair
         ‚îú‚îÄ> rtc_state_5_reserve
         ‚îî‚îÄ> rtc_state_6_storage

‚îå‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îì
‚ïë –§–ê–ó–ê 2: QUOTA DEMOUNT (3 —Å–ª–æ—è)                   ‚ïë
‚îó‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îõ
–°–ª–æ–π 4:  rtc_quota_demount_mark
–°–ª–æ–π 5:  rtc_quota_demount_decide
–°–ª–æ–π 6:  rtc_quota_demount_clear

‚îå‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îì
‚ïë –§–ê–ó–ê 3: QUOTA PROMOTE (3 —Å–ª–æ—è, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)  ‚ïë
‚îó‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îõ
–°–ª–æ–π 7:  rtc_quota_promote_serviceable (3‚Üí2)
–°–ª–æ–π 8:  rtc_quota_promote_reserve      (5‚Üí2)
–°–ª–æ–π 9:  rtc_quota_promote_inactive     (1‚Üí2)

‚îå‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îì
‚ïë –§–ê–ó–ê 4: STATE TRANSITIONS (1 —Å–ª–æ–π)               ‚ïë
‚îó‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îõ
–°–ª–æ–π 10: rtc_state_transitions

‚îå‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îì
‚ïë –§–ê–ó–ê 5: LOGGING & SPAWN (3 —Å–ª–æ—è)                 ‚ïë
‚îó‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚îõ
–°–ª–æ–π 11: rtc_mp2_write
–°–ª–æ–π 12: rtc_spawn_mgr (—É—Å–ª–æ–≤–Ω—ã–π)
–°–ª–æ–π 13: rtc_spawn_ticket (—É—Å–ª–æ–≤–Ω—ã–π)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ò–¢–û–ì–û: 13 –°–õ–û–Å–í (–±—ã–ª–æ 30!)
–≠–∫–æ–Ω–æ–º–∏—è: -57% —Å–ª–æ—ë–≤, -62,050 GPU —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π
```

#### –ú–µ—Ç—Ä–∏–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–µ–∫—É—â–∞—è (30) | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è (13) | –≠–∫–æ–Ω–æ–º–∏—è |
|---------|--------------|----------------------|----------|
| **–°–ª–æ—ë–≤ –Ω–∞ —à–∞–≥** | 30 | 13 | **-57%** |
| **GPU –±–∞—Ä—å–µ—Ä–æ–≤ (3650 –¥–Ω–µ–π)** | 109,500 | 47,450 | **-57%** |
| **Overhead –±–∞—Ä—å–µ—Ä–æ–≤** | ~11-110—Å | ~5-47—Å | **-57%** |
| **Quota —Å–ª–æ—ë–≤** | 16 | 6 | **-63%** |
| **State —Å–ª–æ—ë–≤** | 6 | 1 | **-83%** |
| **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** | –î–∞ (4√ó) | –ù–µ—Ç | **-75%** |

---

## 3. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### 3.1. –¢–µ–∫—É—â–∞—è vs –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

| –ê—Å–ø–µ–∫—Ç | –¢–µ–∫—É—â–∞—è | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ |
|--------|---------|---------------|--------------|
| **–ú–æ–¥—É–ª–µ–π** | 1 (—Ç–æ–ª—å–∫–æ –¥–µ–º–æ—É—Ç) | 1 (–¥–µ–º–æ—É—Ç + –ø—Ä–æ–º–æ—É—Ç) | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å |
| **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞** | ~400 | ~680 | –ë–æ–ª—å—à–µ, –Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ |
| **–ù–æ–≤—ã–π –∫–µ–π—Å** | +400 —Å—Ç—Ä–æ–∫ | +20 —Å—Ç—Ä–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | **95% —ç–∫–æ–Ω–æ–º–∏–∏** |
| **–°–ª–æ—ë–≤** | 3 (—Ç–æ–ª—å–∫–æ –¥–µ–º–æ—É—Ç) | 2-6 (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏) | –ì–∏–±–∫–æ—Å—Ç—å |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | 1 –º–æ–¥—É–ª—å | 1 –º–æ–¥—É–ª—å | –û–¥–∏–Ω–∞–∫–æ–≤–æ |
| **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** | –î–∞ (Mi-8/Mi-17) | –ù–µ—Ç (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è) | –ß–∏—â–µ –∫–æ–¥ |
| **–ü—Ä–æ–º–æ—É—Ç** | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | ‚úÖ –ï—Å—Ç—å | –ü–æ–ª–Ω–æ—Ç–∞ |
| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã** | 1 (oldest_first) | 6+ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ) | –ì–∏–±–∫–æ—Å—Ç—å |

---

### 3.2. –î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç

**–°–Ω–∏–∂–µ–Ω–∏–µ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ù–ï –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã:**

```
1. –°–Ω–∞—á–∞–ª–∞ —Å–Ω–∏–∂–∞–µ–º –∏–∑–±—ã—Ç–æ–∫ (2‚Üí3)
   ‚îî‚îÄ> –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –∫–≤–æ—Ç—É

2. –ü–æ—Ç–æ–º –ø–æ–≤—ã—à–∞–µ–º –¥–µ—Ñ–∏—Ü–∏—Ç (3/5/1‚Üí2)
   ‚îî‚îÄ> –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Å–≤–æ–±–æ–¥–∏–≤—à—É—é—Å—è –∫–≤–æ—Ç—É

3. –ü–æ—Ä—è–¥–æ–∫ –∫—Ä–∏—Ç–∏—á–µ–Ω!
```

#### –ü—Ä–∏–º–µ—Ä

```
–î–µ–Ω—å 180:
  Curr_operations = 150
  Target_operations = 100

–®–∞–≥ 1: –î–µ–º–æ—É—Ç (2‚Üí3)
  K = 150 - 100 = 50
  –í—ã–±–∏—Ä–∞–µ–º 50 —Å–∞–º—ã—Ö —Å—Ç–∞—Ä—ã—Ö ‚Üí intent=3
  Curr_operations = 100

–®–∞–≥ 2: –ü—Ä–æ–º–æ—É—Ç (3/5/1‚Üí2)
  –î–µ—Ñ–∏—Ü–∏—Ç = 100 - 100 = 0
  –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º

–î–µ–Ω—å 181:
  Curr_operations = 80 (–ø–æ—Å–ª–µ –¥–µ–º–æ—É—Ç–∞ + –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —É–±—ã–ª—å)
  Target_operations = 100

–®–∞–≥ 1: –î–µ–º–æ—É—Ç (2‚Üí3)
  Curr ‚â§ Target ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º

–®–∞–≥ 2: –ü—Ä–æ–º–æ—É—Ç (3/5/1‚Üí2)
  –î–µ—Ñ–∏—Ü–∏—Ç = 100 - 80 = 20
  –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: serviceable (3‚Üí2) ‚Äî –±–µ—Ä—ë–º 15
  –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: reserve (5‚Üí2) ‚Äî –±–µ—Ä—ë–º 5
  Curr_operations = 100
```

---

### 3.3. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø—Ä–æ–º–æ—É—Ç–∞

#### –¢–µ–∫—É—â–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

```
–ü–†–ò–û–†–ò–¢–ï–¢ 1 (–í–´–°–®–ò–ô): serviceable ‚Üí operations
  - –ê–≥–µ–Ω—Ç—ã —É–∂–µ –≥–æ—Ç–æ–≤—ã –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
  - –ù–µ —Ç—Ä–µ–±—É—é—Ç —Ä–µ–º–æ–Ω—Ç–∞
  - –ê–ª–≥–æ—Ä–∏—Ç–º: FCFS (First Come First Serve)

–ü–†–ò–û–†–ò–¢–ï–¢ 2 (–°–†–ï–î–ù–ò–ô): reserve ‚Üí operations
  - –ê–≥–µ–Ω—Ç—ã –≤ —Ä–µ–∑–µ—Ä–≤–µ
  - –ó–∞–≤–µ—Ä—à–∏–ª–∏ —Ä–µ–º–æ–Ω—Ç
  - –ê–ª–≥–æ—Ä–∏—Ç–º: FCFS

–ü–†–ò–û–†–ò–¢–ï–¢ 3 (–ù–ò–ó–®–ò–ô): inactive ‚Üí operations
  - –ê–≥–µ–Ω—Ç—ã –ø–æ—Å–ª–µ —Ä–µ–º–æ–Ω—Ç–∞
  - –£—Å–ª–æ–≤–∏–µ: (day - repair_time) > version_date
  - –ê–ª–≥–æ—Ä–∏—Ç–º: FCFS + —É—Å–ª–æ–≤–∏–µ –≤—Ä–µ–º–µ–Ω–∏
```

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä–µ

```python
operations_quota = QuotaManager(
    target_state="operations",
    limit_source="mp4_ops_counter",
    
    # –î–µ–º–æ—É—Ç
    demount_to="serviceable",
    demount_priority="oldest_first",
    
    # –ü—Ä–æ–º–æ—É—Ç (–ø–æ—Ä—è–¥–æ–∫ = –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç!)
    promote_from=[
        "serviceable",  # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1
        "reserve",      # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2
        "inactive"      # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3
    ],
    promote_conditions={
        "inactive": "(day - repair_time) > version_date"
    }
)
```

---

## 4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 4.1. –í—ã–±–æ—Ä –º–µ–∂–¥—É –ø–æ–¥—Ö–æ–¥–∞–º–∏

#### –í–∞—Ä–∏–∞–Ω—Ç A: –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ + –ø—Ä–æ–º–æ—É—Ç –º–æ–¥—É–ª–∏

**–ü–ª—é—Å—ã:**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ—É—Ç–∞
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

**–ú–∏–Ω—É—Å—ã:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (4√ó –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤)
- ~1600 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –Ω–∞ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–µ–π—Å–æ–≤

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** üü° –°—Ä–µ–¥–Ω—è—è (2-3 –¥–Ω—è)

---

#### –í–∞—Ä–∏–∞–Ω—Ç B: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–≤–æ—Ç

**–ü–ª—é—Å—ã:**
- –û–¥–∏–Ω –º–æ–¥—É–ª—å –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤
- ~680 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (–≤–º–µ—Å—Ç–æ 1600+)
- –ù–æ–≤—ã–π –∫–µ–π—Å = 20 —Å—Ç—Ä–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ï–¥–∏–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –†–∏—Å–∫ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** üî¥ –í—ã—Å–æ–∫–∞—è (5-7 –¥–Ω–µ–π)

---

#### –í–∞—Ä–∏–∞–Ω—Ç C: Intent-based –º–µ–Ω–µ–¥–∂–µ—Ä

**–ü–ª—é—Å—ã:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- –°–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã state processing
- –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** üî¥ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (10-14 –¥–Ω–µ–π)

---

### 4.2. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥

#### üéØ –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (–ø–æ—ç—Ç–∞–ø–Ω–∞—è)

```
–≠–¢–ê–ü 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ—É—Ç–∞ (—Ç–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
  –¶–µ–ª—å: –ó–∞–≤–µ—Ä—à–∏—Ç—å –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
  –î–µ–π—Å—Ç–≤–∏—è:
    - –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª–∏ –ø—Ä–æ–º–æ—É—Ç–∞ (3/5/1‚Üí2)
    - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ orchestrator_v2
    - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ DAYS={5,90,365}
  –°–ª–æ–∂–Ω–æ—Å—Ç—å: üü° –°—Ä–µ–¥–Ω—è—è (2-3 –¥–Ω—è)
  –†–∏—Å–∫: üü¢ –ù–∏–∑–∫–∏–π

–≠–¢–ê–ü 2: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
  –¶–µ–ª—å: –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
  –î–µ–π—Å—Ç–≤–∏—è:
    - –°–æ–∑–¥–∞—Ç—å QuotaManager –∫–ª–∞—Å—Å
    - –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ—É—Ç –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
    - –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ—É—Ç –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
    - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞
  –°–ª–æ–∂–Ω–æ—Å—Ç—å: üî¥ –í—ã—Å–æ–∫–∞—è (5-7 –¥–Ω–µ–π)
  –†–∏—Å–∫: üü° –°—Ä–µ–¥–Ω–∏–π

–≠–¢–ê–ü 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ª–æ—ë–≤ (30‚Üí13)
  –¶–µ–ª—å: –°–Ω–∏–∂–µ–Ω–∏–µ overhead GPU –±–∞—Ä—å–µ—Ä–æ–≤
  –î–µ–π—Å—Ç–≤–∏—è:
    - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ state processing –≤ 1 —Å–ª–æ–π
    - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è quota —Å–ª–æ—ë–≤
    - –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  –°–ª–æ–∂–Ω–æ—Å—Ç—å: üî¥ –í—ã—Å–æ–∫–∞—è (3-5 –¥–Ω–µ–π)
  –†–∏—Å–∫: üü° –°—Ä–µ–¥–Ω–∏–π

–≠–¢–ê–ü 4: Intent-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  –¶–µ–ª—å: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å –¥–ª—è –±—É–¥—É—â–∏—Ö –∫–µ–π—Å–æ–≤
  –î–µ–π—Å—Ç–≤–∏—è:
    - –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ intent-based –æ–±—Ä–∞–±–æ—Ç–∫—É
    - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∞—Ä–±–∏—Ç—Ä –∏–Ω—Ç–µ–Ω—Ç–æ–≤
  –°–ª–æ–∂–Ω–æ—Å—Ç—å: üî¥ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (10-14 –¥–Ω–µ–π)
  –†–∏—Å–∫: üî¥ –í—ã—Å–æ–∫–∏–π
```

---

### 4.3. –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

#### –ü—Ä–∏ –ª—é–±–æ–º –ø–æ–¥—Ö–æ–¥–µ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:

1. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:**
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –Ω–∞ –æ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö ‚Üí –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - Rank-based –∞–ª–≥–æ—Ä–∏—Ç–º—ã (–Ω–µ random)
   - –Ø–≤–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏

2. **–î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç—å:**
   - –°–Ω–∞—á–∞–ª–∞ –¥–µ–º–æ—É—Ç (—Å–Ω–∏–∂–µ–Ω–∏–µ –∏–∑–±—ã—Ç–∫–∞)
   - –ü–æ—Ç–æ–º –ø—Ä–æ–º–æ—É—Ç (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ—Ñ–∏—Ü–∏—Ç–∞)
   - –ü–æ—Ä—è–¥–æ–∫ –∫—Ä–∏—Ç–∏—á–µ–Ω!

3. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø—Ä–æ–º–æ—É—Ç–∞:**
   - serviceable ‚Üí operations (–≤—ã—Å—à–∏–π)
   - reserve ‚Üí operations (—Å—Ä–µ–¥–Ω–∏–π)
   - inactive ‚Üí operations (–Ω–∏–∑—à–∏–π, —Å —É—Å–ª–æ–≤–∏–µ–º)

4. **–†–∞–∑–¥–µ–ª—å–Ω–æ–µ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - Mi-8 –∏ Mi-17 –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
   - –û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –∏–∑ MP4

5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ race conditions:**
   - –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑: write ‚Üí read ‚Üí decide
   - –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –º–∞—Å–æ–∫

---

## 5. –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 5.1. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

#### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:

1. **–î–µ–º–æ—É—Ç (2‚Üí3):**
   - –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
   - –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ race conditions
   - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

2. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:**
   - –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
   - –ß–∏—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

3. **–ü—Ä–æ–µ–∫—Ç–Ω—ã–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏:**
   - 3 –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞
   - –ü—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
   - –ì–æ—Ç–æ–≤—ã–µ API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### ‚ùå –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:

1. **–ü—Ä–æ–º–æ—É—Ç (3/5/1‚Üí2):**
   - –ù–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
   - –ù–µ—Ç –º–æ–¥—É–ª–µ–π
   - –î–µ—Ñ–∏—Ü–∏—Ç –∫–≤–æ—Ç—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

2. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:**
   - –ñ—ë—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ operations
   - –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è Mi-8/Mi-17
   - –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–µ–π—Å–æ–≤

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - `quota_ops_excess` –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `add_rtc_module()`
   - –ù–µ—Ç —Ñ–ª–∞–≥–æ–≤ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö

---

### 5.2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–∞–∑–≤–∏—Ç–∏—è

#### üî• P0 (–ö—Ä–∏—Ç–∏—á–Ω–æ):

1. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–æ—É—Ç–∞:**
   - –ú–æ–¥—É–ª–∏: `rtc_quota_promote_serviceable`, `rtc_quota_promote_reserve`, `rtc_quota_promote_inactive`
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ orchestrator_v2
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ base_model:**
   - –î–æ–±–∞–≤–∏—Ç—å `quota_ops_excess` –≤ `add_rtc_module()`
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–æ—É—Ç –º–æ–¥—É–ª–∏
   - –§–ª–∞–≥–∏ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è

#### üü° P1 (–í–∞–∂–Ω–æ):

3. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–≤–æ—Ç:**
   - –°–æ–∑–¥–∞—Ç—å `QuotaManager` –∫–ª–∞—Å—Å
   - –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
   - –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ª–æ—ë–≤:**
   - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ state processing
   - –°–Ω–∏–∂–µ–Ω–∏–µ overhead –±–∞—Ä—å–µ—Ä–æ–≤
   - –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### üü¢ P2 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ):

5. **Intent-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
   - –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ intent-based –æ–±—Ä–∞–±–æ—Ç–∫—É
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∞—Ä–±–∏—Ç—Ä
   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å

6. **–ù–æ–≤—ã–µ –∫–µ–π—Å—ã –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–º–æ–Ω—Ç–∞ (repair)
   - –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–∞ (reserve)
   - –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è (storage)

---

### 5.3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –î–ª—è –≠–¢–ê–ü–ê 1 (–ø—Ä–æ–º–æ—É—Ç):

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:**
   - 3 –º–æ–¥—É–ª—è: serviceable, reserve, inactive
   - –¢—Ä—ë—Ö—Ñ–∞–∑–Ω–∞—è —Å—Ö–µ–º–∞ (clear, mark, decide)
   - –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

2. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —á–µ—Ä–µ–∑ –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ—ë–≤:**
   ```
   –°–ª–æ–π N:   rtc_quota_promote_serviceable  (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)
   –°–ª–æ–π N+1: rtc_quota_promote_reserve      (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)
   –°–ª–æ–π N+2: rtc_quota_promote_inactive     (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)
   ```

3. **–£—á—ë—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞:**
   - –ö–∞–∂–¥—ã–π —Å–ª–æ–π —á–∏—Ç–∞–µ—Ç —Ç–µ–∫—É—â–∏–π Curr
   - –û–¥–æ–±—Ä—è–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞ Curr < Target
   - –°–ª–µ–¥—É—é—â–∏–π —Å–ª–æ–π –≤–∏–¥–∏—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π Curr

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - Smoke-—Ç–µ—Å—Ç—ã –Ω–∞ DAYS=5
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ DAYS=90
   - –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω –Ω–∞ DAYS=365
   - –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º: –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã

#### –î–ª—è –≠–¢–ê–ü–ê 2 (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä):

1. **API-first –ø–æ–¥—Ö–æ–¥:**
   - –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å API
   - –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é RTC –∫–æ–¥–∞

2. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è:**
   - –ù–∞—á–∞—Ç—å —Å –¥–µ–º–æ—É—Ç–∞ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
   - –ó–∞—Ç–µ–º –ø—Ä–æ–º–æ—É—Ç
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å—Ç–∞—Ä—ã–π vs –Ω–æ–≤—ã–π)

3. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –º–æ–¥—É–ª–∏ –¥–æ –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
   - –§–ª–∞–≥–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è–º–∏
   - Rollback –ø—Ä–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

---

### 5.4. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| **–ù–∞—Ä—É—à–µ–Ω–∏–µ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞** | üü° –°—Ä–µ–¥–Ω—è—è | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ–µ | –°—Ç—Ä–æ–≥–∏–µ —Ç–µ—Å—Ç—ã –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç–∏ |
| **Race conditions** | üü¢ –ù–∏–∑–∫–∞—è | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ–µ | –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑ |
| **–†–µ–≥—Ä–µ—Å—Å–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** | üü° –°—Ä–µ–¥–Ω—è—è | üü° –°—Ä–µ–¥–Ω–µ–µ | –ë–µ–Ω—á–º–∞—Ä–∫–∏, fallback |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏** | üü° –°—Ä–µ–¥–Ω—è—è | üü° –°—Ä–µ–¥–Ω–µ–µ | –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç** | üü¢ –ù–∏–∑–∫–∞—è | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ–µ | –†–∞–∑–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–∏, —è–≤–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ |

---

### 5.5. –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (DAYS={5,90,365,3650})
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º: –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã ‚Üí –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (S6 immutable, Œîsne=Œ£dt)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã (2‚Üí3, 3/5/1‚Üí2)

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- ‚úÖ Overhead –±–∞—Ä—å–µ—Ä–æ–≤ —Å–Ω–∏–∂–µ–Ω –º–∏–Ω–∏–º—É–º –Ω–∞ 50% (–¥–ª—è –≠–¢–ê–ü–ê 3)
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —à–∞–≥–∞ –Ω–µ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å (¬±10%)
- ‚úÖ –û–±—â–µ–µ –≤—Ä–µ–º—è –ø—Ä–æ–≥–æ–Ω–∞ 3650 –¥–Ω–µ–π –Ω–µ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å

#### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:

- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è quota –ª–æ–≥–∏–∫–∏ (–¥–ª—è –≠–¢–ê–ü–ê 2)
- ‚úÖ –ú–æ–¥—É–ª–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ Code review passed

#### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:

- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã baseline
- ‚úÖ MP2 —ç–∫—Å–ø–æ—Ä—Ç –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- ‚úÖ Spawn —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ

---

## üìö –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### A. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
code/sim_v2/
‚îú‚îÄ‚îÄ base_model.py                    # –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
‚îú‚îÄ‚îÄ orchestrator_v2.py               # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
‚îú‚îÄ‚îÄ rtc_quota_ops_excess.py          # ‚úÖ –¢–µ–∫—É—â–∏–π –¥–µ–º–æ—É—Ç (2‚Üí3)
‚îú‚îÄ‚îÄ rtc_modules/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ rtc_spawn_v2.py              # ‚úÖ Spawn (—Ä–∞–±–æ—á–∏–π)
‚îÇ   ‚îú‚îÄ‚îÄ rtc_quota_promote_serviceable.py  # ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (TODO)
‚îÇ   ‚îú‚îÄ‚îÄ rtc_quota_promote_reserve.py      # ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (TODO)
‚îÇ   ‚îú‚îÄ‚îÄ rtc_quota_promote_inactive.py     # ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (TODO)
‚îÇ   ‚îî‚îÄ‚îÄ rtc_quota_universal.py            # ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–≠–¢–ê–ü 2)
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ agent_population.py          # –ü–æ–ø—É–ª—è—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤
    ‚îú‚îÄ‚îÄ telemetry_collector.py       # –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è
    ‚îî‚îÄ‚îÄ mp5_strategy.py              # MP5 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

docs/
‚îú‚îÄ‚îÄ quota_architecture_analysis_06-10-2025.md  # üÜï –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
‚îú‚îÄ‚îÄ universal_quota_manager_design.md          # –ü—Ä–æ–µ–∫—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
‚îú‚îÄ‚îÄ quota_manager_intent_based.md              # Intent-based –∫–æ–Ω—Ü–µ–ø—Ü–∏—è
‚îî‚îÄ‚îÄ refactoring_plan_quota_optimization.md     # –ü–ª–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–ª–æ—ë–≤
```

---

### B. –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞

#### –¢–µ–∫—É—â–∏–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):

```bash
cd /home/budnik_an/cube_linux/cube && \
rm -rf code/sim_v2/__pycache__ code/sim_v2/rtc_modules/__pycache__ code/sim_v2/components/__pycache__ && \
export CUDA_PATH=/usr/local/cuda-12.8 CUBE_CONFIG_PATH=/home/budnik_an/cube_linux/cube && \
python3 code/sim_v2/orchestrator_v2.py \
  --modules spawn_v2 state_2_operations quota_ops_excess states_stub \
            state_manager_operations state_manager_repair state_manager_storage \
  --steps 3650 --enable-mp2 --drop-table
```

#### –ë—É–¥—É—â–∏–π –∑–∞–ø—É—Å–∫ (—Å –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º):

```bash
# –≠–¢–ê–ü 1: –° –ø—Ä–æ–º–æ—É—Ç–æ–º
python3 code/sim_v2/orchestrator_v2.py \
  --modules spawn_v2 state_2_operations \
            quota_ops_excess \
            quota_promote_serviceable quota_promote_reserve quota_promote_inactive \
            states_stub state_manager_operations state_manager_repair state_manager_storage \
  --steps 3650 --enable-mp2 --drop-table

# –≠–¢–ê–ü 2: –° —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
python3 code/sim_v2/orchestrator_v2.py \
  --modules spawn_v2 state_2_operations \
            quota_universal \
            states_stub state_manager_operations state_manager_repair state_manager_storage \
  --steps 3650 --enable-mp2 --drop-table
```

---

### C. –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã

1. **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
   - `code/sim_v2/rtc_quota_ops_excess.py` ‚Äî –¥–µ–º–æ—É—Ç 2‚Üí3

2. **–ü—Ä–æ–µ–∫—Ç–Ω—ã–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏:**
   - `docs/universal_quota_manager_design.md` ‚Äî API —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
   - `docs/quota_manager_intent_based.md` ‚Äî Intent-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
   - `docs/refactoring_plan_quota_optimization.md` ‚Äî –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ª–æ—ë–≤

3. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ V2:**
   - `docs/rtc_pipeline_architecture.md` ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ RTC –ø–∞–π–ø–ª–∞–π–Ω–∞
   - `docs/v2_architecture_consolidated.md` ‚Äî –ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - `docs/v2_state_based_architecture.md` ‚Äî State-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 06-10-2025  
**–ê–≤—Ç–æ—Ä:** AI Agent (Cursor)  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ –æ–±—Å—É–∂–¥–µ–Ω–∏—é



