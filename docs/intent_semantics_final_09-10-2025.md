# –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–µ–º–∞–Ω—Ç–∏–∫–∞ intent_state

**–î–∞—Ç–∞:** 09-10-2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

---

## üéØ –ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø

**Intent –ù–ò–ö–û–ì–î–ê –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç—Å—è!**

–ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –∏–º–µ–µ—Ç:
- **state** ‚Äî —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–≥–¥–µ —Å–µ–π—á–∞—Å)
- **intent_state** ‚Äî –∂–µ–ª–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∫—É–¥–∞ —Ö–æ—á–µ—Ç)

---

## üìä –ü–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ intent_state

| Intent | –ó–Ω–∞—á–µ–Ω–∏–µ | –ö—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç | –ö–æ–≥–¥–∞ |
|--------|----------|-------------------|-------|
| **1** | –•–æ—á—É –æ—Å—Ç–∞—Ç—å—Å—è –≤ inactive | `rtc_states_stub` (state_1) | –ï—Å–ª–∏ `(day - repair_time) <= version_date` |
| **2** | –•–æ—á—É –≤ operations | ‚Ä¢ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è<br>‚Ä¢ `rtc_states_stub` (state_3, state_5)<br>‚Ä¢ `rtc_state_2_operations`<br>‚Ä¢ –ü—Ä–æ–º–æ—É—Ç—ã (–æ–¥–æ–±—Ä–µ–Ω)<br>‚Ä¢ `rtc_spawn_v2` | ‚Ä¢ Day 0<br>‚Ä¢ –í—Å–µ–≥–¥–∞ –¥–ª—è serviceable/reserve<br>‚Ä¢ –ï—Å–ª–∏ –æ—Å—Ç–∞—é—Å—å –≤ operations<br>‚Ä¢ –ï—Å–ª–∏ rank < K<br>‚Ä¢ –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **3** | –•–æ—á—É –≤ serviceable | `rtc_quota_ops_excess` (–¥–µ–º–æ—É—Ç) | –ï—Å–ª–∏ rank < K (—Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ) |
| **4** | –•–æ—á—É –≤/–æ—Å—Ç–∞—Ç—å—Å—è –≤ repair | ‚Ä¢ `rtc_state_2_operations`<br>‚Ä¢ `rtc_states_stub` (state_4) | ‚Ä¢ –ï—Å–ª–∏ PPR >= OH && SNE < BR<br>‚Ä¢ –ï—Å–ª–∏ repair_days < repair_time |
| **5** | –•–æ—á—É –≤ reserve | `rtc_states_stub` (state_4) | –ï—Å–ª–∏ repair_days == repair_time |
| **6** | –•–æ—á—É –≤ storage | `rtc_state_2_operations` | ‚Ä¢ –ï—Å–ª–∏ SNE >= LL<br>‚Ä¢ –ï—Å–ª–∏ PPR >= OH && SNE >= BR |

---

## ‚ùå –ß—Ç–æ –ù–ï –î–ï–õ–ê–ï–ú (—É–±—Ä–∞–ª–∏)

### 1. –û–±–Ω—É–ª–µ–Ω–∏–µ intent=0
**–ë—ã–ª–æ:**
```python
# agent_population.py
agent.setVariableUInt("intent_state", 0)  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

**–°—Ç–∞–ª–æ:**
```python
# –ó–∞–≤–∏—Å–∏—Ç –æ—Ç status_id:
if status_id == 4:
    agent.setVariableUInt("intent_state", 4)  # Repair
elif status_id == 6:
    agent.setVariableUInt("intent_state", 6)  # Storage
else:  # 1, 2, 3, 5
    agent.setVariableUInt("intent_state", 2)  # –•–æ—Ç—è—Ç –≤ operations
```

### 2. –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å intent –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–º–æ—É—Ç–∞
**–ë—ã–ª–æ:**
```cpp
// rtc_quota_promote_serviceable.py
else {
    intent_state = 3u;  // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: –º–µ–Ω—è–µ–º –Ω–∞ "—Ö–æ—á—É serviceable"
}
```

**–°—Ç–∞–ª–æ:**
```cpp
else {
    // –ù–ï –º–µ–Ω—è–µ–º intent!
    // –ê–≥–µ–Ω—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ö–æ—Ç–µ—Ç—å –≤ operations (intent=2) –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞
}
```

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ** –¥–ª—è `rtc_quota_promote_reserve.py` –∏ `rtc_quota_promote_inactive.py`.

---

## ‚úÖ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–µ–º–æ—É—Ç (2‚Üí3):
1. `state_2_operations` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `intent=2` (—Ö–æ—á—É –≤ operations)
2. `quota_ops_excess` –≤—ã–±–∏—Ä–∞–µ—Ç K —Å–∞–º—ã—Ö —Å—Ç–∞—Ä—ã—Ö ‚Üí `intent=3` (—Ö–æ—á—É –≤ serviceable)
3. `state_manager_operations` –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ 2‚Üí3

### –ü—Ä–æ–º–æ—É—Ç (3‚Üí2, 5‚Üí2, 1‚Üí2):
1. `rtc_states_stub` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `intent=2` (–¥–ª—è serviceable/reserve) –∏–ª–∏ —É—Å–ª–æ–≤–Ω–æ –¥–ª—è inactive
2. `quota_promote_*` –≤—ã–±–∏—Ä–∞–µ—Ç K —Å–∞–º—ã—Ö –º–æ–ª–æ–¥—ã—Ö ‚Üí `intent=2` –æ—Å—Ç–∞—ë—Ç—Å—è (–æ–¥–æ–±—Ä–µ–Ω)
3. –û—Å—Ç–∞–ª—å–Ω—ã–µ ‚Üí `intent=2` –æ—Å—Ç–∞—ë—Ç—Å—è (–ù–ï –æ–¥–æ–±—Ä–µ–Ω, –Ω–æ –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—Ç)
4. `state_manager_serviceable/reserve/inactive` –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥

---

## üìä –ü—Ä–∏–º–µ—Ä: –ù–æ–≤—ã–µ spawn –∞–≥–µ–Ω—Ç—ã

| –î–µ–Ω—å | State | Intent | SNE | PPR | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç |
|------|-------|--------|-----|-----|----------------|
| 226 | operations | **2** | 0 | 0 | Spawn ‚Üí serviceable + intent=2<br>–ü—Ä–æ–º–æ—É—Ç –æ–¥–æ–±—Ä–∏–ª ‚Üí intent=2 –æ—Å—Ç–∞—ë—Ç—Å—è<br>–ü–µ—Ä–µ—Ö–æ–¥ 3‚Üí2 ‚Üí operations + **intent=2** ‚úÖ |
| 227 | operations | **2** | 83 | 83 | `state_2_operations`: –æ—Å—Ç–∞—é—Å—å –≤ operations ‚Üí intent=2 ‚úÖ<br>–ù–∞—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞—Å—Ç–∏ |
| 228 | operations | **2** | 166 | 166 | –ü—Ä–æ–¥–æ–ª–∂–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å —Å intent=2 ‚úÖ |
| 229+ | operations | **2** | 249+ | 249+ | –†–∞–±–æ—Ç–∞—é –∏ —Ö–æ—á—É —Ä–∞–±–æ—Ç–∞—Ç—å ‚úÖ |

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –°–£–ë–î

```sql
SELECT day_u16, aircraft_number, state, intent_state, sne, ppr 
FROM sim_masterv2 
WHERE aircraft_number >= 100000 AND day_u16 IN (226, 227, 228, 229)
ORDER BY day_u16, aircraft_number
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Day 226: AC 100000-100006, state=operations, intent=2, sne=0, ppr=0     ‚úÖ
Day 227: AC 100000-100006, state=operations, intent=2, sne=83, ppr=83   ‚úÖ
Day 228: AC 100000-100006, state=operations, intent=2, sne=166, ppr=166 ‚úÖ
Day 229: AC 100000-100006, state=operations, intent=2, sne=249, ppr=249 ‚úÖ
```

**–í—Å–µ –¥–Ω–∏:** `intent=2` ("—Ä–∞–±–æ—Ç–∞—é –∏ —Ö–æ—á—É —Ä–∞–±–æ—Ç–∞—Ç—å") ‚úÖ

---

## üéì –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã

1. **Intent –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ 0** ‚Äî –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –∂–µ–ª–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
2. **Intent=2 –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç** ‚Äî –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤ —Ö–æ—Ç—è—Ç –≤ operations
3. **Intent —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–º–æ—É—Ç–∞** ‚Äî –∞–≥–µ–Ω—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ö–æ—Ç–µ—Ç—å –≤ operations
4. **Intent –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–º—ã—Å–ª–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö:**
   - –í—ã—Ä–∞–±–æ—Ç–∞–ª —Ä–µ—Å—É—Ä—Å ‚Üí intent=6
   - –ù—É–∂–µ–Ω —Ä–µ–º–æ–Ω—Ç ‚Üí intent=4
   - –î–µ–º–æ—É—Ç –æ–¥–æ–±—Ä–µ–Ω ‚Üí intent=3
   - –†–µ–º–æ–Ω—Ç –∑–∞–∫–æ–Ω—á–µ–Ω ‚Üí intent=5

---

## üìù –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. `code/sim_v2/components/agent_population.py`
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è intent –ø–æ status_id (2/4/6 –≤–º–µ—Å—Ç–æ 0)

2. `code/sim_v2/rtc_state_2_operations.py`
   - –û—Å—Ç–∞—é—â–∏–µ—Å—è –≤ operations ‚Üí intent=2 (–Ω–µ 0)

3. `code/sim_v2/rtc_quota_promote_serviceable.py`
   - –£–±—Ä–∞–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å intent=3 –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏

4. `code/sim_v2/rtc_quota_promote_reserve.py`
   - –£–±—Ä–∞–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å intent=5 –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏

5. `code/sim_v2/rtc_quota_promote_inactive.py`
   - –£–±—Ä–∞–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å intent=1 –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏

6. `code/sim_v2/rtc_state_manager_serviceable.py`
   - –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è intent –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ 3‚Üí2

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û  
**–ê–≤—Ç–æ—Ä—ã:** AI Assistant + –ê–ª–µ–∫—Å–µ–π  
**–ü—Ä–∏–Ω—Ü–∏–ø:** "Intent –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∂–µ–ª–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç—Å—è"

