# –§–∞–∫—Ç-—á–µ–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π FLAME GPU

**–î–∞—Ç–∞:** 02-10-2025  
**–°—Ç–∞—Ç—É—Å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ community  

---

## üîç –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
1. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://docs.flamegpu.com/
2. GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/FLAMEGPU/FLAMEGPU2
3. Research paper: "FLAME GPU 2: A framework for flexible and performant agent based simulation on GPUs"
4. Community discussions –∏ Issues

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª–æ 1: –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –º–æ–¥–µ–ª–∏

### –ù–∞—à–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
> –í–°–ï –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç–æ–≤ –∏ Environment properties –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω—ã –≤ ModelDescription –¥–æ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ RTC

### –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏: ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**

### –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
**–ò–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (docs.flamegpu.com):**
> "All agent variables and environment properties must be declared in the model description before compilation."

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:**
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç–æ–≤ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `agent.newVariable<T>()`
- Environment properties —á–µ—Ä–µ–∑ `env.newProperty<T>()`
- RTC —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è —Å —ç—Ç–∏–º–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏
- –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–æ–±—ä—è–≤–ª–µ–Ω–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é ‚Üí runtime error

**–í—ã–≤–æ–¥:** ‚úÖ –ü—Ä–∞–≤–∏–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## ‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª–æ 2: –ó–∞–ø–∏—Å—å –≤ MacroProperty —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –ù–∞—à–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
> –ê–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å –≤ MacroProperty –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (.exchange, .add, –∏ —Ç.–¥.)

### –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏: ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**

### –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞

**–ò–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (docs.flamegpu.com/guide/environment/):**
> "Agents can update macro properties of the environment with a limited set of atomic methods."

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
```cpp
// –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
.add()       // Atomic addition
.sub()       // Atomic subtraction  
.min()       // Atomic minimum
.max()       // Atomic maximum
```

**–ù–ï –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –Ω–∞–ø—Ä—è–º—É—é –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
```cpp
.exchange()  // Atomic exchange - –ù–ï –ù–ê–ô–î–ï–ù–û –≤ docs
.inc()       // Increment - –ù–ï –ù–ê–ô–î–ï–ù–û
.dec()       // Decrement - –ù–ï –ù–ê–ô–î–ï–ù–û
.cas()       // Compare-and-swap - –ù–ï –ù–ê–ô–î–ï–ù–û
```

### –£—Ç–æ—á–Ω–µ–Ω–∏–µ –∏–∑ –∫–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞
–í –≤–∞—à–µ–º –∫–æ–¥–µ `rtc_quota_ops_excess.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```cpp
mask[idx].exchange(0u);
mask[idx].exchange(1u);
```

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. ‚ùì –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ `.exchange()` –∏–ª–∏ —ç—Ç–æ –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ `.add()/.sub()`?
2. ‚ùì –ï—Å—Ç—å –ª–∏ –¥—Ä—É–≥–∏–µ –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏?

**–í—ã–≤–æ–¥:** ‚ö†Ô∏è –ü—Ä–∞–≤–∏–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ —á–∞—Å—Ç–∏ –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏, –Ω–æ —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π —Ç—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ FLAMEGPU2 –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã

---

## üî¥ –ü—Ä–∞–≤–∏–ª–æ 3: –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –≤ MacroProperty –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ

### –ù–∞—à–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
> –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ MacroProperty –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –†–ê–ó–ù–´–• —Å–ª–æ—è—Ö

### –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏: üî¥ **–ù–ï –ù–ê–ô–î–ï–ù–û –ü–†–Ø–ú–û–ì–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø**

### –ß—Ç–æ –Ω–∞–π–¥–µ–Ω–æ

**–ò–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- –£–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
- –ë–∞—Ä—å–µ—Ä—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è
- –ù–û: –Ω–µ—Ç —è–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–µ—Ç–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ

**–õ–æ–≥–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ (–Ω–∞—à–µ):**
- –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç A –ø–∏—à–µ—Ç `mask[5].add(1)` –∏ –∞–≥–µ–Ω—Ç B —á–∏—Ç–∞–µ—Ç `value = mask[5]`
- –ò –æ–±–∞ –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ ‚Üí –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ê–≥–µ–Ω—Ç B –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –∞–≥–µ–Ω—Ç–∞ A

**–ü—Ä–∞–∫—Ç–∏–∫–∞ –∏–∑ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞:**
```python
# –í—Å–µ–≥–¥–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–æ –ø–æ —Å–ª–æ—è–º:
layer_clear = model.newLayer()   # –ó–∞–ø–∏—Å—å
layer_mark = model.newLayer()    # –ó–∞–ø–∏—Å—å
layer_decide = model.newLayer()  # –ß—Ç–µ–Ω–∏–µ
```

**–í—ã–≤–æ–¥:** üî¥ –ü—Ä–∞–≤–∏–ª–æ –ª–æ–≥–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ, –Ω–æ –Ω–µ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ —è–≤–Ω–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°—á–∏—Ç–∞—Ç—å —ç—Ç–æ **best practice** –∏–∑ –æ–ø—ã—Ç–∞, –∞ –Ω–µ –∂—ë—Å—Ç–∫–∏–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º API

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª–æ 4: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Å—Å–∏–≤–æ–≤

### –ù–∞—à–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
> –†–∞–∑–º–µ—Ä MacroProperty –≤ RTC –¥–æ–ª–∂–µ–Ω –¢–û–ß–ù–û —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä—É, –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–º—É –≤ –º–æ–¥–µ–ª–∏

### –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏: ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**

### –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞

**–ò–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
> "Macro Environment Properties can have up to four dimensions... 
> The dimensions must match between declaration and usage."

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏—á–∏–Ω—ã:**
- RTC –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –º–∞—Å—Å–∏–≤–∞
- GPU –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã ‚Üí segfault –∏–ª–∏ undefined behavior

**–ò–∑ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞:**
```python
# –í –º–æ–¥–µ–ª–∏:
env.newMacroPropertyUInt32("mp5_lin", MAX_SIZE)  # MAX_SIZE = (DAYS+1)*FRAMES

# –í RTC:
auto mp5 = FLAMEGPU->environment.getMacroProperty<unsigned int, ${MAX_SIZE}u>("mp5_lin");
```

**–í—ã–≤–æ–¥:** ‚úÖ –ü—Ä–∞–≤–∏–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –∫—Ä–∏—Ç–∏—á–Ω–æ

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª–æ 5: –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

### –ù–∞—à–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
> –í—Å–µ –∞–≥–µ–Ω—Ç—ã –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ –î–û–õ–ñ–ù–´ –∏–º–µ—Ç—å –û–î–ò–ù–ê–ö–û–í–´–ô –Ω–∞–±–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏: ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**

### –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞

**–ò–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏:**
- AgentDescription –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –°–•–ï–ú–£ (schema) –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Ç–∏–ø–∞
- –í—Å–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –∞–≥–µ–Ω—Ç–∞ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –Ω–∞–±–æ—Ä–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∞–≥–µ–Ω—Ç–∞ —Å –¥—Ä—É–≥–∏–º –Ω–∞–±–æ—Ä–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- GPU –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –∫–∞–∫ Structure of Arrays (SoA)
- –î–ª—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤
- –í—Å–µ –∞–≥–µ–Ω—Ç—ã —Ç–∏–ø–∞ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã –≤ —ç—Ç–∏—Ö –º–∞—Å—Å–∏–≤–∞—Ö

**–ò–∑ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞:**
```python
agent = model.newAgent("heli")
agent.newVariableUInt("idx", 0)
agent.newVariableUInt("sne", 0)
agent.newVariableUInt("ppr", 0)
# ... –≤—Å–µ –∞–≥–µ–Ω—Ç—ã "heli" –±—É–¥—É—Ç –∏–º–µ—Ç—å –í–°–ï —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

**–í—ã–≤–æ–¥:** ‚úÖ –ü—Ä–∞–≤–∏–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞

| # | –ü—Ä–∞–≤–∏–ª–æ | –°—Ç–∞—Ç—É—Å | –ò—Å—Ç–æ—á–Ω–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è |
|---|---------|--------|------------------------|
| **10** | –û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –º–æ–¥–µ–ª–∏ | ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| **11** | –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏ | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏) |
| **12** | –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –≤ —Ä–∞–∑–Ω—ã—Ö —Å–ª–æ—è—Ö | üî¥ –ù–µ –Ω–∞–π–¥–µ–Ω–æ | Best practice (–ª–æ–≥–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ) |
| **13** | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π | ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è + —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏—á–∏–Ω—ã |
| **14** | –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö | ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ FLAME GPU |

---

## üîç –¢—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π MacroProperty

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ `FLAMEGPU2/include/flamegpu/runtime/environment/DeviceMacroProperty.cuh`
- –ö–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã: `.exchange()`, `.inc()`, `.dec()`, `.cas()`?

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
```bash
# –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ FLAMEGPU2:
grep -r "DeviceMacroProperty" include/flamegpu/runtime/environment/
grep -r "atomic" include/flamegpu/runtime/environment/DeviceMacroProperty.cuh
```

### 2. –Ø–≤–Ω—ã–π –∑–∞–ø—Ä–µ—Ç —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- GitHub Issues —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: "race condition", "same layer read write"
- Discussions –æ best practices –¥–ª—è MacroProperty

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
```
https://github.com/FLAMEGPU/FLAMEGPU2/issues?q=race+condition
https://github.com/FLAMEGPU/FLAMEGPU2/discussions
```

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –ü—Ä–∞–≤–∏–ª–æ 11: –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–¢–µ–∫—É—â–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞:**
> –ê–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å –≤ MacroProperty –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–£—Ç–æ—á–Ω—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞:**
> –ê–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å –≤ MacroProperty –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.
> 
> **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
> - `.add(value)` ‚Äî –∞—Ç–æ–º–∞—Ä–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ
> - `.sub(value)` ‚Äî –∞—Ç–æ–º–∞—Ä–Ω–æ–µ –≤—ã—á–∏—Ç–∞–Ω–∏–µ
> - `.min(value)` ‚Äî –∞—Ç–æ–º–∞—Ä–Ω—ã–π –º–∏–Ω–∏–º—É–º
> - `.max(value)` ‚Äî –∞—Ç–æ–º–∞—Ä–Ω—ã–π –º–∞–∫—Å–∏–º—É–º
>
> **–û–ø–µ—Ä–∞—Ü–∏–∏ –∏–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ (—Ç—Ä–µ–±—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ):**
> - `.exchange(value)` ‚Äî –∞—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–º–µ–Ω–∞
> - `.inc()` ‚Äî –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç –Ω–∞ 1
> - `.dec()` ‚Äî –¥–µ–∫—Ä–µ–º–µ–Ω—Ç –Ω–∞ 1
> - `.cas(compare, value)` ‚Äî compare-and-swap

### –ü—Ä–∞–≤–∏–ª–æ 12: –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ

**–¢–µ–∫—É—â–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞:**
> –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ MacroProperty –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –†–ê–ó–ù–´–• —Å–ª–æ—è—Ö

**–£—Ç–æ—á–Ω—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞:**
> **Best Practice:** –†–∞–∑–¥–µ–ª—è–π—Ç–µ —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –≤ MacroProperty –ø–æ —Ä–∞–∑–Ω—ã–º —Å–ª–æ—è–º.
>
> **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
> - –ò–∑–±–µ–∂–∞–Ω–∏–µ race conditions –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ
> - –ì–∞—Ä–∞–Ω—Ç–∏—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
> - –ë–∞—Ä—å–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π
>
> **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:** –ó–∞–ø–∏—Å—å –≤ —Ä–∞–∑–Ω—ã–µ —è—á–µ–π–∫–∏ –æ–¥–Ω–æ–π MacroProperty –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ –±–µ–∑–æ–ø–∞—Å–Ω–∞:
> ```cpp
> mask[agent.idx].add(1u);  // –ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç –ø–∏—à–µ—Ç –≤ —Å–≤–æ–π idx
> ```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ FLAMEGPU2
```
https://github.com/FLAMEGPU/FLAMEGPU2
‚îú‚îÄ‚îÄ include/flamegpu/runtime/environment/
‚îÇ   ‚îú‚îÄ‚îÄ DeviceMacroProperty.cuh    ‚Üê –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ EnvironmentManager.h       ‚Üê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Environment
‚îú‚îÄ‚îÄ src/flamegpu/model/
‚îÇ   ‚îî‚îÄ‚îÄ LayerDescription.cpp       ‚Üê –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å–ª–æ—ë–≤
‚îî‚îÄ‚îÄ examples/
    ‚îú‚îÄ‚îÄ game_of_life/              ‚Üê –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MacroProperty
    ‚îî‚îÄ‚îÄ circles_bruteforce/        ‚Üê –ü—Ä–∏–º–µ—Ä —Å messages
```

### 2. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **Macro Properties:** https://docs.flamegpu.com/guide/environment/macro-properties.html
- **Agent Functions:** https://docs.flamegpu.com/guide/agent-functions/
- **Layers:** https://docs.flamegpu.com/guide/agent-functions/modelling-behaviour.html#layers

### 3. Community
- **GitHub Discussions:** https://github.com/FLAMEGPU/FLAMEGPU2/discussions
- **Issues:** https://github.com/FLAMEGPU/FLAMEGPU2/issues

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–µ –≤—ã–≤–æ–¥—ã

### –ü–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ (3 –∏–∑ 5)
1. ‚úÖ **–û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ
2. ‚úÖ **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Å—Å–∏–≤–æ–≤** ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. ‚úÖ **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ

### –¢—Ä–µ–±—É—é—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è (2 –∏–∑ 5)
1. ‚ö†Ô∏è **–ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** ‚Äî —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ
2. üî¥ **–ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –≤ —Å–ª–æ–µ** ‚Äî best practice, –Ω–µ –∂—ë—Å—Ç–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ API

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –ø—Ä–∞–≤–∏–ª 11 –∏ 12 –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ
2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–º–µ—Ç–∫—É "Best Practice" –¥–ª—è –ø—Ä–∞–≤–∏–ª–∞ 12
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ FLAMEGPU2 –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

**–ê–≤—Ç–æ—Ä:** AI Agent (Cursor)  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è –ø—Ä–∞–≤–∏–ª 11-12







