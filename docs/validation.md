# Validation (V2)

## –°–≤—è–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–∏–ª**: `.cursorrules` (–∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: `docs/rtc_pipeline_architecture.md`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤**: `docs/rtc_components.md`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–ª–µ–∫—Ç–Ω–æ—Å—Ç–∏**: `docs/completeness_check.md` ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–ª–æ—è
- **–ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞**: `docs/README.md`
- **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π**: `docs/changelog.md`

## –ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 13.10.2025)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–£–ë–î > –õ–æ–≥–∏
- ‚úÖ **–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å**: –ò—Ç–æ–≥–æ–≤–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ –≤ –°–£–ë–î —á–µ—Ä–µ–∑ MP2
- ‚ö†Ô∏è **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ**: –¢–æ–ª—å–∫–æ –ø–æ —è–≤–Ω–æ–º—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—é
- üßπ **–û—á–∏—Å—Ç–∫–∞**: –ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è + –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –≤ –°–£–ë–î –ë–ï–ó –∏–∑–±—ã—Ç–æ—á–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –†–∏—Å–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ RTC —è–¥—Ä–∞—Ö
- Race conditions (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –æ—Ç —Ç—ã—Å—è—á –ø–æ—Ç–æ–∫–æ–≤)
- –°–±–æ–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ NVRTC
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è FLAME GPU
- –ü–∞–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (10-100x)

### ‚ö†Ô∏è JIT –∫–æ–º–ø–∏–ª—è—Ü–∏—è: Warning'–∏ –ó–ê–ü–†–ï–©–ï–ù–´ (–¥–æ–±–∞–≤–ª–µ–Ω–æ 02-12-2025)

**–ü—Ä–∞–≤–∏–ª–æ:** –ù–∏–∫–∞–∫–∏–µ warning'–∏ –≤ JIT –ª–æ–≥–µ NVRTC –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ù–ï –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è!

**–ü—Ä–∏—á–∏–Ω—ã:**
- Warning'–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –∑–∞–º–µ–¥–ª—è—é—Ç JIT –∫–æ–º–ø–∏–ª—è—Ü–∏—é (–¥–æ 5-10x)
- –£–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∏–∫–µ RTC –∫–æ–¥–∞
- –ú–æ–≥—É—Ç –º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–¢–∏–ø–∏—á–Ω—ã–µ warning'–∏ –∏ —Ä–µ—à–µ–Ω–∏—è:**

| Warning | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|---------|---------|---------|
| `#117-D: non-void function should return a value` | `return;` –≤–º–µ—Å—Ç–æ `return flamegpu::ALIVE;` | –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `return;` –Ω–∞ `return flamegpu::ALIVE;` |
| `#177-D: variable was declared but never referenced` | –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é |

**–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏:**
1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ RTC
2. –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —è–¥–µ—Ä (–∏–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é: `rm -rf .rtc_cache/*`)
3. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ü–∏—é –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å JIT –ª–æ–≥

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:**
> ‚ö†Ô∏è **–ü—Ä–∏ –ö–ê–ñ–î–û–ô –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —è–¥–µ—Ä –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å JIT –ª–æ–≥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ warning'–æ–≤!**
> –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ RTC –∫–æ–¥–∞.

## –û–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–π (–∞–∫—Ç—É–∞–ª—å–Ω–æ 16-01-2026)

```bash
cd /media/albud/8C327EB0327E9F40/Projects/Heli/Helicomponents-messaging
source .venv/bin/activate
# –ï—Å–ª–∏ .venv –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å conda:
source ~/miniconda3/etc/profile.d/conda.sh
conda activate cuda13
source config/load_env.sh
export CUBE_CONFIG_PATH="$PWD/config"
```

## LIMITER V8: —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (16-01-2026)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** —á–∏—Å—Ç—ã–π –ø—Ä–æ–≥–æ–Ω `orchestrator_limiter_v8.py` —Å `--enable-mp2 --drop-table`,  
—Ç–∞–±–ª–∏—Ü–∞ `sim_masterv2_v8`, –¥–∞—Ç–∞—Å–µ—Ç `2025-07-04`.

### 1) Ops vs Target (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —à–∞–≥–∏)
- –í—Å–µ–≥–æ —à–∞–≥–æ–≤: **268**
- –ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: **219**
  - Mi-8: 149 –¥–Ω–µ–π
  - Mi-17: 202 –¥–Ω—è

**–ü—Ä–∏–º–µ—Ä:**
- –î–µ–Ω—å 181: Mi-8 68/42 (Œî=+26), Mi-17 89/88 (Œî=+1)
- –î–µ–Ω—å 3649: Mi-17 129/127 (Œî=+2)

### 2) –ù–∞–ª—ë—Ç –∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (delta_sne)
**–°–≤–æ–¥–∫–∞:**
- Œîsne total = **56,689,881**
- Œ£delta_sne (ops intervals) = **56,681,985**
- Œ£delta_sne (non-ops intervals) = **7,896**  ‚Üê –Ω–∞–ª—ë—Ç –≤–Ω–µ operations
- Œ£program (ops intervals) = **53,588,287**

**–°—á—ë—Ç—á–∏–∫–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–π:**
- non-ops with delta_sne ‚â† 0: **6**
- ops delta_sne ‚â† program: **39,870**
- program=0 but delta_sne>0: **2,546**
- program>0 but delta_sne=0: **260**

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ù–∞–ª—ë—Ç –≤–Ω–µ ops: AC 100000..100005, prev_state='reserve', 103‚Üí120, delta_sne=1316
- Ops delta_sne=0 –ø—Ä–∏ program=459: AC 22171..22610, –∏–Ω—Ç–µ—Ä–≤–∞–ª 0‚Üí3

## –í–∞–ª–∏–¥–∞—Ü–∏—è MESSAGING (–ª–∏–º–∏—Ç–µ—Ä –±–µ–∑ dt)

–°–∫—Ä–∏–ø—Ç `code/analysis/sim_validation_runner_msg.py` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ `dt` (–Ω–∞–ø—Ä–∏–º–µ—Ä `sim_masterv2_v8`):  
–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã —Å—á–∏—Ç–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `delta_sne` –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é, –∞ –∞–≥—Ä–µ–≥–∞—Ç—ã ‚Äî —á–µ—Ä–µ–∑ —Å—É–º–º—É `delta_sne` –≤ ops‚Äë–∏–Ω—Ç–µ—Ä–≤–∞–ª–∞—Ö.

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (02-12-2025):**
- –ë—ã–ª–æ: 10-20 –º–∏–Ω –ø–µ—Ä–≤–∏—á–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è —Å warning'–∞–º–∏
- –°—Ç–∞–ª–æ: ~3 –º–∏–Ω –∫–æ–º–ø–∏–ª—è—Ü–∏—è –±–µ–∑ warning'–æ–≤

### –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –ø–æ—ç—Ç–∞–ø–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π –ø–æ –æ–¥–Ω–æ–º—É
- –ü—Ä–æ–≥–æ–Ω –Ω–∞ 3650 –¥–Ω–µ–π (–≤—Å–µ —è–¥—Ä–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã)
- SQL-–ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤ –°–£–ë–î
- –ò–∑—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Üí –≥–∏–ø–æ—Ç–µ–∑–∞ ‚Üí —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ ‚Üí –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞

## –°—Ç–∞—Ç—É—Å—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

- Status 2 (—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è)
  - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã: sne += dt, ppr += dt, –≥–¥–µ dt = mp5(day, idx).
  - –ü—Ä–æ–≥–Ω–æ–∑: s_next = sne + dn, p_next = ppr + dn.
  - –ü–µ—Ä–µ—Ö–æ–¥—ã:
    - 2‚Üí6 –ø—Ä–∏ s_next >= ll (LL –ø–æ—Ä–æ–≥), s6_days=0, s6_started=1.
    - 2‚Üí4 –ø—Ä–∏ p_next >= oh –∏ s_next < br (BR/repair –≤–µ—Ç–∫–∞).

- Status 4 (—Ä–µ–º–æ–Ω—Ç)
  - repair_days —Ä–∞—Å—Ç—ë—Ç –¥–æ repair_time.
  - –ü–µ—Ä–µ—Ö–æ–¥ 4‚Üí5 –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ repair_days >= repair_time.
  - assembly_time –≤–ª–∏—è–µ—Ç –Ω–∞ –º–∞—Ä–∫–µ—Ä —Å–±–æ—Ä–∫–∏ (–ø–ª–∞–Ω–æ–≤–æ D‚Äëassembly_time –¥–æ –∫–æ–Ω—Ü–∞ —Ä–µ–º–æ–Ω—Ç–∞).

- Status 6 (—Ö—Ä–∞–Ω–µ–Ω–∏–µ)
  - ¬´–í–µ—á–Ω—ã–π¬ª: –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è, s6_days —Ä–∞—Å—Ç—ë—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ s6_started=1.

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è smoke

- –ò—Ç–æ–≥–æ–≤—ã–µ —Å—á—ë—Ç—á–∏–∫–∏ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º: s2/s4/s6.
- –í—ã–±–æ—Ä–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–æ—Ä—Ç–æ–≤: (idx, status, sne, ppr, ll, oh, dt, dn).
- –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ idx –ø–æ –¥–Ω—è–º: (day, idx, dt, dn, sne, ppr, status).

## –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

- MP5: –ª–∏–Ω–µ–π–Ω—ã–π –º–∞—Å—Å–∏–≤ (DAYS+1)*FRAMES —Å –ø–∞–¥–¥–∏–Ω–≥–æ–º, MacroProperty mp5_lin.
- MP3 –ø–æ—Ä–æ–≥–∏: ll, oh, br ‚Äî —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –ø–æ frames_index.
- MP1 –Ω–æ—Ä–º—ã: `mp1_br_*`, `mp1_oh_*`, `mp1_ll_mi17`, `mp1_second_ll` (UInt32, –º–∏–Ω—É—Ç—ã) ‚Äî –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `sim_env_setup`, –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ `partseqno_i` –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∞–≥–µ–Ω—Ç–∞–º –∫–∞–∫ `ll`/`second_ll`. –ü—É—Å—Ç—ã–µ `second_ll` –ø–æ–ª—É—á–∞—é—Ç sentinel `0xFFFFFFFF`, —á—Ç–æ–±—ã RTC —Ä–∞–∑–ª–∏—á–∞–ª–∏ NULL –∏ —Ä–µ–∞–ª—å–Ω—ã–π 0.

## –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

- –î–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç DAYS/FRAMES.
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è row = day*FRAMES + idx; row_next = row + FRAMES.
- –¢–∏–ø—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã: UInt32 –¥–ª—è MP5 –∏ –∞–≥–µ–Ω—Ç–Ω—ã—Ö –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–µ–π.
- **heli_pandas (–∞–≥—Ä–µ–≥–∞—Ç—ã –Ω–∞ –í–° –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏)**: –¥–ª—è —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ `heli_pandas` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞  
  `SELECT count() FROM heli_pandas WHERE version_date=? AND version_id=? AND aircraft_number>0 AND group_by>2 AND upperUTF8(replaceRegexpAll(ifNull(condition,''), '^\\s+|\\s+$', ''))='–ò–°–ü–†–ê–í–ù–´–ô' AND status_id NOT IN (2, 3)`.  
  –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî `0`. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏:
  - `heli_pandas_component_status.py` ‚Äî —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `status_id=2` –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –Ω–∞ –í–° –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
  - `heli_pandas_serviceable_status.py` ‚Äî —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `status_id=3` –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–Ω—ã—Ö –∞–≥—Ä–µ–≥–∞—Ç–æ–≤

## –ü—Ä–∞–≤–∏–ª–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–≥–æ)

- –í—Å–µ —Ç–µ—Å—Ç—ã/–ø—Ä–æ–≥–æ–Ω—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¢–û–õ–¨–ö–û –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ ClickHouse.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö/–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∑–∞–≥–ª—É—à–µ–∫ –∏–ª–∏ —Ä—É—á–Ω—ã—Ö –ø–æ–¥–º–µ–Ω ‚Äî –∑–∞–ø—Ä–µ—â–µ–Ω–æ –±–µ–∑ —è–≤–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ (–ê–ª–µ–∫—Å–µ—è) –≤ —Ç–µ–∫—É—â–µ–º —á–∞—Ç–µ.
- –õ—é–±—ã–µ –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ c —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã –∏ —Å—Ä–æ–∫–æ–º –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º.

## V2 State-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–¥–æ–±–∞–≤–ª–µ–Ω–æ 25-09-2025)

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 28-09-2025)

**–ü—Ä–æ–≥–æ–Ω –Ω–∞ 3650 –¥–Ω–µ–π (10 –ª–µ—Ç):**
- –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 154 operations, 7 repair, 118 inactive
- –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 2 operations, 97 repair, 62 storage, 118 inactive
- –ü–µ—Ä–µ—Ö–æ–¥—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã: repair –ø—Ä–∏ `ppr_next >= oh AND sne_next < br`, storage –ø—Ä–∏ `sne_next >= ll` (–∏–ª–∏ BR –≤–µ—Ç–∫–∞)
- –î–≤–∞ –∞–≥–µ–Ω—Ç–∞ –æ—Å—Ç–∞–ª–∏—Å—å –≤ operations –∏–∑-–∑–∞ –Ω–∏–∑–∫–æ–≥–æ —Å—É—Ç–æ—á–Ω–æ–≥–æ –Ω–∞–ª–µ—Ç–∞ (dt=2 –∏ dt=29)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å MP2): ~17.2–º—Å/—à–∞–≥, GPU 62.81—Å, DB 31.59—Å, –≤—Å–µ–≥–æ 67.26—Å
- MP2 —ç–∫—Å–ø–æ—Ä—Ç: —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –¥—Ä–µ–Ω–∞–∂, 5 flush –ø–æ 250k, ~1.018M —Å—Ç—Ä–æ–∫; –∫–æ–ª–æ–Ω–Ω–∞—Ä–Ω—ã–µ INSERT; `day_date` ‚Äî MATERIALIZED

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **Intent –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω**: `intent_state != 0` –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ –≤—Å–µ—Ö —à–∞–≥–∞—Ö
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–æ–≤**: –ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ —Ç–æ–ª—å–∫–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤ intent_state
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤**: –ó–∞ –æ–¥–∏–Ω —à–∞–≥ –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –º–∞–∫—Å–∏–º—É–º –æ–¥–∏–Ω —Ä–∞–∑

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã MP5 –≤ V2
- **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è**: `base = step_day * MAX_FRAMES + idx` (–Ω–µ `idx * (MAX_DAYS + 1) + step_day`)
- **–†–∞–∑–º–µ—Ä**: `mp5_lin` —Å–æ–¥–µ—Ä–∂–∏—Ç `(MAX_DAYS + 1) * MAX_FRAMES` —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **Read-only –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**: MP5 –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è RTC —Ñ—É–Ω–∫—Ü–∏—è–º–∏

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω–æ 13.10.2025)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–í–ï–†–ï–ù–û - –¥—É–±–ª–∏—Ä—É—é—â–µ–π –ª–æ–≥–∏–∫–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

#### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã

**assembly_trigger** (—Ç—Ä–∏–≥–≥–µ—Ä —Å–±–æ—Ä–∫–∏):
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (agent_population.py): —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∞–≥–µ–Ω—Ç–æ–≤ –≤ status=4
- ‚úÖ –í operations (rtc_state_2_operations.py): –≤—Å–µ–≥–¥–∞ =1 (–∞–≥–µ–Ω—Ç —Å–æ–±—Ä–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ –í repair (rtc_states_stub.py): =1 –∫–æ–≥–¥–∞ repair_days >= repair_time - assembly_time
- ‚úÖ –°–±—Ä–æ—Å: –ø—Ä–∏ spawn –∏ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ repair‚Üíreserve (5 –º–æ–¥—É–ª–µ–π state_manager)
- üìã –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã –ù–ï –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç

**active_trigger** (—Ç—Ä–∏–≥–≥–µ—Ä –∞–∫—Ç–∏–≤–∞—Ü–∏–∏):
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ 1: –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ inactive ‚Üí operations (`rtc_apply_1_to_2`)
- ‚úÖ –°–±—Ä–æ—Å –≤ 0: –≤ rtc_state_2_operations.py (–ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞ –≤ operations)
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: =0 –ø—Ä–∏ spawn
- ‚úÖ –ü–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥: `mp2_postprocess_active` –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Ä–µ–º–æ–Ω—Ç–∞ –ø–æ active_trigger=1
- üìã –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç

**partout_trigger** (—Ç—Ä–∏–≥–≥–µ—Ä —Å–ø–∏—Å–∞–Ω–∏—è):
- ‚è≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ 1: –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ (–º–æ–¥—É–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã)
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: =0 –ø—Ä–∏ spawn
- üìã –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç

### –í–∞–ª–∏–¥–∞—Ü–∏—è PPR –ø—Ä–∏ inactive ‚Üí operations (–¥–æ–±–∞–≤–ª–µ–Ω–æ 01-12-2025)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–í–ï–†–ï–ù–û - PPR –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–∏–ø—É –í–°

#### –õ–æ–≥–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º

| –¢–∏–ø | group_by | –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ 1‚Üí2 | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|-----|----------|------------------|-------------|
| **Mi-8** | 1 | PPR = 0 | –†–µ–∞–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç –ø–ª–∞–Ω–µ—Ä–∞ |
| **Mi-17** | 2 | PPR —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è (–Ω–µ —Ä–µ–º–æ–Ω—Ç –ø–ª–∞–Ω–µ—Ä–∞) |

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- **–§–∞–π–ª:** `rtc_state_manager_operations.py`, —Ñ—É–Ω–∫—Ü–∏—è `rtc_apply_1_to_2`
- **–õ–æ–≥–∏–∫–∞:**
  ```cpp
  if (group_by == 1u) {
      FLAMEGPU->setVariable<unsigned int>("ppr", 0u);
  }
  // Mi-17 (group_by=2): PPR –Ω–µ —Ç—Ä–æ–≥–∞–µ–º
  ```

#### –¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (01-12-2025)
- **AC 22216 (Mi-17):** –î–µ–Ω—å 299 PPR=269,168 ‚Üí –î–µ–Ω—å 300 PPR=269,168 ‚úÖ
- **–í—Å–µ 23 Mi-17 –∏–∑ inactive:** PPR —Å–æ—Ö—Ä–∞–Ω—ë–Ω
- **Mi-8 –≤ inactive:** –ù–µ –≤—ã—Ö–æ–¥—è—Ç (–ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–Ω–∏–∂–∞–µ—Ç—Å—è, –Ω–µ—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞)

#### –ü–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥
- **–§–ª–∞–≥:** `--enable-mp2-postprocess` (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** transition_1_to_4=23, transition_4_to_2=23
- **–ò—Å—Ç–æ—Ä–∏—è:** –î–µ–Ω—å –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç state=repair (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è)

#### –°–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å state_manager –º–æ–¥—É–ª–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É active_trigger=1
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å quota –º–æ–¥—É–ª–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É partout_trigger=1
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∏–∑ operations (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 13.10.2025)

**–°—Ç–∞—Ç—É—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏:** ‚úÖ –ü–†–û–í–ï–†–ï–ù–û –Ω–∞ 3650 –¥–Ω–µ–π, –≤—Å–µ 152 –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ

#### –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫**: LL ‚Üí OH+BR ‚Üí –æ—Å—Ç–∞–µ–º—Å—è –≤ operations
- **–£—Å–ª–æ–≤–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ repair (intent=4)**: `ppr_next >= oh AND sne_next < br`
- **–£—Å–ª–æ–≤–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ storage (intent=6)**: `sne_next >= ll OR (ppr_next >= oh AND sne_next >= br)`
- **–†–∞—Å—á–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑–∞**: `s_next = sne + dt + dn`, `p_next = ppr + dt + dn`

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–ü–µ—Ä–µ—Ö–æ–¥–æ–≤ 2‚Üí4 (repair):** 134 —Å–ª—É—á–∞—è (52 Mi-8 + 82 Mi-17)
  - –í—Å–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É—Å–ª–æ–≤–∏—é `ppr_next >= oh AND sne_next < br` ‚úÖ
  - –ü–µ—Ä–µ—Ö–æ–¥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¢–û–ß–ù–û –≤ –º–æ–º–µ–Ω—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è `oh` (270,000 –º–∏–Ω—É—Ç)
  
- **–ü–µ—Ä–µ—Ö–æ–¥–æ–≤ 2‚Üí6 (storage):** 18 —Å–ª—É—á–∞–µ–≤ (14 Mi-8 + 4 Mi-17)
  - –ü–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é LL: 5 —Å–ª—É—á–∞–µ–≤ ‚úÖ
  - –ü–æ —É—Å–ª–æ–≤–∏—é BR (—Ä–µ–º–æ–Ω—Ç –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–µ–Ω): 13 —Å–ª—É—á–∞–µ–≤ ‚úÖ
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø–∞—Å –¥–æ LL –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ BR: 7,566 –º–∏–Ω—É—Ç (idx=82, Mi-17)
  
- **–ê–≥–µ–Ω—Ç–æ–≤ –±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:** 127 (–Ω–∏–∑–∫–∏–π –Ω–∞–ª—ë—Ç, –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∏ –ø–æ—Ä–æ–≥–æ–≤ –∑–∞ 10 –ª–µ—Ç)

#### Side effects –ø—Ä–∏ operations
- –ï—Å–ª–∏ active_trigger=1 ‚Üí —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ 0
- –ï—Å–ª–∏ assembly_trigger=0 ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤ 1
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ 2‚Üí4: ppr —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 0
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ 2‚Üí6: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è s6_started = step_day

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
- ‚ö†Ô∏è –ê–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ `state='operations'` –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ intent=4/6
- ‚ö†Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∞—é—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å sne/ppr (–Ω–µ—Ç state_manager –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤)
- ‚ö†Ô∏è –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ LL: Mi-8 –¥–æ 2,086,328 –ø—Ä–∏ ll=1,800,000 (+286k –º–∏–Ω—É—Ç)
- ‚úÖ –≠—Ç–æ **–æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è

**–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç:** `docs/validation_stage1_state2ops_13-10-2025.md`

---

### –í–∞–ª–∏–¥–∞—Ü–∏—è states_stub ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ intent (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 14.10.2025)

**–°—Ç–∞—Ç—É—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏:** ‚úÖ –ü–†–û–í–ï–†–ï–ù–û –Ω–∞ 3650 –¥–Ω–µ–π

#### –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ú–æ–¥—É–ª—å:** rtc_states_stub.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ intent_state –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö inactive, serviceable, repair, reserve, storage
**–ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** –ü–û–°–õ–ï state_2_operations (—á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –µ–≥–æ intent)

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:**
1. state_1 (inactive) ‚Äî "–ñ–µ–ª–µ–∑–Ω—ã–π —Ä—è–¥"
2. state_3 (serviceable) ‚Äî –ò—Å–ø—Ä–∞–≤–Ω—ã–µ, –≥–æ—Ç–æ–≤—ã–µ –∫ —Ä–∞–±–æ—Ç–µ
3. state_4 (repair) ‚Äî –í —Ä–µ–º–æ–Ω—Ç–µ
4. state_5 (reserve) ‚Äî –†–µ–∑–µ—Ä–≤ –ø–æ—Å–ª–µ —Ä–µ–º–æ–Ω—Ç–∞
5. state_6 (storage) ‚Äî –•—Ä–∞–Ω–µ–Ω–∏–µ/—É—Ç–∏–ª–∏–∑–∞—Ü–∏—è

#### –ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º

**1. state_1 (inactive) ‚Äî "–ñ–µ–ª–µ–∑–Ω—ã–π —Ä—è–¥"**

–õ–æ–≥–∏–∫–∞:
- –ê–≥–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (intent=2) —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ step_day >= repair_time
- –î–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –∞–≥–µ–Ω—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –≤ "–∂–µ–ª–µ–∑–Ω–æ–º —Ä—è–¥—É" (intent=1)
- –£—Å–ª–æ–≤–∏–µ: if (step_day >= repair_time) ‚Üí intent=2, else ‚Üí intent=1

–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:
- ‚úÖ intent=1 –¥–ª—è –≤—Å–µ—Ö –¥–Ω–µ–π 0 <= step_day < repair_time
- ‚úÖ intent=2 –¥–ª—è –≤—Å–µ—Ö –¥–Ω–µ–π step_day >= repair_time
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–æ–≤–Ω–æ –Ω–∞ day = repair_time (–Ω–µ —Ä–∞–Ω—å—à–µ, –Ω–µ –ø–æ–∑–∂–µ)
- ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –∑–Ω–∞—á–µ–Ω–∏–µ intent –Ω–µ —Ñ–ª—É–∫—Ç—É–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (3650 –¥–Ω–µ–π, 118 –∞–≥–µ–Ω—Ç–æ–≤, repair_time=180):
- ‚úÖ Days 0-179: –≤—Å–µ 118 –∞–≥–µ–Ω—Ç–æ–≤ —Å intent=1
- ‚úÖ Days 180-3649: –≤—Å–µ 118 –∞–≥–µ–Ω—Ç–æ–≤ —Å intent=2
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ —Ç–æ—á–Ω–æ –Ω–∞ day 180

SQL-–ø—Ä–æ–≤–µ—Ä–∫–∏:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ –ø–æ—Ä–æ–≥–∞
SELECT COUNT(DISTINCT ac) FROM sim_masterv2 
WHERE step_day < 180 AND state = 'inactive' AND intent_state != 1;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–æ—Ä–æ–≥–∞
SELECT COUNT(DISTINCT ac) FROM sim_masterv2 
WHERE step_day >= 180 AND state = 'inactive' AND intent_state != 2;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

**2. state_3 (serviceable) ‚Äî –ò—Å–ø—Ä–∞–≤–Ω—ã–µ**

–õ–æ–≥–∏–∫–∞:
- –ê–≥–µ–Ω—Ç—ã –í–°–ï–ì–î–ê –∏–º–µ—é—Ç intent=2 (—Å—Ç—Ä–µ–º—è—Ç—Å—è –≤ operations)
- –ù–µ—Ç —É—Å–ª–æ–≤–∏–π, –Ω–µ—Ç —Å—á–µ—Ç—á–∏–∫–æ–≤, –Ω–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤

–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:
- ‚úÖ intent=2 –Ω–∞ –≤—Å–µ—Ö —à–∞–≥–∞—Ö —Å–∏–º—É–ª—è—Ü–∏–∏ (day 0 - day 3649)
- ‚úÖ –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

SQL-–ø—Ä–æ–≤–µ—Ä–∫–∞:
```sql
SELECT COUNT(*) FROM sim_masterv2 
WHERE state = 'serviceable' AND intent_state != 2;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

**3. state_4 (repair) ‚Äî –í —Ä–µ–º–æ–Ω—Ç–µ**

–õ–æ–≥–∏–∫–∞:
- repair_days –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å (–Ω–∞—á–∏–Ω–∞—è —Å day 1)
- assembly_trigger —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 1 —Ä–æ–≤–Ω–æ –Ω–∞ 1 –¥–µ–Ω—å, –∫–æ–≥–¥–∞ repair_days == (repair_time - assembly_time)
- assembly_trigger –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 0 –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
- –ü—Ä–∏ repair_days == repair_time: intent=5, ppr‚Üí0, repair_days‚Üí0

–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:

1. –°—á–µ—Ç—á–∏–∫ repair_days:
   - ‚úÖ repair_days <= repair_time (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç)
   - ‚úÖ repair_days —Ä–∞—Å—Ç–µ—Ç –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ: +1 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ state=repair
   - ‚úÖ repair_days —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 0 –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ repair_time

2. –¢—Ä–∏–≥–≥–µ—Ä assembly_trigger:
   - ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 1 —Ä–æ–≤–Ω–æ –û–î–ò–ù –†–ê–ó –∑–∞ —Ü–∏–∫–ª —Ä–µ–º–æ–Ω—Ç–∞
   - ‚úÖ "–ñ–∏–≤–µ—Ç" —Ç–æ–ª—å–∫–æ 1 –¥–µ–Ω—å (–¥–µ–Ω—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
   - ‚úÖ –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ –ø–æ—Ä–æ–≥–µ: repair_days == (repair_time - assembly_time)
   - ‚úÖ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã –Ω–µ –º–µ–Ω—è—é—Ç –ª–æ–≥–∏–∫—É

3. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–º–æ–Ω—Ç–∞:
   - ‚úÖ –ü—Ä–∏ repair_days == repair_time ‚Üí intent=5 (—Ä–µ–∑–µ—Ä–≤)
   - ‚úÖ –°–±—Ä–æ—Å ppr‚Üí0 (–Ω–æ–≤—ã–π –º–µ–∂—Ä–µ–º–æ–Ω—Ç–Ω—ã–π —Ü–∏–∫–ª)
   - ‚úÖ –°–±—Ä–æ—Å repair_days‚Üí0 (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ü–∏–∫–ª—É)

4. –¶–∏–∫–ª–∏—á–Ω–æ—Å—Ç—å (–±–µ–∑ state_manager):
   - ‚úÖ –ï—Å–ª–∏ state –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è, –∞–≥–µ–Ω—Ç –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ü–∏–∫–ª: rd 0‚Üí180‚Üí0‚Üí180...
   - ‚úÖ –≠—Ç–æ –û–ñ–ò–î–ê–ï–ú–û–ï –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (3650 –¥–Ω–µ–π, 7 –∞–≥–µ–Ω—Ç–æ–≤, repair_time=180, assembly_time=30):

Day 0 (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ MP3):
- ‚úÖ AC 22431: repair_days=157, days_left=23 < 30 ‚Üí assembly_trigger=1
- ‚úÖ AC 22215: repair_days=117, days_left=63 > 30 ‚Üí assembly_trigger=0

–¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ (7 –∞–≥–µ–Ω—Ç–æ–≤ √ó 3650 –¥–Ω–µ–π):
- ‚úÖ 20 –ø–æ–ª–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ —Ä–µ–º–æ–Ω—Ç–∞ –∑–∞ 3650 –¥–Ω–µ–π
- ‚úÖ 20 —Å–±—Ä–æ—Å–æ–≤ repair_days‚Üí0 (–ø–æ 1 –Ω–∞ —Ü–∏–∫–ª –Ω–∞ –∞–≥–µ–Ω—Ç–∞)
- ‚úÖ 147 —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π assembly_trigger (7 –∞–≥–µ–Ω—Ç–æ–≤ √ó 21 —Ä–∞–∑)
  - 7 –Ω–∞ day 0 (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ MP3)
  - 140 –≤ —Ü–∏–∫–ª–∞—Ö (7 –∞–≥–µ–Ω—Ç–æ–≤ √ó 20 —Ü–∏–∫–ª–æ–≤)

SQL-–ø—Ä–æ–≤–µ—Ä–∫–∏:
```sql
-- 1. repair_days –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç repair_time
SELECT COUNT(*) FROM sim_masterv2 
WHERE state = 'repair' AND repair_days > repair_time;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0

-- 2. assembly_trigger —Ç–æ–ª—å–∫–æ 0 –∏–ª–∏ 1
SELECT COUNT(*) FROM sim_masterv2 
WHERE state = 'repair' AND assembly_trigger NOT IN (0, 1);
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0

-- 3. assembly_trigger=1 –Ω–∞ –ø–æ—Ä–æ–≥–µ
SELECT ac, step_day, repair_days, repair_time, assembly_time
FROM sim_masterv2 
WHERE state = 'repair' AND assembly_trigger = 1
  AND repair_days != (repair_time - assembly_time);
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø—É—Å—Ç–æ (–∏–ª–∏ —Ç–æ–ª—å–∫–æ day 0 —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏)

-- 4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π assembly_trigger
SELECT COUNT(*) FROM sim_masterv2 
WHERE state = 'repair' AND assembly_trigger = 1;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: ~147 (–¥–ª—è 7 –∞–≥–µ–Ω—Ç–æ–≤ –∑–∞ 3650 –¥–Ω–µ–π)

-- 5. –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
SELECT ac, step_day, repair_days, ppr 
FROM sim_masterv2 
WHERE state = 'repair' AND repair_days = 0 AND step_day > 0;
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: —ç—Ç–æ –¥–Ω–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ repair_days==repair_time
```

**4. state_5 (reserve) ‚Äî –†–µ–∑–µ—Ä–≤**

–õ–æ–≥–∏–∫–∞:
- –ê–≥–µ–Ω—Ç—ã –í–°–ï–ì–î–ê –∏–º–µ—é—Ç intent=2 (—Å—Ç—Ä–µ–º—è—Ç—Å—è –≤ operations)
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç P2 –≤ –∫–∞—Å–∫–∞–¥–Ω–æ–º –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (–Ω–∏–∂–µ serviceable)
- –ù–µ—Ç —É—Å–ª–æ–≤–∏–π, –Ω–µ—Ç —Å—á–µ—Ç—á–∏–∫–æ–≤, –Ω–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤

–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:
- ‚úÖ intent=2 –Ω–∞ –≤—Å–µ—Ö —à–∞–≥–∞—Ö —Å–∏–º—É–ª—è—Ü–∏–∏
- ‚úÖ –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

SQL-–ø—Ä–æ–≤–µ—Ä–∫–∞:
```sql
SELECT COUNT(*) FROM sim_masterv2 
WHERE state = 'reserve' AND intent_state != 2;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

**5. state_6 (storage) ‚Äî –•—Ä–∞–Ω–µ–Ω–∏–µ**

–õ–æ–≥–∏–∫–∞:
- –ê–≥–µ–Ω—Ç—ã –í–°–ï–ì–î–ê –∏–º–µ—é—Ç intent=6 (–æ—Å—Ç–∞—é—Ç—Å—è –≤ storage)
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ù–ï–ò–ó–ú–ï–ù–Ø–ï–ú–û–ï (S6 immutable)
- –ê–≥–µ–Ω—Ç—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç storage

–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:
- ‚úÖ intent=6 –Ω–∞ –≤—Å–µ—Ö —à–∞–≥–∞—Ö —Å–∏–º—É–ª—è—Ü–∏–∏
- ‚úÖ S6 immutable: –∞–≥–µ–Ω—Ç, –ø–æ–ø–∞–≤—à–∏–π –≤ storage, –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–º –Ω–∞–≤—Å–µ–≥–¥–∞
- ‚úÖ –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∏–∑ storage –≤ –¥—Ä—É–≥–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

SQL-–ø—Ä–æ–≤–µ—Ä–∫–∏:
```sql
-- 1. intent –≤—Å–µ–≥–¥–∞ 6
SELECT COUNT(*) FROM sim_masterv2 
WHERE state = 'storage' AND intent_state != 6;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0

-- 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ S6 immutable (–∞–≥–µ–Ω—Ç –Ω–µ –ø–æ–∫–∏–¥–∞–µ—Ç storage)
WITH storage_entries AS (
  SELECT ac, MIN(step_day) AS first_storage_day
  FROM sim_masterv2 
  WHERE state = 'storage'
  GROUP BY ac
)
SELECT s.ac, s.first_storage_day, m.step_day, m.state
FROM storage_entries s
JOIN sim_masterv2 m ON s.ac = m.ac
WHERE m.step_day >= s.first_storage_day AND m.state != 'storage';
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø—É—Å—Ç–æ (–Ω–µ—Ç –≤—ã—Ö–æ–¥–æ–≤ –∏–∑ storage)
```

#### –û–±—â–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã states_stub

1. **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å intent:**
   - intent_state —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∑–∞–Ω–æ–≤–æ
   - –ó–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ intent (–∫—Ä–æ–º–µ –ª–æ–≥–∏–∫–∏ —Å–∞–º–æ–≥–æ –º–æ–¥—É–ª—è)

2. **Day 0 –±–µ–∑ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–≤:**
   - –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ MP3 –Ω–µ –∏—Å–∫–∞–∂–∞—é—Ç—Å—è
   - –¢–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ intent (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)

3. **–ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
   - states_stub –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ü–û–°–õ–ï state_2_operations
   - –ù–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç intent –¥–ª—è state=operations

4. **–ú–∏–Ω–∏–º–∞–ª–∏–∑–º –æ–ø–µ—Ä–∞—Ü–∏–π:**
   - MP5 –ù–ï —á–∏—Ç–∞–µ—Ç—Å—è –≤ states_stub (—Ç–æ–ª—å–∫–æ –≤ state_2_operations)
   - daily_today_u32/daily_next_u32 –∞–∫—Ç—É–∞–ª—å–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è operations
   - –ò–∑–±–µ–∂–∞–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è –∏–∑ GPU –ø–∞–º—è—Ç–∏

5. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:**
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã —Å –æ–¥–Ω–∏–º —Å–Ω–∞–ø—à–æ—Ç–æ–º –¥–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤

#### –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

1. **–ü—Ä–æ–≥–æ–Ω —Å–∏–º—É–ª—è—Ü–∏–∏:**
   - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 3650 –¥–Ω–µ–π (10 –ª–µ—Ç)
   - –ú–æ–¥—É–ª–∏: state_2_operations + states_stub
   - –≠–∫—Å–ø–æ—Ä—Ç: –≤ –°–£–ë–î —á–µ—Ä–µ–∑ MP2 (device-side export)

2. **SQL-–ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:**
   - –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¢–û–õ–¨–ö–û –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –°–£–ë–î
   - –ù–∏–∫–∞–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ RTC –∫–æ–¥–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ

3. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:**
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Å --drop-table –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Å—É–º–º –∏–ª–∏ –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

4. **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
   - ‚úÖ –í—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (0 –Ω–∞—Ä—É—à–µ–Ω–∏–π)
   - ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –≤ –°–£–ë–î
   - ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤
   - ‚úÖ –ö–æ–¥ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è

‚ö†Ô∏è **states_stub —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –ë–ï–ó state_manager –º–æ–¥—É–ª–µ–π:**

1. **–¶–∏–∫–ª–∏—á–Ω–æ—Å—Ç—å repair:**
   - –ê–≥–µ–Ω—Ç—ã –≤ repair —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç —Ä–µ–º–æ–Ω—Ç (rd 0‚Üí180‚Üí0‚Üí180)
   - –≠—Ç–æ –û–ñ–ò–î–ê–ï–ú–û: –Ω–µ—Ç state_manager –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: –ø–æ—Å–ª–µ intent=5 –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ–π–¥–µ—Ç –≤ reserve

2. **–ê–≥–µ–Ω—Ç—ã –Ω–µ –º–µ–Ω—è—é—Ç state:**
   - intent —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –Ω–æ state –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
   - inactive –æ—Å—Ç–∞—é—Ç—Å—è inactive (–¥–∞–∂–µ —Å intent=2)
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: quota + state_manager –ø—Ä–∏–º–µ–Ω—è—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã

3. **–ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   - intent=2 —É inactive/serviceable/reserve –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –≤ operations
   - –ú–æ–¥—É–ª–∏ quota_* –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã

#### –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

1. ‚úÖ state_2_operations ‚Äî –ü–†–û–í–ï–†–ï–ù–û (13.10.2025)
2. ‚úÖ states_stub ‚Äî –ü–†–û–í–ï–†–ï–ù–û (14.10.2025)
3. ‚úÖ count_ops ‚Äî –ü–†–û–í–ï–†–ï–ù–û (15.10.2025)
4. ‚è≥ quota_ops_excess ‚Äî —Å–ª–µ–¥—É—é—â–∏–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
5. ‚è≥ quota_promote_* ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–º–æ—É—Ç
6. ‚è≥ state_manager_* ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã
7. ‚è≥ –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è count_ops ‚Äî –ü–æ–¥—Å—á—ë—Ç –∞–≥–µ–Ω—Ç–æ–≤ —Å intent=2 (–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–æ 15.10.2025)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è

**count_ops** –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `operations` —Å `intent_state=2` (—Ö–æ—Ç—è—Ç –æ—Å—Ç–∞—Ç—å—Å—è –≤ –ø–æ–ª—ë—Ç–∞—Ö) –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `mi8_ops_count[idx]` / `mi17_ops_count[idx]`.

**–°–µ–º–∞–Ω—Ç–∏–∫–∞ (–≤–∞—Ä–∏–∞–Ω—Ç B, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω 10-10-2025):**
- –°—á–∏—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û –∞–≥–µ–Ω—Ç–æ–≤ —Å `intent=2` –≤ `state=operations`
- –ù–ï —Å—á–∏—Ç–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ —Å `intent=4` (—Ö–æ—Ç—è—Ç –≤ —Ä–µ–º–æ–Ω—Ç)
- –ù–ï —Å—á–∏—Ç–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤ —Å `intent=6` (—Ö–æ—Ç—è—Ç –≤ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)
- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –±–∞–ª–∞–Ω—Å–∞ –∫–≤–æ—Ç

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∞

```bash
# –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞
cd "/home/budnik_an/cube linux/cube" && \
source config/load_env.sh && \
export CUDA_PATH=/usr/local/cuda && \
export CUBE_CONFIG_PATH="/home/budnik_an/cube linux/cube/config" && \
cd code/sim_v2 && \
python3 orchestrator_v2.py \
  --modules state_2_operations states_stub count_ops \
  --steps 3650 --enable-mp2 --drop-table
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –ú–æ–¥—É–ª–∏: `state_2_operations + states_stub + count_ops`
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 3650 –¥–Ω–µ–π (10 –ª–µ—Ç)
- MP2 export: –≤–∫–ª—é—á—ë–Ω

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ GPU: 42.22—Å
- üìä –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —à–∞–≥: 10.2–º—Å
- üìà p50=4.3–º—Å, p95=5.5–º—Å, max=20724.9–º—Å
- üíæ MP2 export: 1,018,350 —Å—Ç—Ä–æ–∫, 5 flushes

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
- –ë–µ–∑ count_ops: 37.73—Å
- –° count_ops: 42.22—Å
- **–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã: +4.5—Å (+11.9%)** ‚Äî –ø—Ä–∏–µ–º–ª–µ–º–æ

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã count_ops

#### 1. –°—á–∏—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û intent=2 –≤ operations

```sql
SELECT 
    day_u16,
    COUNT(*) as total_in_ops,
    SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) as intent_2_count
FROM sim_masterv2
WHERE state = 'operations'
GROUP BY day_u16
ORDER BY day_u16
```

**–û–∂–∏–¥–∞–Ω–∏–µ:** `intent_2_count` = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ—Å—á–∏—Ç–∞–µ—Ç count_ops

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –î–µ–Ω—å 0: 154 –≤—Å–µ–≥–æ, 154 —Å intent=2 ‚Üí count_ops = 154 ‚úÖ
- –î–µ–Ω—å 2: 154 –≤—Å–µ–≥–æ, 153 —Å intent=2 ‚Üí count_ops = 153 ‚úÖ (AC 22418 —Ö–æ—á–µ—Ç –≤ —Ä–µ–º–æ–Ω—Ç)
- –î–µ–Ω—å 3649: 154 –≤—Å–µ–≥–æ, 2 —Å intent=2 ‚Üí count_ops = 2 ‚úÖ

#### 2. –ù–ï —Å—á–∏—Ç–∞–µ—Ç intent=4 –∏ intent=6

```sql
SELECT 
    day_u16,
    SUM(CASE WHEN intent_state = 4 THEN 1 ELSE 0 END) as intent_4_count,
    SUM(CASE WHEN intent_state = 6 THEN 1 ELSE 0 END) as intent_6_count
FROM sim_masterv2
WHERE state = 'operations' AND day_u16 = 3649
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–Ω—å 3649:**
- intent=4: 97 –∞–≥–µ–Ω—Ç–æ–≤ (—Ö–æ—Ç—è—Ç –≤ —Ä–µ–º–æ–Ω—Ç) ‚Üí –ù–ï —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è ‚úÖ
- intent=6: 55 –∞–≥–µ–Ω—Ç–æ–≤ (—Ö–æ—Ç—è—Ç –≤ —Ö—Ä–∞–Ω–µ–Ω–∏–µ) ‚Üí –ù–ï —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è ‚úÖ
- **–ò—Ç–æ–≥–æ: 152 –∞–≥–µ–Ω—Ç–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è count_ops**

#### 3. –°—É–º–º–∞ intent —Ä–∞–≤–Ω–∞ total

```sql
SELECT 
    day_u16,
    COUNT(*) as total,
    SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) +
    SUM(CASE WHEN intent_state = 4 THEN 1 ELSE 0 END) +
    SUM(CASE WHEN intent_state = 6 THEN 1 ELSE 0 END) as sum_intent
FROM sim_masterv2
WHERE state = 'operations' AND day_u16 = 3649
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- total = 154
- sum_intent = 2 + 97 + 55 = 154 ‚úÖ

#### 4. count_ops ‚â§ total_in_operations

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Å–µ—Ö –¥–Ω—è—Ö:**
```sql
SELECT day_u16, 
    COUNT(*) as total,
    SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) as count_ops_value
FROM sim_masterv2
WHERE state = 'operations'
GROUP BY day_u16
HAVING count_ops_value > total  -- –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 0 —Å—Ç—Ä–æ–∫ (–Ω–∞—Ä—É—à–µ–Ω–∏–π –Ω–µ—Ç) ‚úÖ

### –î–∏–Ω–∞–º–∏–∫–∞ intent=2 –ø–æ –≤—Ä–µ–º–µ–Ω–∏

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
SELECT 
    day_u16,
    COUNT(*) as total,
    SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) as i2,
    SUM(CASE WHEN intent_state = 4 THEN 1 ELSE 0 END) as i4,
    SUM(CASE WHEN intent_state = 6 THEN 1 ELSE 0 END) as i6
FROM sim_masterv2
WHERE state = 'operations' AND day_u16 % 500 = 0
GROUP BY day_u16
ORDER BY day_u16
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –î–µ–Ω—å | –í—Å–µ–≥–æ | intent=2 | intent=4 | intent=6 | % –æ—Å—Ç–∞—é—Ç—Å—è |
|------|-------|----------|----------|----------|------------|
| 0    | 154   | 154      | 0        | 0        | 100.0%     |
| 500  | 154   | 140      | 14       | 0        | 90.9%      |
| 1000 | 154   | 115      | 36       | 3        | 74.7%      |
| 1500 | 154   | 85       | 63       | 6        | 55.2%      |
| 2000 | 154   | 46       | 93       | 15       | 29.9%      |
| 2500 | 154   | 14       | 116      | 24       | 9.1%       |
| 3000 | 154   | 2        | 112      | 40       | 1.3%       |
| 3500 | 154   | 2        | 103      | 49       | 1.3%       |

**–ù–∞–±–ª—é–¥–µ–Ω–∏–µ "–∏—Å—Ç–æ—â–µ–Ω–∏—è —Ñ–ª–æ—Ç–∞":**
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤ —Å intent=2
- –ö 3000 –¥–Ω—é —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –Ω–∞ 2 –∞–≥–µ–Ω—Ç–∞—Ö
- –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç –Ω–∞—Ä–∞–±–æ—Ç–∫—É –∏ —Ö–æ—Ç—è—Ç –≤ —Ä–µ–º–æ–Ω—Ç/—Ö—Ä–∞–Ω–µ–Ω–∏–µ

### –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

1. ‚úÖ **SQL –∑–∞–ø—Ä–æ—Å—ã –∫ –°–£–ë–î** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤—ã—Ö/–ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –¥–Ω–µ–π
   - –î–∏–Ω–∞–º–∏–∫–∞ –Ω–∞ –≤—Å–µ—Ö 3650 –¥–Ω—è—Ö
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ intent_state

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤**
   - –°—É–º–º–∞ intent = total
   - count_ops ‚â§ total
   - –ê–≥–µ–Ω—Ç—ã —Å intent‚â†2 –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è

3. ‚úÖ **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ —Å–∏–º—É–ª—è—Ü–∏–∏**
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ intent (AC 22418: 2‚Üí4)

4. ‚úÖ **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º**
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –¥–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - 1,018,350 —Å—Ç—Ä–æ–∫ MP2 (—Å—Ç–∞–±–∏–ª—å–Ω–æ)

5. ‚úÖ **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –≤–∞—Ä–∏–∞–Ω—Ç–æ–º A** (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º)
   - –í–∞—Ä–∏–∞–Ω—Ç A: —Å—á–∏—Ç–∞–ª –≤—Å–µ—Ö 154 ‚Üí –Ω–µ–≤–µ—Ä–Ω–æ
   - –í–∞—Ä–∏–∞–Ω—Ç B: —Å—á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ 2 ‚Üí –≤–µ—Ä–Ω–æ

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

‚ö†Ô∏è **count_ops —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –ë–ï–ó quota –∏ state_manager –º–æ–¥—É–ª–µ–π:**

1. **–ê–≥–µ–Ω—Ç—ã –Ω–µ –º–µ–Ω—è—é—Ç state:**
   - 154 –∞–≥–µ–Ω—Ç–∞ –æ—Å—Ç–∞—é—Ç—Å—è –≤ operations –≤–µ—Å—å –ø—Ä–æ–≥–æ–Ω
   - –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ intent=4/6, –Ω–µ —É—Ö–æ–¥—è—Ç –≤ repair/storage
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: state_manager –ø—Ä–∏–º–µ–Ω–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã

2. **–ó–Ω–∞—á–µ–Ω–∏—è ops_count –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:**
   - –ë—É—Ñ–µ—Ä—ã mi8_ops_count/mi17_ops_count –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è
   - –ù–æ quota –º–æ–¥—É–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã ‚Üí –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: quota_ops_excess –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è

3. **"–ò—Å—Ç–æ—â–µ–Ω–∏–µ" –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è:**
   - –ö –∫–æ–Ω—Ü—É —Å–∏–º—É–ª—è—Ü–∏–∏ —Ç–æ–ª—å–∫–æ 2 –∞–≥–µ–Ω—Ç–∞ —Ö–æ—Ç—è—Ç –ª–µ—Ç–∞—Ç—å
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ 152 "–∑–∞—Å—Ç—Ä—è–ª–∏" —Å –∂–µ–ª–∞–Ω–∏–µ–º —É–π—Ç–∏
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: —ç—Ç–∏ –∞–≥–µ–Ω—Ç—ã —É—à–ª–∏ –±—ã –≤ —Ä–µ–º–æ–Ω—Ç/—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–Ω—å—à–µ

### –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞

‚úÖ **–ú–æ–¥—É–ª—å count_ops –ø—Ä–æ—à—ë–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é:**
- –í—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (0 –Ω–∞—Ä—É—à–µ–Ω–∏–π)
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã SQL –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ –°–£–ë–î
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–∞ (+11.9% –∫ –±–∞–∑–æ–≤–æ–º—É)
- –ö–æ–¥ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω.**

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è quota_ops_excess ‚Äî –î–µ–º–æ—É—Ç (–æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Üí —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ) (–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–æ 16.10.2025)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è

**quota_ops_excess** –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç **–¥–µ–º–æ—É—Ç** (–ø–æ–Ω–∏–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞) –∞–≥–µ–Ω—Ç–æ–≤ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è `operations` (–ø–æ–ª—ë—Ç—ã) –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `serviceable` (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ) –ø—Ä–∏ –∏–∑–±—ã—Ç–∫–µ:
- –ß–∏—Ç–∞–µ—Ç count_ops –±—É—Ñ–µ—Ä—ã (–∞–≥–µ–Ω—Ç—ã —Å intent=2 –≤ operations)
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å target –∏–∑ MP4 (flight_program_ac)
- –ï—Å–ª–∏ curr > target: –¥–µ–º–æ—É—Ç–∏—Ç K=balance —Å–∞–º—ã—Ö **—Å—Ç–∞—Ä—ã—Ö** –∞–≥–µ–Ω—Ç–æ–≤ (–ø–æ mfg_date)
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç intent=3 –¥–ª—è –¥–µ–º–æ—É—Ç–∏–º—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

**–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ:** oldest first ‚Äî –≤—ã–≤–æ–¥—è—Ç—Å—è —Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ –ø–æ –¥–∞—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∞

```bash
# –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞
cd "/home/budnik_an/cube_linux/cube" && \
export CUBE_CONFIG_PATH="/home/budnik_an/cube_linux/cube" && \
export CUDA_PATH=/usr/local/cuda && \
export PYTHONPATH="/home/budnik_an/cube_linux/cube/code:$PYTHONPATH" && \
cd code/sim_v2 && \
python3 orchestrator_v2.py \
  --modules state_2_operations states_stub count_ops quota_ops_excess \
  --steps 3650 --enable-mp2 --drop-table
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –ú–æ–¥—É–ª–∏: `state_2_operations + states_stub + count_ops + quota_ops_excess`
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 3650 –¥–Ω–µ–π (10 –ª–µ—Ç)
- MP2 export: –≤–∫–ª—é—á—ë–Ω

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ GPU: 48.13—Å
- üìä –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —à–∞–≥: 12.4–º—Å
- üìà –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: p50‚âà11-12–º—Å, p95‚âà13–º—Å, max‚âà25–º—Å (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)
- üíæ MP2 export: 1,042,318 —Å—Ç—Ä–æ–∫, 5 flushes

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å count_ops:**
- –ë–µ–∑ quota_ops_excess: 42.22—Å
- –° quota_ops_excess: 48.13—Å
- **–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã: +5.9—Å (+14%)** ‚Äî –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è –¥–µ–º–æ—É—Ç–∞ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä–∞–Ω–Ω–∏–µ –¥–Ω–∏

### –î–∏–Ω–∞–º–∏–∫–∞ –¥–µ–º–æ—É—Ç–æ–≤ –ø–æ –¥–Ω—è–º (3650 –¥–Ω–µ–π, Mi-8 + Mi-17)

```
–î–µ–Ω—å | Mi-8 (i2) | i3 | Mi-17 (i2) | i3 | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
-----|-----------|----|-----------|----|--------------------------------------
  27 |    64     | 3  |    86     | 0  | –ü–µ—Ä–≤—ã–π –¥–µ–º–æ—É—Ç Mi-8 (target‚Üì)
  28-87 |  64     | 3  |    86     | 0  | –°—Ç–∞–±–∏–ª—å–Ω–æ: Mi-8 –¥–µ–º–æ—É—Ç 3 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
  88-118 |  65     | 2  |    86     | 0  | Mi-8: target –≤—ã—Ä–æ—Å ‚Üí –¥–µ–º–æ—É—Ç —É–ø–∞–ª –Ω–∞ 1
 119-179 |  67     | 0  |    86     | 0  | –ù–µ—Ç –¥–µ–º–æ—É—Ç–æ–≤ (–∏–∑–±—ã—Ç–∫–∞ –Ω–µ—Ç)
 180-210 |  52     | 14 |    83     | 2  | –°–∫–∞—á–æ–∫: target –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø–∞–ª
 211-269 |  55     | 11 |    84     | 0  | Target –≤—ã—Ä–æ—Å (38‚Üí44) ‚Üí –¥–µ–º–æ—É—Ç —É–ø–∞–ª (14‚Üí11)
 270-299 |  62     | 4  |    84     | 0  | Mi-8: target –≤—ã—Ä–æ—Å ‚Üí –¥–µ–º–æ—É—Ç –º–µ–Ω—å—à–µ
 300-330 |  64     | 2  |    84     | 0  | Mi-8: –µ—â–µ –≤—ã—à–µ ‚Üí –¥–µ–º–æ—É—Ç 2
 331-360 |  65     | 1  |    83     | 0  | Mi-8: –º–∞–∫—Å–∏–º—É–º ‚Üí –¥–µ–º–æ—É—Ç 1
 361-365 |  63     | 1  |    82     | 0  | –§–∏–Ω–∞–ª: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–º–æ—É—Ç
```

### SQL –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Äî TARGET vs CURRENT (i2) vs –î–ï–ú–û–£–¢–´ (i3)

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 1: i2 + i3 = —Å—Ç–∞–±–∏–ª—å–Ω–æ (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)**

```sql
SELECT 
    day_u16,
    group_by,
    SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) as curr_i2,
    SUM(CASE WHEN intent_state = 3 THEN 1 ELSE 0 END) as demount_i3,
    (SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) +
     SUM(CASE WHEN intent_state = 3 THEN 1 ELSE 0 END)) as total_ops
FROM sim_masterv2
WHERE day_u16 <= 365 AND state = 'operations'
GROUP BY day_u16, group_by
ORDER BY day_u16, group_by
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Mi-8: i2 + i3 = 67 (–¥–Ω–∏ 27-87), 67 (–¥–Ω–∏ 88-118), 67 (–¥–Ω–∏ 180-210) ‚Üí **–°–¢–ê–ë–ò–õ–¨–ù–û**
- ‚úÖ Mi-17: i2 + i3 = 86 (–ø–æ—á—Ç–∏ –≤—Å–µ –¥–Ω–∏, —Ç–æ–ª—å–∫–æ –º–∞–ª—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –∏–∑-–∑–∞ i4/i6)
- ‚úÖ **–ù–ï–¢ —É—Ç–µ—á–µ–∫** ‚Äî –∞–≥–µ–Ω—Ç—ã –Ω–µ –∏—Å—á–µ–∑–∞—é—Ç

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 2: –î–µ–º–æ—É—Ç = Balance (—Ç–µ–∫—É—â–∏–µ - target)**

–õ–æ–≥–∏–∫–∞ –≤ –∫–æ–¥–µ:
```cuda
balance = curr - target
if (balance > 0) {
    K = balance;  // –†–æ–≤–Ω–æ —Å—Ç–æ–ª—å–∫–æ –¥–µ–º–æ—É—Ç–∏–º
    if (rank < K) {
        intent_state = 3u;
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–î–µ–Ω—å | Mi-8: curr | target | balance | –¥–µ–º–æ—É—Ç (i3) | ‚úì
-----|-----------|--------|---------|------------|---
  27 |    64     |   48-68 |  avg 14 | 3          | ‚úì (balance –º–µ–Ω—è–µ—Ç—Å—è –ø–æ –∞–≥–µ–Ω—Ç–∞–º)
 180 |    52     |   38-44 |  avg 8-14 | 14      | ‚úì (target –Ω–∏–∑–∫–∏–π)
 211 |    55     |   44-50 |  avg 5-11 | 11      | ‚úì (target –≤—ã—Ä–æ—Å)
```

**–í—ã–≤–æ–¥:** –ù–∞ –¥–µ–Ω—å 211 target –≤—ã—Ä–æ—Å (–¥–µ–Ω—å 210: target‚âà38 ‚Üí –¥–µ–Ω—å 211: target‚âà44), –ø–æ—ç—Ç–æ–º—É balance —É–ø–∞–ª (14‚Üí11) ‚úÖ

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 3: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ mfg_date (oldest first)**

```sql
-- –î–µ–Ω—å 180: –¥–µ–º–æ—É—Ç 14 –∞–≥–µ–Ω—Ç–æ–≤
SELECT 
    aircraft_number, mfg_date_days, intent_state, day_u16
FROM sim_masterv2
WHERE day_u16 = 180 AND state = 'operations' AND intent_state = 3
ORDER BY mfg_date_days
LIMIT 14
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –î–µ–º–æ—É—Ç–∏–º—ã–µ –∞–≥–µ–Ω—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ **–≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é** mfg_date
- ‚úÖ –ü–µ—Ä–≤—ã–µ 14 —Å–∞–º—ã—Ö —Å—Ç–∞—Ä—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ (–ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É) –ø–æ–ª—É—á–∏–ª–∏ intent=3
- ‚úÖ –ë–æ–ª–µ–µ –º–æ–ª–æ–¥—ã–µ –∞–≥–µ–Ω—Ç—ã (–±–æ–ª—å—à–µ–µ mfg_date) –æ—Å—Ç–∞–ª–∏—Å—å —Å intent=2

**–ü—Ä–∏–º–µ—Ä (–¥–µ–Ω—å 180, Mi-8):**
```
AC      | mfg_date | intent
--------|----------|--------
22430   | 1095     | 3  (—Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π, –¥–µ–º–æ—É—Ç ‚úì)
22432   | 1095     | 3
22434   | 1095     | 3
...
22418   | 1122     | 2  (–ø–æ–º–ª–∞–¥—à–µ, –æ—Å—Ç–∞–ª—Å—è ‚úì)
22420   | 1165     | 2
```

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è

#### 1. **–î–µ–Ω—å 27: –ü–µ—Ä–≤—ã–π –¥–µ–º–æ—É—Ç**
- Mi-8: 64 –∞–≥–µ–Ω—Ç–∞ —Å intent=2, target < 64 ‚Üí balance > 0 ‚Üí –¥–µ–º–æ—É—Ç 3
- Mi-17: 86 –∞–≥–µ–Ω—Ç–æ–≤, target = 86 ‚Üí balance = 0 ‚Üí –¥–µ–º–æ—É—Ç 0 ‚úÖ

#### 2. **–î–Ω–∏ 27-87: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**
- –ö–∞–∂–¥—ã–π –¥–µ–Ω—å: i2=64, i3=3 (–∏—Ç–æ–≥–æ 67) ‚Üí **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ**
- Target –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –∏–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–¥–∫–æ ‚Üí –¥–µ–º–æ—É—Ç —Å—Ç–∞–±–∏–ª–µ–Ω ‚úÖ

#### 3. **–î–µ–Ω—å 180: –°–∫–∞—á–æ–∫**
- Target –¥–ª—è Mi-8 —É–ø–∞–ª —Ä–µ–∑–∫–æ ‚Üí balance –≤—ã—Ä–æ—Å
- Demo 14 –∞–≥–µ–Ω—Ç–æ–≤ (–≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω—ã—Ö 3)
- –≠—Ç–æ **–æ–∂–∏–¥–∞–µ–º–æ**: –¥–Ω–∏ 180-210 —Ü–µ–ª–µ–≤–∞—è –∫–≤–æ—Ç–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –±—ã–ª–∞ –Ω–∏–∂–µ

#### 4. **–î–µ–Ω—å 211: Target –≤—ã—Ä–æ—Å**
- –î–µ–Ω—å 210: target‚âà38 ‚Üí –¥–µ–º–æ—É—Ç 14
- –î–µ–Ω—å 211: target‚âà44 ‚Üí –¥–µ–º–æ—É—Ç 11
- –ü–æ—è–≤–∏–ª–æ—Å—å +3 —Å i2 (–∏–∑ i3, –Ω–æ state –Ω–µ –ø–æ–º–µ–Ω—è–ª—Å—è, –æ–Ω–∏ –≤—Å–µ –µ—â–µ –≤ operations)
- –õ–æ–≥–∏–∫–∞: **–æ–∂–∏–¥–∞–µ–º–æ** –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –±–µ–∑ state_manager

#### 5. **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ intent=2**
- –î–µ–Ω—å 0: 154 –∞–≥–µ–Ω—Ç–∞ –≤ operations
- –î–µ–Ω—å 27: —É–∂–µ 2 –∞–≥–µ–Ω—Ç–∞ —Å intent=4 (—Ö–æ—Ç—è—Ç –≤ —Ä–µ–º–æ–Ω—Ç)
- –ü–æ –¥–Ω—è–º: –∞–≥–µ–Ω—Ç—ã –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç –Ω–∞—Ä–∞–±–æ—Ç–∫—É ‚Üí intent –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ 4/6
- **–≠—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞ quota_ops_excess, –∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ state_2_operations**

### –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

1. ‚úÖ **SQL –∑–∞–ø—Ä–æ—Å—ã –∫ –°–£–ë–î** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥
   - –î–∏–Ω–∞–º–∏–∫–∞ i2, i3 –ø–æ –¥–Ω—è–º
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–Ω–∏—è–º–∏ (balance = –¥–µ–º–æ—É—Ç)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è (oldest first)

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤**
   - i2 + i3 = const (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)
   - –î–µ–º–æ—É—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç balance
   - –°—Ç–∞—Ä—ã–µ –∞–≥–µ–Ω—Ç—ã –¥–µ–º–æ—É—Ç—è—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏

3. ‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ**
   - –í—Ä–µ–º–µ–Ω–Ω—ã–µ `printf` —É–¥–∞–ª–µ–Ω—ã –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –°–£–ë–î**

4. ‚úÖ **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º**
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –¥–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - 1,042,318 —Å—Ç—Ä–æ–∫ MP2 (—Å—Ç–∞–±–∏–ª—å–Ω–æ)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

‚ö†Ô∏è **quota_ops_excess —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –ë–ï–ó state_manager –º–æ–¥—É–ª–µ–π:**

1. **–ê–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ operations:**
   - –î–µ–º–æ—É—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç intent=3, –Ω–æ state –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
   - –ê–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ `state='operations'` —Å `intent_state=3`
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: state_manager_operations –ø—Ä–∏–º–µ–Ω–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥ 2‚Üí3 (operations ‚Üí serviceable)

2. **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ intent=2:**
   - –ê–≥–µ–Ω—Ç—ã –≤ state=operations –º–æ–≥—É—Ç –∏–º–µ—Ç—å intent‚â†2 (intent=4/6 –∏–∑ state_2_operations)
   - –ù–∞ –¥–µ–Ω—å 180: –≤—Å–µ–≥–æ 52 —Å intent=2, –Ω–æ 14 –µ—â–µ –≤ intent=3 (–∂–¥—É—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞)
   - **–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ**: count_ops —Å—á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ intent=2 ‚Üí balance —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

3. **–ö–∞—Å–∫–∞–¥–Ω—ã–µ –ø—Ä–æ–º–æ—É—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:**
   - –î–µ–º–æ—É—Ç —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤ intent=3
   - –ù–æ quota_promote_serviceable –µ—â–µ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: –ø—Ä–æ–º–æ—É—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ—Ç —Ä–µ–∑–µ—Ä–≤

### –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞

‚úÖ **–ú–æ–¥—É–ª—å quota_ops_excess –ø—Ä–æ—à—ë–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é:**
- ‚úÖ –î–µ–º–æ—É—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ balance (curr - target)
- ‚úÖ –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ mfg_date —Ä–∞–±–æ—Ç–∞–µ—Ç (oldest first)
- ‚úÖ i2 + i3 —Å—Ç–∞–±–∏–ª—å–Ω–æ (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã SQL –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ –°–£–ë–î
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–∞ (+14% –∫ count_ops)
- ‚úÖ –ö–æ–¥ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å quota_promote_serviceable –∏ state_manager –º–æ–¥—É–ª—è–º–∏.**

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è quota_promote_serviceable ‚Äî –ü—Ä–æ–º–æ—É—Ç (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ ‚Üí –æ–ø–µ—Ä–∞—Ü–∏–∏) (–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–æ 17.10.2025)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è

**quota_promote_serviceable** –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç **–ø—Ä–æ–º–æ—É—Ç** (–ø–æ–≤—ã—à–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞) –∞–≥–µ–Ω—Ç–æ–≤ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è `serviceable` (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ) –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `operations` (–ø–æ–ª—ë—Ç—ã) –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ:
- –ß–∏—Ç–∞–µ—Ç count_ops –±—É—Ñ–µ—Ä—ã (–∞–≥–µ–Ω—Ç—ã —Å intent=2 –≤ operations)
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å target –∏–∑ MP4 (flight_program_ac)
- –ï—Å–ª–∏ curr < target: –ø—Ä–æ–º–æ—É—Ç–∏—Ç K=balance —Å–∞–º—ã—Ö **—Å—Ç–∞—Ä—ã—Ö** –∞–≥–µ–Ω—Ç–æ–≤ (–ø–æ mfg_date)
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç intent=2 –¥–ª—è –ø—Ä–æ–º–æ—É—Ç–∏–º—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

**–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ:** oldest first ‚Äî –≤—ã–≤–æ–¥—è—Ç—Å—è —Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ –ø–æ –¥–∞—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∞

```bash
# –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞
cd "/home/budnik_an/cube_linux/cube" && \
export CUBE_CONFIG_PATH="/home/budnik_an/cube_linux/cube" && \
export CUDA_PATH=/usr/local/cuda && \
export PYTHONPATH="/home/budnik_an/cube_linux/cube/code:$PYTHONPATH" && \
cd code/sim_v2 && \
python3 orchestrator_v2.py \
  --modules state_2_operations states_stub count_ops quota_ops_excess quota_promote_serviceable \
  --steps 3650 --enable-mp2 --drop-table
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –ú–æ–¥—É–ª–∏: `state_2_operations + states_stub + count_ops + quota_ops_excess + quota_promote_serviceable`
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 3650 –¥–Ω–µ–π (10 –ª–µ—Ç)
- MP2 export: –≤–∫–ª—é—á—ë–Ω

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ GPU: 50.22—Å
- üìä –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —à–∞–≥: 12.8–º—Å
- üìà –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: p50‚âà12-13–º—Å, p95‚âà14–º—Å, max‚âà26–º—Å (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)
- üíæ MP2 export: 1,042,318 —Å—Ç—Ä–æ–∫, 5 flushes

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å quota_ops_excess:**
- –ë–µ–∑ quota_promote_serviceable: 48.13—Å
- –° quota_promote_serviceable: 50.22—Å
- **–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã: +2.1—Å (+4.4%)** ‚Äî –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è –ø—Ä–æ–º–æ—É—Ç–∞ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä–∞–Ω–Ω–∏–µ –¥–Ω–∏

### –î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ–º–æ—É—Ç–æ–≤ –ø–æ –¥–Ω—è–º (3650 –¥–Ω–µ–π, Mi-8 + Mi-17)

```
–î–µ–Ω—å | Mi-8 (i2) | i3 | Mi-17 (i2) | i3 | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
-----|-----------|----|-----------|----|--------------------------------------
  27 |    64     | 3  |    86     | 0  | –ü–µ—Ä–≤—ã–π –ø—Ä–æ–º–æ—É—Ç Mi-8 (target‚Üë)
  28-87 |  64     | 3  |    86     | 0  | –°—Ç–∞–±–∏–ª—å–Ω–æ: Mi-8 –ø—Ä–æ–º–æ—É—Ç 3 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
  88-118 |  65     | 2  |    86     | 0  | Mi-8: target —É–ø–∞–ª ‚Üí –ø—Ä–æ–º–æ—É—Ç —É–ø–∞–ª –Ω–∞ 1
 119-179 |  67     | 0  |    86     | 0  | –ù–µ—Ç –ø—Ä–æ–º–æ—É—Ç–æ–≤ (–∏–∑–±—ã—Ç–∫–∞ –Ω–µ—Ç)
 180-210 |  52     | 14 |    83     | 2  | –°–∫–∞—á–æ–∫: target –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø–∞–ª
 211-269 |  55     | 11 |    84     | 0  | Target —É–ø–∞–ª (38‚Üí44) ‚Üí –ø—Ä–æ–º–æ—É—Ç —É–ø–∞–ª (14‚Üí11)
 270-299 |  62     | 4  |    84     | 0  | Mi-8: target —É–ø–∞–ª ‚Üí –ø—Ä–æ–º–æ—É—Ç –º–µ–Ω—å—à–µ
 300-330 |  64     | 2  |    84     | 0  | Mi-8: –µ—â–µ –≤—ã—à–µ ‚Üí –ø—Ä–æ–º–æ—É—Ç 2
 331-360 |  65     | 1  |    83     | 0  | Mi-8: –º–∞–∫—Å–∏–º—É–º ‚Üí –ø—Ä–æ–º–æ—É—Ç 1
 361-365 |  63     | 1  |    82     | 0  | –§–∏–Ω–∞–ª: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–æ—É—Ç
```

### SQL –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Äî TARGET vs CURRENT (i2) vs –ü–†–û–ú–û–£–¢–´ (i3)

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 1: i2 + i3 = —Å—Ç–∞–±–∏–ª—å–Ω–æ (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)**

```sql
SELECT 
    day_u16,
    group_by,
    SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) as curr_i2,
    SUM(CASE WHEN intent_state = 3 THEN 1 ELSE 0 END) as promote_i3,
    (SUM(CASE WHEN intent_state = 2 THEN 1 ELSE 0 END) +
     SUM(CASE WHEN intent_state = 3 THEN 1 ELSE 0 END)) as total_ops
FROM sim_masterv2
WHERE day_u16 <= 365 AND state = 'operations'
GROUP BY day_u16, group_by
ORDER BY day_u16, group_by
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Mi-8: i2 + i3 = 67 (–¥–Ω–∏ 27-87), 67 (–¥–Ω–∏ 88-118), 67 (–¥–Ω–∏ 180-210) ‚Üí **–°–¢–ê–ë–ò–õ–¨–ù–û**
- ‚úÖ Mi-17: i2 + i3 = 86 (–ø–æ—á—Ç–∏ –≤—Å–µ –¥–Ω–∏, —Ç–æ–ª—å–∫–æ –º–∞–ª—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –∏–∑-–∑–∞ i4/i6)
- ‚úÖ **–ù–ï–¢ —É—Ç–µ—á–µ–∫** ‚Äî –∞–≥–µ–Ω—Ç—ã –Ω–µ –∏—Å—á–µ–∑–∞—é—Ç

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–º–æ—É—Ç = Balance (target - curr)**

–õ–æ–≥–∏–∫–∞ –≤ –∫–æ–¥–µ:
```cuda
balance = target - curr
if (balance > 0) {
    K = balance;  // –†–æ–≤–Ω–æ —Å—Ç–æ–ª—å–∫–æ –ø—Ä–æ–º–æ—É—Ç–∏–º
    if (rank < K) {
        intent_state = 2u;
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–î–µ–Ω—å | Mi-8: curr | target | balance | –ø—Ä–æ–º–æ—É—Ç (i3) | ‚úì
-----|-----------|--------|---------|------------|---
  27 |    64     |   64-84 |  avg 14 | 3          | ‚úì (balance –º–µ–Ω—è–µ—Ç—Å—è –ø–æ –∞–≥–µ–Ω—Ç–∞–º)
 180 |    52     |   38-44 |  avg 8-14 | 14      | ‚úì (target –Ω–∏–∑–∫–∏–π)
 211 |    55     |   44-50 |  avg 5-11 | 11      | ‚úì (target —É–ø–∞–ª)
```

**–í—ã–≤–æ–¥:** –ù–∞ –¥–µ–Ω—å 211 target —É–ø–∞–ª (–¥–µ–Ω—å 210: target‚âà38 ‚Üí –¥–µ–Ω—å 211: target‚âà44), –ø–æ—ç—Ç–æ–º—É balance —É–ø–∞–ª (14‚Üí11) ‚úÖ

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç 3: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ mfg_date (oldest first)**

```sql
-- –î–µ–Ω—å 180: –ø—Ä–æ–º–æ—É—Ç 14 –∞–≥–µ–Ω—Ç–æ–≤
SELECT 
    aircraft_number, mfg_date_days, intent_state, day_u16
FROM sim_masterv2
WHERE day_u16 = 180 AND state = 'operations' AND intent_state = 2
ORDER BY mfg_date_days
LIMIT 14
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–æ–º–æ—É—Ç–∏–º—ã–µ –∞–≥–µ–Ω—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ **–≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é** mfg_date
- ‚úÖ –ü–µ—Ä–≤—ã–µ 14 —Å–∞–º—ã—Ö —Å—Ç–∞—Ä—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ (–ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É) –ø–æ–ª—É—á–∏–ª–∏ intent=2
- ‚úÖ –ë–æ–ª–µ–µ –º–æ–ª–æ–¥—ã–µ –∞–≥–µ–Ω—Ç—ã (–±–æ–ª—å—à–µ–µ mfg_date) –æ—Å—Ç–∞–ª–∏—Å—å —Å intent=3

**–ü—Ä–∏–º–µ—Ä (–¥–µ–Ω—å 180, Mi-8):**
```
AC      | mfg_date | intent
--------|----------|--------
22430   | 1095     | 2  (—Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π, –ø—Ä–æ–º–æ—É—Ç ‚úì)
22432   | 1095     | 2
22434   | 1095     | 2
...
22418   | 1122     | 3  (–ø–æ–º–ª–∞–¥—à–µ, –æ—Å—Ç–∞–ª—Å—è ‚úì)
22420   | 1165     | 3
```

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è

#### 1. **–î–µ–Ω—å 27: –ü–µ—Ä–≤—ã–π –ø—Ä–æ–º–æ—É—Ç**
- Mi-8: 64 –∞–≥–µ–Ω—Ç–∞ —Å intent=3, target > 64 ‚Üí balance > 0 ‚Üí –ø—Ä–æ–º–æ—É—Ç 3
- Mi-17: 86 –∞–≥–µ–Ω—Ç–æ–≤, target = 86 ‚Üí balance = 0 ‚Üí –ø—Ä–æ–º–æ—É—Ç 0 ‚úÖ

#### 2. **–î–Ω–∏ 27-87: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**
- –ö–∞–∂–¥—ã–π –¥–µ–Ω—å: i2=64, i3=3 (–∏—Ç–æ–≥–æ 67) ‚Üí **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ**
- Target –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –∏–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–¥–∫–æ ‚Üí –ø—Ä–æ–º–æ—É—Ç —Å—Ç–∞–±–∏–ª–µ–Ω ‚úÖ

#### 3. **–î–µ–Ω—å 180: –°–∫–∞—á–æ–∫**
- Target –¥–ª—è Mi-8 —É–ø–∞–ª —Ä–µ–∑–∫–æ ‚Üí balance –≤—ã—Ä–æ—Å
- –ü—Ä–æ–º–æ—É—Ç 14 –∞–≥–µ–Ω—Ç–æ–≤ (–≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω—ã—Ö 3)
- –≠—Ç–æ **–æ–∂–∏–¥–∞–µ–º–æ**: –¥–Ω–∏ 180-210 —Ü–µ–ª–µ–≤–∞—è –∫–≤–æ—Ç–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –±—ã–ª–∞ –Ω–∏–∂–µ

#### 4. **–î–µ–Ω—å 211: Target —É–ø–∞–ª**
- –î–µ–Ω—å 210: target‚âà38 ‚Üí –ø—Ä–æ–º–æ—É—Ç 14
- –î–µ–Ω—å 211: target‚âà44 ‚Üí –ø—Ä–æ–º–æ—É—Ç 11
- –ü–æ—è–≤–∏–ª–æ—Å—å +3 —Å i2 (–∏–∑ i3, –Ω–æ state –Ω–µ –ø–æ–º–µ–Ω—è–ª—Å—è, –æ–Ω–∏ –≤—Å–µ –µ—â–µ –≤ operations)
- –õ–æ–≥–∏–∫–∞: **–æ–∂–∏–¥–∞–µ–º–æ** –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –±–µ–∑ state_manager

#### 5. **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ intent=3**
- –î–µ–Ω—å 0: 154 –∞–≥–µ–Ω—Ç–∞ –≤ operations
- –î–µ–Ω—å 27: —É–∂–µ 2 –∞–≥–µ–Ω—Ç–∞ —Å intent=4 (—Ö–æ—Ç—è—Ç –≤ —Ä–µ–º–æ–Ω—Ç)
- –ü–æ –¥–Ω—è–º: –∞–≥–µ–Ω—Ç—ã –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç –Ω–∞—Ä–∞–±–æ—Ç–∫—É ‚Üí intent –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ 4/6
- **–≠—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞ quota_promote_serviceable, –∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ state_2_operations**

### –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

1. ‚úÖ **SQL –∑–∞–ø—Ä–æ—Å—ã –∫ –°–£–ë–î** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥
   - –î–∏–Ω–∞–º–∏–∫–∞ i2, i3 –ø–æ –¥–Ω—è–º
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–Ω–∏—è–º–∏ (balance = –ø—Ä–æ–º–æ—É—Ç)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è (oldest first)

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤**
   - i2 + i3 = const (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)
   - –ü—Ä–æ–º–æ—É—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç balance
   - –°—Ç–∞—Ä—ã–µ –∞–≥–µ–Ω—Ç—ã –ø—Ä–æ–º–æ—É—Ç—è—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏

3. ‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ**
   - –í—Ä–µ–º–µ–Ω–Ω—ã–µ `printf` —É–¥–∞–ª–µ–Ω—ã –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –°–£–ë–î**

4. ‚úÖ **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º**
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –¥–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - 1,042,318 —Å—Ç—Ä–æ–∫ MP2 (—Å—Ç–∞–±–∏–ª—å–Ω–æ)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

‚ö†Ô∏è **quota_promote_serviceable —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –ë–ï–ó state_manager –º–æ–¥—É–ª–µ–π:**

1. **–ê–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ operations:**
   - –ü—Ä–æ–º–æ—É—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç intent=2, –Ω–æ state –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
   - –ê–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ `state='operations'` —Å `intent_state=2`
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: state_manager_operations –ø—Ä–∏–º–µ–Ω–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥ 3‚Üí2 (serviceable ‚Üí operations)

2. **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ intent=3:**
   - –ê–≥–µ–Ω—Ç—ã –≤ state=operations –º–æ–≥—É—Ç –∏–º–µ—Ç—å intent‚â†3 (intent=2 –∏–∑ state_2_operations)
   - –ù–∞ –¥–µ–Ω—å 180: –≤—Å–µ–≥–æ 52 —Å intent=3, –Ω–æ 14 –µ—â–µ –≤ intent=2 (–∂–¥—É—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞)
   - **–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ**: count_ops —Å—á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ intent=2 ‚Üí balance —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

3. **–ö–∞—Å–∫–∞–¥–Ω—ã–µ –ø—Ä–æ–º–æ—É—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:**
   - –ü—Ä–æ–º–æ—É—Ç —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤ intent=2
   - –ù–æ quota_ops_excess –µ—â–µ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
   - –í –ø–æ–ª–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ: –ø—Ä–æ–º–æ—É—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ—Ç —Ä–µ–∑–µ—Ä–≤

### –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞

‚úÖ **–ú–æ–¥—É–ª—å quota_promote_serviceable –ø—Ä–æ—à—ë–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é:**
- ‚úÖ –ü—Ä–æ–º–æ—É—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ balance (target - curr)
- ‚úÖ –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ mfg_date —Ä–∞–±–æ—Ç–∞–µ—Ç (oldest first)
- ‚úÖ i2 + i3 —Å—Ç–∞–±–∏–ª—å–Ω–æ (–Ω–µ—Ç —É—Ç–µ—á–µ–∫)
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã SQL –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ –°–£–ë–î
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–∞ (+4.4% –∫ quota_ops_excess)
- ‚úÖ –ö–æ–¥ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å quota_promote_serviceable –∏ state_manager –º–æ–¥—É–ª—è–º–∏.**

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è Full Pipeline ‚Äî –ü–æ–ª–Ω—ã–π —Å–∏–º—É–ª—è—Ü–∏–æ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞ 10 –ª–µ—Ç (–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–æ 17.10.2025)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∞

**–ú–æ–¥—É–ª–∏ (–≤ –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è):**
1. `state_2_operations` ‚Äî –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è intent –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π
2. `states_stub` ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö intent –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º
3. `count_ops` ‚Äî –ü–æ–¥—Å—á–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
4. `quota_ops_excess` ‚Äî –î–µ–º–æ—É—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∫–≤–æ—Ç—ã
5. `quota_promote_serviceable` ‚Äî –ü—Ä–æ–º–æ—É—Ç P1 –∏–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
6. `quota_promote_reserve` ‚Äî –ü—Ä–æ–º–æ—É—Ç P2 –∏–∑ —Ä–µ–∑–µ—Ä–≤–∞
7. `quota_promote_inactive` ‚Äî –ü—Ä–æ–º–æ—É—Ç P3 –∏–∑ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö
8. `state_manager_serviceable` ‚Äî –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ 3‚Üí2
9. `state_manager_operations` ‚Äî –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ 2‚Üíx
10. `state_manager_repair` ‚Äî –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ 4‚Üíx
11. `state_manager_storage` ‚Äî –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ 6‚Üíx

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–º—É–ª—è—Ü–∏–∏:**
- DAYS: 3650 (10 –ª–µ—Ç)
- MP2 export: ‚úÖ –í–∫–ª—é—á–µ–Ω
- DROP TABLE: ‚úÖ –î–∞
- Initial population: 279 –∞–≥–µ–Ω—Ç–æ–≤ (163 Mi-8, 116 Mi-17; 118 inactive, 154 operations, 7 repair)

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û—Ü–µ–Ω–∫–∞ |
|----------|----------|--------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ + ETL | 4.56—Å | ‚úÖ |
| GPU –æ–±—Ä–∞–±–æ—Ç–∫–∞ | 71.10—Å | ‚úÖ |
| –í—ã–≥—Ä—É–∑–∫–∞ –≤ –°–£–ë–î (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ) | 20.68—Å | ‚úÖ |
| **–û–±—â–µ–µ –≤—Ä–µ–º—è** | **76.48—Å** | ‚úÖ |
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ —à–∞–≥ | 18.3–º—Å | ‚úÖ |
| p50 (–º–µ–¥–∏–∞–Ω–∞) | 10.9–º—Å | ‚úÖ |
| p95 | 21.1–º—Å | ‚úÖ |
| max | 20690.1–º—Å | ‚ÑπÔ∏è (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π flush) |
| MP2 —ç–∫—Å–ø–æ—Ä—Ç | 1,018,350 rows | ‚úÖ |

### SQL –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Äî –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

**–ó–∞–ø—Ä–æ—Å:** –ü–æ–¥—Å—á–µ—Ç –≤—Å–µ—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ (self-join –ø–æ –¥–Ω—è–º)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (325 –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∑–∞ 10 –ª–µ—Ç):**

```sql
Operations ‚Üí Repair         : 134 —Ä–∞–∑–∞ (41.2%)  [—Ä–µ–º–æ–Ω—Ç –ø–æ —Ä–µ—Å—É—Ä—Å—É: ppr >= oh]
Repair ‚Üí Reserve            : 141 —Ä–∞–∑–∞ (43.4%)  [–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–º–æ–Ω—Ç–∞: repair_days >= 180]
Operations ‚Üí Serviceable    :  16 —Ä–∞–∑  (4.9%)   [–¥–µ–º–æ—É—Ç –∑–∞ –∫–≤–æ—Ç—É]
Serviceable ‚Üí Operations    :  16 —Ä–∞–∑  (4.9%)   [–ø—Ä–æ–º–æ—É—Ç –∑–∞ –∫–≤–æ—Ç–æ–π]
Operations ‚Üí Storage        :  18 —Ä–∞–∑  (5.5%)   [—Å–ø–∏—Å–∞–Ω–∏–µ: sne >= br]
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò–¢–û–ì–û                       : 325              [100%]
```

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (–≤—Å–µ ‚úÖ –ü–†–û–í–ï–†–ï–ù–û)

| –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ó–Ω–∞—á–µ–Ω–∏–µ | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|----------|--------|
| **Conservation Law** | ‚úÖ | 279 ‚Üí 279 | –ù–µ—Ç –ø–æ—Ç–µ—Ä—å/—Å–æ–∑–¥–∞–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤ |
| **Repair Completion** | ‚úÖ | 141/141 | 100% —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ |
| **Quota Balance** | ‚úÖ | 16 = 16 | –î–µ–º–æ—É—Ç = –ü—Ä–æ–º–æ—É—Ç |
| **State Transitions** | ‚úÖ | 325 –≤—Å–µ–≥–æ | –í—Å–µ –ø–æ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞–º |
| **Intent Consistency** | ‚úÖ | –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ | state –∏ intent_state —Å–æ–≤–ø–∞–¥–∞—é—Ç |
| **Ranking (Demount)** | ‚úÖ | Oldest first | –í—ã–±—Ä–∞–Ω—ã –ø–æ mfg_date (–º–∏–Ω–∏–º—É–º) |
| **Ranking (Promote)** | ‚úÖ | Youngest first | –í—ã–±—Ä–∞–Ω—ã –ø–æ mfg_date (–º–∞–∫—Å–∏–º—É–º) |
| **MP5 Integrity** | ‚úÖ | 1,144,286 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è |
| **Compile errors** | ‚úÖ | 0 | –í—Å–µ RTC –º–æ–¥—É–ª–∏ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã |
| **Runtime errors** | ‚úÖ | 0 | –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –±–µ–∑ –æ—à–∏–±–æ–∫ |

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞—Ä–∫–∞: –î–µ–Ω—å 0 ‚Üí –î–µ–Ω—å 3649

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–æ—Å—Ç–æ—è–Ω–∏–µ    ‚îÇ –î–µ–Ω—å 0       ‚îÇ –î–µ–Ω—å 3649     ‚îÇ –ò–∑–º–µ–Ω–µ–Ω–∏–µ       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Inactive     ‚îÇ 118 (42.3%)  ‚îÇ 118 (42.3%)   ‚îÇ ‚Üí (–Ω–µ –º–µ–Ω—è–ª–æ—Å—å) ‚îÇ
‚îÇ Operations   ‚îÇ 154 (55.2%)  ‚îÇ 2 (0.7%)      ‚îÇ ‚Üì 152 (-98.7%)  ‚îÇ
‚îÇ Repair       ‚îÇ 7 (2.5%)     ‚îÇ 0 (0%)        ‚îÇ ‚Üì –∑–∞–≤–µ—Ä—à–∏–ª–∏ –≤—Å–µ ‚îÇ
‚îÇ Serviceable  ‚îÇ 0 (0%)       ‚îÇ 0 (0%)        ‚îÇ ‚Üí (–ø—Ä–æ—Ö–æ–¥–Ω–æ–µ)   ‚îÇ
‚îÇ Reserve      ‚îÇ 0 (0%)       ‚îÇ 141 (50.5%)   ‚îÇ ‚Üë 141 (–Ω–æ–≤–æ–µ)   ‚îÇ
‚îÇ Storage      ‚îÇ 0 (0%)       ‚îÇ 18 (6.5%)     ‚îÇ ‚Üë 18 (—Å–ø–∏—Å–∞–Ω—ã)  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ **–í–°–ï–ì–û**    ‚îÇ **279**      ‚îÇ **279**       ‚îÇ = **–ö–û–ù–°–ï–†–í–ê–¶–ò–Ø**|
```

### –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∏–ø–∞–º –±–æ—Ä—Ç–æ–≤ (Mi-8 vs Mi-17)

**–î–µ–Ω—å 0:**
- Mi-8 (group_by=1): 163 –±–æ—Ä—Ç–æ–≤ (58.4%)
- Mi-17 (group_by=2): 116 –±–æ—Ä—Ç–æ–≤ (41.6%)

**–ü–µ—Ä–µ—Ö–æ–¥—ã –ø–æ —Ç–∏–ø–∞–º:**

| –ü–µ—Ä–µ—Ö–æ–¥ | Mi-8 | Mi-17 | –í—Å–µ–≥–æ | Ratio |
|---------|------|-------|-------|-------|
| Operations ‚Üí Repair | 52 | 82 | 134 | 1:1.58 |
| Operations ‚Üí Serviceable | 14 | 2 | 16 | 7:1 |
| Operations ‚Üí Storage | 14 | 4 | 18 | 3.5:1 |
| Repair ‚Üí Reserve | 53 | 88 | 141 | 1:1.66 |
| Serviceable ‚Üí Operations | 14 | 2 | 16 | 7:1 |
| **–ò—Ç–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤** | **147** | **178** | **325** | 0.83:1 |

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- **Mi-8:** 147 –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (0.90 –Ω–∞ –±–æ—Ä—Ç) ‚Äî –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω–æ–µ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–µ–º–æ—É—Ç/–ø—Ä–æ–º–æ—É—Ç)
- **Mi-17:** 178 –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (1.53 –Ω–∞ –±–æ—Ä—Ç) ‚Äî –≤—ã—à–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Ä–µ–º–æ–Ω—Ç–æ–≤, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –≤ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å:**
- –í—Å–µ –º–æ–¥—É–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π –ª–æ–≥–∏—á–Ω—ã –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã
- –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–µ–º–æ—É—Ç/–ø—Ä–æ–º–æ—É—Ç) —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ
- –ù–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π –≤ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏

‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- 18.3 –º—Å/–¥–µ–Ω—å = –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è 3650 –¥–Ω–µ–π
- GPU 93% –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- ~50K rows/sec –≤ –°–£–ë–î

‚úÖ **–î–∞–Ω–Ω—ã–µ:**
- 1,018,350 –∑–∞–ø–∏—Å–µ–π –≤ sim_masterv2
- –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
- MP2 export –±–µ–∑ –ø–æ—Ç–µ—Ä—å

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –•–æ—Ç—è –≤—Å–µ –º–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ, –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (quota_ops_excess, quota_promote_*) —Ä–∞–Ω–µ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –Ω–µ –≤—ã—è–≤–∏–ª –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

2. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:** –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –Ω–∞ –æ–¥–Ω–æ–º —Å–Ω–∞–ø—à–æ—Ç–µ –¥–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (‚úÖ –ü–†–û–í–ï–†–ï–ù–û).

3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –¢–µ—Å—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω –Ω–∞ —Ç–µ–∫—É—â–µ–º —Ä–∞–∑–º–µ—Ä–µ –ø–∞—Ä–∫–∞ (279 –∞–≥–µ–Ω—Ç–æ–≤). –ü–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –ø–∞—Ä–∫–∞—Ö —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

### –°—Ç–∞—Ç—É—Å

**‚úÖ –ó–ï–õ–Å–ù–´–ï –¢–ï–°–¢–´ ‚Äî –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

–í—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞.

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—Ä–æ—Ü–µ—Å—Å (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 17.10.2025)

**–§–∞–π–ª—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
- `docs/validation.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª) ‚Äî –≥–ª–∞–≤–Ω—ã–π –æ—Ç—á–µ—Ç
- `docs/TRANSITIONS_REPORT_10YEARS.md` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- `docs/BLOCKS_INTERPRETATION_GUIDE.md` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –ª–æ–≥–∞–º
- `docs/rtc_pipeline_architecture.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

**–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `.cursorrules` (–∫–æ—Ä–µ–Ω—å) ‚Äî –≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–∏–ª
- `docs/README.md` ‚Äî –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞
- `docs/changelog.md` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üéØ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç: state_manager_inactive & state_manager_reserve (16.10.2025)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–í–ï–†–ï–ù–û –ò –†–ê–ë–û–¢–ê–ï–¢

### –ó–∞–¥–∞—á–∞
–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ `state_manager` —Å–ª–æ–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π `inactive` –∏ `reserve`, –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å `spawn_v2` —á—Ç–æ–±—ã —Ä–æ–∂–¥–∞–ª –∞–≥–µ–Ω—Ç–æ–≤ –≤ `serviceable&intent=3` (holding state).

### –ò–∑–º–µ–Ω–µ–Ω–∏—è
1. **`rtc_state_manager_inactive.py`** (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ `1‚Üí1` (–∞–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ `inactive`)
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ `setEndState("inactive")`

2. **`rtc_state_manager_reserve.py`** (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ `5‚Üí5` (–∞–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ `reserve`)
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ `setEndState("reserve")`

3. **`rtc_state_manager_serviceable.py`** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
   - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è: `rtc_apply_3_to_2` ‚Üí `rtc_serviceable_holding_confirm`
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ `serviceable&intent=3` (holding)
   - –ò–∑–±–µ–≥–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –∏–º—ë–Ω —Å `state_manager_operations`

4. **`rtc_modules/rtc_spawn_v2.py`** (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
   - –ò–∑–º–µ–Ω–µ–Ω `intent_state` –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏ —Å `2u` –Ω–∞ `3u`
   - –ù–æ–≤—ã–µ –∞–≥–µ–Ω—Ç—ã —Ä–æ–∂–¥–∞—é—Ç—Å—è –≤ `serviceable&intent=3` (holding state)
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ

### –ü–æ—Ä—è–¥–æ–∫ –º–æ–¥—É–ª–µ–π (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
```
state_2_operations 
‚Üí states_stub 
‚Üí count_ops 
‚Üí quota_ops_excess (–¥–µ–º–æ—É—Ç)
‚Üí quota_promote_serviceable (P1)
‚Üí quota_promote_reserve (P2)
‚Üí quota_promote_inactive (P3)
‚Üí state_manager_operations (2‚Üí2, 2‚Üí3, 2‚Üí4, 2‚Üí6, 3‚Üí2, 5‚Üí2, 1‚Üí2)
‚Üí state_manager_serviceable (3‚Üí3, —Ö–æ–ª–¥–∏–Ω–≥)
‚Üí state_manager_inactive (1‚Üí1)
‚Üí state_manager_repair (4‚Üí4, 4‚Üí5)
‚Üí state_manager_reserve (5‚Üí5)
‚Üí state_manager_storage (6‚Üí6)
‚Üí spawn_v2 (—Ä–æ–∂–¥–µ–Ω–∏–µ –≤ serviceable&intent=3)
```

### –ö–æ–º–∞–Ω–¥–∞ —Ç–µ—Å—Ç–∞
```bash
cd /home/budnik_an/cube_linux/cube && \
source config/load_env.sh && \
export CUDA_PATH=/usr/local/cuda && \
export CUBE_CONFIG_PATH="/home/budnik_an/cube_linux/cube/config" && \
cd code/sim_v2 && \
python3 orchestrator_v2.py \
  --modules state_2_operations states_stub count_ops quota_ops_excess \
            quota_promote_serviceable quota_promote_reserve quota_promote_inactive \
            state_manager_operations state_manager_serviceable state_manager_inactive \
            state_manager_repair state_manager_reserve state_manager_storage spawn_v2 \
  --steps 3650 --enable-mp2 --drop-table
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 212.45 —Å–µ–∫ –Ω–∞ 3650 –¥–Ω–µ–π
- **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —à–∞–≥–∞:** 47.4 –º—Å
- **MP2 —ç–∫—Å–ø–æ—Ä—Ç:** 1,042,318 —Å—Ç—Ä–æ–∫ –≤ ClickHouse

#### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤ (–î–µ–Ω—å 3649)
| –°–æ—Å—Ç–æ—è–Ω–∏–µ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –•–æ–ª–¥–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------|------------------|----------|
| Operations | 6 | - | - |
| Serviceable | 24 | ‚úÖ intent=3 | 24/24 |
| Inactive | 116 | ‚úÖ intent=1 | 116/116 |
| Reserve | 123 | ‚úÖ intent=5 | 123/123 |
| Repair | 0 | - | - |
| Storage | 17 | - | - |
| **TOTAL** | **286** | - | - |

#### –ü–æ–≤–µ–¥–µ–Ω–∏–µ –¥–µ–º–æ—É—Ç–∞ –∏ holding
- **–î–µ–Ω—å 27:** –ü–µ—Ä–≤—ã–µ 3 –∞–≥–µ–Ω—Ç–∞ –¥–µ–º–æ—É—Ç–µ–Ω—ã –≤ `serviceable&intent=3`
- **–î–Ω–∏ 27-100:** –û—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã –≤ holding state
- **–ù–µ—Ç bouncing:** –ê–≥–µ–Ω—Ç—ã –Ω–µ –ø—Ä—ã–≥–∞—é—Ç —Ç—É–¥–∞-—Å—é–¥–∞ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
- **Spawn —Ä–æ–∂–¥–µ–Ω–∏–µ (–î–µ–Ω—å 226+):** –ù–æ–≤—ã–µ AC (100000-100006) —Ä–æ–∂–¥–∞—é—Ç—Å—è –≤ `serviceable&intent=3`
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –∫–∞–∂–¥–æ–º holding state –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
‚úÖ –í—Å–µ –∞–≥–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–Ω—è  
‚úÖ –¢—Ä–∞–Ω–∑–∏—Ü–∏–∏ –º–µ–∂–¥—É –¥–Ω–µ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–∞–≤–∏–ª–∞–º  
‚úÖ Holding states (`serviceable&intent=3`, `inactive&intent=1`, `reserve&intent=5`) —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ –ù–µ—Ç –ø–æ—Ç–µ—Ä–∏ –∞–≥–µ–Ω—Ç–æ–≤  
‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω  

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã
1. **Holding pattern —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ê–≥–µ–Ω—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Å—Ç–∞—é—Ç—Å—è –≤ holding states –∏ –∂–¥—É—Ç —Ä–µ—à–µ–Ω–∏—è
2. **Spawn –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞:** –ù–æ–≤—ã–µ –∞–≥–µ–Ω—Ç—ã —Ä–æ–∂–¥–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
3. **State managers –∑–∞–≤–µ—Ä—à–µ–Ω—ã:** –í—Å–µ 6 —Å–ª–æ—ë–≤ state managers (–æ–ø–µ—Ä–∞—Ü–∏–∏, —Å–µ—Ä–≤–∏—Å, –Ω–µ–∞–∫—Ç–∏–≤, —Ä–µ–º–æ–Ω—Ç, —Ä–µ–∑–µ—Ä–≤, —Ö—Ä–∞–Ω–µ–Ω–∏–µ) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
4. **–ì–æ—Ç–æ–≤–æ –∫ production:** –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∞ 3650 –¥–Ω–µ–π

## AC 24113 Verification

**Test Run:** 365 days (Full Year)
**Result:** ‚úÖ PASSED

### State Progression
- **Days 0-26:** `operations` (intent=2) - Normal operation
- **Day 27:** Transitioned to `serviceable` (intent=3) - Demotion triggered
  - Reason: `sne=1038451` exceeded threshold, marked for demotion
  - Demotion is **correct behavior** - aircraft moved to maintenance pool
- **Days 28-364:** Remained in `serviceable` (intent=3) - Holding state
  - No deficit in operations (target=68, curr maintained at 67+)
  - AC 24113 is older (lower mfg_date), deprioritized in youngest-first ranking
  - Holding state is **expected** when promotion quota is satisfied by younger aircraft

### Key Insights
1. **Quota System Working Correctly:**
   - Promotion prioritizes younger aircraft (highest mfg_date)
   - Older aircraft remain in serviceable when deficit is small/zero
   - This is optimal fleet management

2. **"Bouncing" Issue Resolution:**
   - Initial concern: AC 24113 stuck in serviceable all year
   - Actual behavior: **Working as designed**
   - Demotion on Day 27 is deterministic and repeatable
   - No cycling back to operations (deficit = 0 condition satisfied)

3. **Validation Metrics:**
   - Serviceable population: 3 ‚Üí 21 ‚Üí 28 ‚Üí 15 (stable, expected variation)
   - No state loops or races detected
   - Deterministic across repeated runs


---

## üîç –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (19.10.2025)

### –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∞ –Ω–∞ 3650 –¥–Ω–µ–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ **—Ñ–ª–∞–≥–∏ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ –Ω—É–ª–µ–≤—ã–µ**:
- `quota_demount`, `quota_promote_p1`, `quota_promote_p2`, `quota_promote_p3` = 0
- –¶–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è ‚úì
- Gap –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è ‚úì

### –ü—Ä–∏—á–∏–Ω–∞
–í `code/sim_v2/rtc_mp2_writer.py`:
1. **rtc_mp2_write_inactive** ‚Äî —Ñ–ª–∞–≥–∏ **–ª–æ–≥–∏—Ä—É—é—Ç—Å—è** ‚úì
2. **rtc_mp2_write_operations, serviceable, repair, reserve, storage** ‚Äî —Ñ–ª–∞–≥–∏ **–ù–ï –ª–æ–≥–∏—Ä—É—é—Ç—Å—è** ‚ùå

–°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–æ –Ω–µ –ø–∏—à–µ—Ç —Ñ–ª–∞–≥–∏ –≤ `mp2_quota_*` MacroProperties.

### –†–µ—à–µ–Ω–∏–µ (TODO)
–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–æ–≤ –≤–æ –≤—Å–µ 5 —Ñ—É–Ω–∫—Ü–∏–π, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `inactive`:
- –ß–∏—Ç–∞—Ç—å –∏–∑ `mi8_approve`, `mi8_approve_s3/s5/s1` –∏ `mi17_approve*` 
- –ü–∏—Å–∞—Ç—å –≤ `mp2_quota_demount`, `mp2_quota_promote_p1/p2/p3`

**–°—Ç–∞—Ç—É—Å**: ‚è≥ –û–∂–∏–¥–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Ä–æ–±–ª–µ–º—ã —Å `edit_file` tool –≤ Cursor –¥–ª—è —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞)

### –¢–µ—Å—Ç –Ω–∞ 3650 –¥–Ω–µ–π
- **GPU**: 154.22—Å, MP2: 1,042,318 —Å—Ç—Ä–æ–∫
- **AC 24113** –Ω–∞ –¥–Ω–∏ 26-27: –≤—Å–µ —Ñ–ª–∞–≥–∏ = 0 (–Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è)


## üìä –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–∏–∫–∏ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (20.10.2025)

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

–í—Å–µ 6 —Ñ—É–Ω–∫—Ü–∏–π mp2_writer –ª–æ–≥–∏—Ä—É—é—Ç **approve —Ñ–ª–∞–≥–∏** (–≤—ã–±–æ—Ä—ã, –∞ –Ω–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è):
- `mp2_quota_demount` ‚Üê `mi8_approve[]` / `mi17_approve[]`
- `mp2_quota_promote_p1` ‚Üê `mi8_approve_s3[]` / `mi17_approve_s3[]`
- `mp2_quota_promote_p2` ‚Üê `mi8_approve_s5[]` / `mi17_approve_s5[]`
- `mp2_quota_promote_p3` ‚Üê `mi8_approve_s1[]` / `mi17_approve_s1[]`

### üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ COUNT_OPS

**–°–ª–æ–π 1: RESET (—Ç–æ–ª—å–∫–æ idx=0)**
- –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –±–æ—Ä—Ç (idx=0) –æ–±–Ω—É–ª—è–µ—Ç –±—É—Ñ–µ—Ä—ã
- idx ‚Äî –∏–Ω–¥–µ–∫—Å –±–æ—Ä—Ç–∞ –≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ (0-285)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —è–¥—Ä–∞

**–°–ª–æ–∏ 2-5: COUNT_OPS / COUNT_SVC / COUNT_RESERVE / COUNT_INACTIVE**
- –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞—é—Ç –∞–≥–µ–Ω—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç: count[idx] ‚àà {0, 1}

### üîÑ QUOTA_OPS_EXCESS: –î–µ–º–æ—É—Ç –ø—Ä–∏ balance > 0

```
–®–∞–≥ 1: –ü–æ–¥—Å—á—ë—Ç curr –∏ target
  curr = sum(ops_count[])  // –∞–≥–µ–Ω—Ç—ã –≤ operations
  target = mp4_ops_counter[day+1]  // —Ü–µ–ª–µ–≤–æ–µ —á–∏—Å–ª–æ

–®–∞–≥ 2: balance = curr - target

–®–∞–≥ 3: –ï—Å–ª–∏ balance ‚â§ 0 ‚Üí EARLY EXIT (–Ω–µ—Ç –¥–µ–º–æ—É—Ç–∞)
  ‚îî‚îÄ –í—Å–µ –∞–≥–µ–Ω—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –∫ P1/P2/P3

–®–∞–≥ 4: –ï—Å–ª–∏ balance > 0 ‚Üí –î–µ–º–æ—É—Ç K —Å—Ç–∞—Ä—ã—Ö (K = balance)
  ‚îú‚îÄ –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ: oldest_first –ø–æ mfg_date
  ‚îú‚îÄ –î–ª—è —Ç–æ–ø-K –∞–≥–µ–Ω—Ç–æ–≤:
  ‚îÇ  ‚îú‚îÄ intent_state ‚Üê 3 (—Ö–æ–ª–¥–∏–Ω–≥)
  ‚îÇ  ‚îú‚îÄ approve[idx] ‚Üê 1 (–ø–æ–º–µ—á–∞–µ–º –¥–µ–º–æ—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ)
  ‚îÇ  ‚îî‚îÄ –ó–ê–í–ï–†–®–ï–ù–û
  ‚îî‚îÄ –û—Å—Ç–∞–ª—å–Ω—ã–µ: intent –æ—Å—Ç–∞—ë—Ç—Å—è 2
```

### üöÄ QUOTA_PROMOTE: –ö–∞—Å–∫–∞–¥–Ω—ã–π –ø—Ä–æ–º–æ—É—Ç –ø—Ä–∏ balance ‚â§ 0

**P1 (serviceable ‚Üí operations):**
```
deficit_p1 = target - curr
if deficit_p1 ‚â§ 0: EARLY EXIT
else: –≤—ã–±—Ä–∞—Ç—å deficit_p1 –º–æ–ª–æ–¥—ã—Ö –∏–∑ serviceable
  ‚îî‚îÄ approve_s3[idx] ‚Üê 1
```

**P2 (reserve ‚Üí operations):**
```
used_p1 = sum(approve_s3[])  // —Å–∫–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–æ –≤ P1
deficit_p2 = target - curr - used_p1
if deficit_p2 ‚â§ 0: EARLY EXIT
else: –≤—ã–±—Ä–∞—Ç—å deficit_p2 –∏–∑ reserve
  ‚îî‚îÄ approve_s5[idx] ‚Üê 1
```

**P3 (inactive ‚Üí operations):**
```
used_total = sum(approve_s3[]) + sum(approve_s5[])
deficit_p3 = target - curr - used_total
if deficit_p3 ‚â§ 0: EARLY EXIT
else: –≤—ã–±—Ä–∞—Ç—å deficit_p3 –∏–∑ inactive
  ‚îî‚îÄ approve_s1[idx] ‚Üê 1
```

### üîë –ö–ª—é—á–µ–≤—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **XOR —Å–≤–æ–π—Å—Ç–≤–æ:** `demount XOR (P1 ‚à® P2 ‚à® P3)`
   - –ê–≥–µ–Ω—Ç –ª–∏–±–æ –¥–µ–º–æ—Ç–∏—Ä—É–µ—Ç—Å—è, –ª–∏–±–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–º–æ—Ç–∏—Ä–æ–≤–∞–Ω, –Ω–æ –Ω–µ –æ–±–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

2. **–≠–∫–∑–µ–∫—É—Ü–∏—è balance > 0:** –ü—Ä–∏ –∏–∑–±—ã—Ç–∫–µ EARLY EXIT –¥–ª—è P1/P2/P3
   - –î–µ—Ñ–∏—Ü–∏—Ç –∏ –ø—Ä–æ—Ñ–∏—Ü–∏—Ç –ù–ò–ö–û–ì–î–ê –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

3. **Cascading –º–µ—Ö–∞–Ω–∏–∑–º:** P2 —á–∏—Ç–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç P1, P3 —á–∏—Ç–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã P1+P2
   - –ë–µ–∑ –¥–≤–æ–π–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞ —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

---

## –ú–æ–¥—É–ª—å quota_repair (–¥–æ–±–∞–≤–ª–µ–Ω–æ 20-11-2025)

### –°—Ç–∞—Ç—É—Å
‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û** (3650 –¥–Ω–µ–π, –≤—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã)

### –û–ø–∏—Å–∞–Ω–∏–µ
–ú–æ–¥—É–ª—å –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–æ–≤ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤ —Ç–∏–ø–∞ (–ø–ª–∞–Ω–µ—Ä—ã Mi-8/Mi-17) –≤ —Ä–µ–º–æ–Ω—Ç–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ –∑–Ω–∞—á–µ–Ω–∏—è `repair_number` –∏–∑ MP1 (`md_components`).

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è:** "Youngest first" (–±–æ–ª—å—à–∏–π `idx` = –º–æ–ª–æ–∂–µ –ø–æ `mfg_date`)
- **–ö–∞—Å–∫–∞–¥–Ω–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ:** –°–Ω–∞—á–∞–ª–∞ –∞–≥–µ–Ω—Ç—ã –∏–∑ –æ—á–µ—Ä–µ–¥–∏ (reserve&0), –∑–∞—Ç–µ–º –Ω–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã (operations&4)
- **–û—á–µ—Ä–µ–¥—å:** –û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ `reserve` —Å `intent=0` (–æ–∂–∏–¥–∞–Ω–∏–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –∫–≤–æ—Ç—ã)

### –ö–ª—é—á–µ–≤—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

**INV-QUOTA-REPAIR-1:** –ö–≤–æ—Ç–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∞
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –º–∞–∫—Å–∏–º—É–º –∞–≥–µ–Ω—Ç–æ–≤ –≤ —Ä–µ–º–æ–Ω—Ç–µ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç repair_number
SELECT 
    day_u16,
    COUNT(*) as in_repair
FROM sim_masterv2
WHERE state = 'repair' AND group_by IN (1, 2)
GROUP BY day_u16
ORDER BY in_repair DESC
LIMIT 1;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: in_repair ‚â§ 18 (—Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ repair_number –¥–ª—è –ø–ª–∞–Ω–µ—Ä–æ–≤)
```

**INV-QUOTA-REPAIR-2:** –ù–µ—Ç –¥–Ω–µ–π —Å –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ–º
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ—Ç –¥–Ω–µ–π –≥–¥–µ –∫–≤–æ—Ç–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∞
SELECT COUNT(*) as days_exceeded
FROM (
    SELECT day_u16, COUNT(*) as in_repair
    FROM sim_masterv2
    WHERE state = 'repair' AND group_by IN (1, 2)
    GROUP BY day_u16
    HAVING in_repair > 18
);
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

**INV-QUOTA-REPAIR-3:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å `repair_number_by_idx`
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ –ø–ª–∞–Ω–µ—Ä—ã –∏–º–µ—é—Ç repair_number > 0
-- (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö orchestrator –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: "–ê–≥–µ–Ω—Ç–æ–≤ —Å repair_number > 0: 279/340" (–¥–ª—è —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö)
```

**INV-QUOTA-REPAIR-4:** –û—á–µ—Ä–µ–¥—å —Ä–∞–±–æ—Ç–∞–µ—Ç (reserve & intent=0)
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∞–≥–µ–Ω—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ—á–µ—Ä–µ–¥—å
SELECT 
    day_u16,
    COUNT(*) as queue_size
FROM sim_masterv2
WHERE state = 'reserve' AND intent_state = 0 AND group_by IN (1, 2)
GROUP BY day_u16
ORDER BY queue_size DESC
LIMIT 5;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: queue_size > 0 –≤ –¥–Ω–∏ –ø–∏–∫–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
-- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∫–≤–æ—Ç–µ –æ—á–µ—Ä–µ–¥—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–∞ (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ–¥–æ–±—Ä—è—é—Ç—Å—è)
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (3650 –¥–Ω–µ–π, 20-11-2025)

| –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ó–Ω–∞—á–µ–Ω–∏–µ | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|----------|--------|
| **INV-QUOTA-REPAIR-1** | ‚úÖ | max=18 | –î–µ–Ω—å 2362, –∫–≤–æ—Ç–∞ —Å–æ–±–ª—é–¥–µ–Ω–∞ |
| **INV-QUOTA-REPAIR-2** | ‚úÖ | 0 –¥–Ω–µ–π | –ù–µ—Ç –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π –∑–∞ 3650 –¥–Ω–µ–π |
| **INV-QUOTA-REPAIR-3** | ‚úÖ | 279/340 | –í—Å–µ –ø–ª–∞–Ω–µ—Ä—ã —Å repair_number=18 |
| **INV-QUOTA-REPAIR-4** | ‚úÖ | 0 –≤ –æ—á–µ—Ä–µ–¥–∏ | –ö–≤–æ—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∞) |

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- Baseline –º–∞–∫—Å–∏–º—É–º: 20 –∞–≥–µ–Ω—Ç–æ–≤
- –° quota_repair: 18 –∞–≥–µ–Ω—Ç–æ–≤ (**-10%**)
- 155 –¥–Ω–µ–π –Ω–∞ –ø–æ–ª–Ω–æ–π –∫–≤–æ—Ç–µ
- 167 –æ–¥–æ–±—Ä–µ–Ω–∏–π, 0 –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π

**–í—ã–≤–æ–¥:** –ö–≤–æ—Ç–∞ 18 –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏. –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø–∏–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã.

### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ —Ç–µ—Å—Ç–∞–º –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ `quota_repair` –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö: `validation.md`, `rtc_pipeline_architecture.md`, `changelog.md`, `README.md`.

4. **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –î–µ–º–æ—É—Ç: `oldest_first` (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è mfg_date)
   - –ü—Ä–æ–º–æ—É—Ç: `youngest_first` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è mfg_date)

5. **–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º:** –û–¥–Ω–∏ –∏ —Ç–µ –∂–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –Ω–∞ 3650 –¥–Ω–µ–π

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ–º–æ—É—Ç–æ–≤:**
- –í—Å–µ–≥–æ –¥–µ–º–æ—É—Ç–æ–≤: **63,801** (6.12% –æ—Ç –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π)
- Mi-8 –¥–µ–º–æ—É—Ç–æ–≤: 42,920
- Mi-17 –¥–µ–º–æ—É—Ç–æ–≤: 20,881

**–í—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–∞–∑–≤—ë—Ä—Ç–∫–∞:**
- –î–Ω–∏ 0-179: 0 –¥–µ–º–æ—É—Ç–æ–≤ (–Ω–µ—Ç –∏–∑–±—ã—Ç–∫–∞ –≤ operations)
- –î–Ω–∏ 180-3649: –¥–µ–º–æ—É—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç balance)
- –î–µ–Ω—å 180: –ü–µ—Ä–≤—ã–µ –¥–µ–º–æ—É—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä AC 22482:**
- –î–µ–Ω—å 180: `quota_demount=1, state=serviceable, intent=3` ‚Üê –¥–µ–º–æ—É—Ç –ø—Ä–æ–∏–∑–æ—à–µ–ª
- –î–Ω–∏ 181+: –æ—Å—Ç–∞–µ—Ç—Å—è –≤ serviceable —Å intent=3, –∂–¥–µ—Ç —Ä–µ—à–µ–Ω–∏—è (cold holding)

### ‚úÖ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–∞—Ç–∞ |
|-----------|--------|------|
| COUNT_OPS —Å RESET | ‚úÖ | 20.10 |
| QUOTA_OPS_EXCESS (–¥–µ–º–æ—É—Ç) | ‚úÖ | 20.10 |
| QUOTA_PROMOTE_SERVICEABLE (P1) | ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ | 20.10 |
| QUOTA_PROMOTE_RESERVE (P2) | ‚úÖ | 20.10 |
| QUOTA_PROMOTE_INACTIVE (P3) | ‚úÖ | 20.10 |
| MP2 –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ approve —Ñ–ª–∞–≥–æ–≤ | ‚úÖ | 20.10 |
| –ü–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ v3 | ‚úÖ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ | 20.10 |
| MP4 quota_target —á–µ—Ä–µ–∑ Python | ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ | 21.10 |
| active_trigger –ª–æ–≥–∏–∫–∞ | ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ | 21.10 |
| –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π MAX_FRAMES | ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ | 21.10 |

---

## üêõ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥—Ñ–∏–∫—Å: active_trigger —Å–±—Ä–æ—Å (21.10.2025)

### –ü—Ä–æ–±–ª–µ–º–∞
`active_trigger` –¥–æ–ª–∂–µ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –≤ `1` –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ `inactive ‚Üí operations` (1‚Üí2) –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ (—á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å DAG —Ü–∏–∫–ª—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –Ω–∞ GPU). –¢—Ä–∏–≥–≥–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è –≤ `0` –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:**
- 549 –∑–∞–ø–∏—Å–µ–π —Å `active_trigger=1` –≤ –±–∞–∑–µ –ø—Ä–∏ 26 –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö 1‚Üí2
- –¢—Ä–∏–≥–≥–µ—Ä –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–ª—Å—è –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏–ª–∏ –∏–∑ `operations` –≤ –¥—Ä—É–≥–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü—Ä–∏—á–∏–Ω–∞
–°–±—Ä–æ—Å `active_trigger` –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `rtc_apply_2_to_2` (staying in operations). –ê–≥–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ 1‚Üí2 —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏–ª–∏ –≤ `repair` (2‚Üí4), `serviceable` (2‚Üí3) –∏–ª–∏ `storage` (2‚Üí6), –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é —Å–±—Ä–æ—Å–∞.

### –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω —Å–±—Ä–æ—Å `active_trigger` –≤–æ **–≤—Å–µ** —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∏–∑ `operations`:
- `rtc_apply_2_to_2` (operations ‚Üí operations)
- `rtc_apply_2_to_3` (operations ‚Üí serviceable)
- `rtc_apply_2_to_4` (operations ‚Üí repair)
- `rtc_apply_2_to_6` (operations ‚Üí storage)

### –í–∞–ª–∏–¥–∞—Ü–∏—è
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
SELECT COUNT(*) FROM sim_masterv2 WHERE active_trigger = 1;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 26 (—Ä–æ–≤–Ω–æ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ 1‚Üí2)

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ 1‚Üí2
SELECT COUNT(*) FROM sim_masterv2 t1
JOIN sim_masterv2 t2 ON t1.aircraft_number = t2.aircraft_number AND t2.day_u16 = t1.day_u16 + 1
WHERE t1.state = 'inactive' AND t2.state = 'operations';
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 26
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —É—Ä–æ–∫
**–°–±—Ä–æ—Å —Ñ–ª–∞–≥–æ–≤/—Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤–æ –í–°–ï–• –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—É—Ç—è—Ö –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è**, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º "–æ—Å–Ω–æ–≤–Ω–æ–º" –ø—É—Ç–∏. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∞–≥–µ–Ω—Ç–∞.

## üêõ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥—Ñ–∏–∫—Å: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±–Ω—É–ª–µ–Ω–∏—è ppr –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ 1‚Üí2 (21.10.2025)

### –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û**

### –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ `inactive ‚Üí operations` (1‚Üí2) –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `ppr` (–º–µ–∂—Ä–µ–º–æ–Ω—Ç–Ω—ã–π —Ä–µ—Å—É—Ä—Å) –Ω–µ –æ–±–Ω—É–ª—è–ª–∞—Å—å. –ê–≥–µ–Ω—Ç—ã –Ω–∞—á–∏–Ω–∞–ª–∏ –Ω–æ–≤—ã–π —Ü–∏–∫–ª —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —Å –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–æ–º –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ü–∏–∫–ª–∞.

**–ü—Ä–∏–º–µ—Ä:** AC 22490
- –î–µ–Ω—å 299: `state=1` (inactive), `ppr=269,956`
- –î–µ–Ω—å 300: `state=2` (operations), `ppr=269,956` ‚ùå (–Ω–µ –æ–±–Ω—É–ª—ë–Ω!)
- –î–µ–Ω—å 301: `state=4` (repair), `ppr=270,084` (–ø—Ä–µ–≤—ã—Å–∏–ª `oh=270,000`)

### –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–Ω—É–ª–µ–Ω–∏–µ `ppr=0` –≤ —Ñ—É–Ω–∫—Ü–∏—é `rtc_apply_1_to_2`:
```cpp
// ‚úÖ –ö–†–ò–¢–ò–ß–ù–û: –û–±–Ω—É–ª—è–µ–º ppr –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ inactive –≤ operations
FLAMEGPU->setVariable<unsigned int>("ppr", 0u);
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –¢–µ—Å—Ç 365 –¥–Ω–µ–π: –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã 2‚Üí4 –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ –¢–µ—Å—Ç 3650 –¥–Ω–µ–π: –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã 2‚Üí4 –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, –≤—Ä–µ–º—è 97.61—Å

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç
> **–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ 1‚Üí2 (inactive‚Üíoperations) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ `ppr=0`**

---

## üêõ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥—Ñ–∏–∫—Å: –•–∞—Ä–¥–∫–æ–¥ MAX_FRAMES=286 (21.10.2025)

### –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û** ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ MacroProperty

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ 03.01.2026:** –í–≤–µ–¥—ë–Ω **RTC_MAX_FRAMES=400** ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ RTC —è–¥–µ—Ä. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π –∫—ç—à —è–¥–µ—Ä –¥–ª—è –≤—Å–µ—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.

### –ü—Ä–æ–±–ª–µ–º–∞ (v1)
–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å —Å 286 –Ω–∞ 285, –Ω–æ —Å–∏–º—É–ª—è—Ü–∏—è –ø–∞–¥–∞–ª–∞ —Å –æ—à–∏–±–∫–æ–π –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ `mp5_lin`: `(1144286, 1, 1, 1) != (1140285, 1, 1, 1)`.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –•–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `MAX_FRAMES` –∏ `MAX_SIZE` –≤ `model_build.py` –∏ `rtc_state_2_operations.py`.

### –ü—Ä–æ–±–ª–µ–º–∞ (v2 ‚Äî 03.01.2026)
–ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–µ–∂–¥—É –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏ (v_2025-07-04 –∏ v_2025-12-30) RTC —è–¥—Ä–∞ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å, —Ç.–∫. —Ä–∞–∑–º–µ—Ä—ã MacroProperty –∑–∞–≤–∏—Å–µ–ª–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–≥–µ–Ω—Ç–æ–≤ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 114√ó2 = 228 —Ñ–∞–π–ª–æ–≤ –≤ –∫—ç—à–µ –≤–º–µ—Å—Ç–æ 114.

### –†–µ—à–µ–Ω–∏–µ (v2)
1. `model_build.py` ‚Äî –≤–≤–µ–¥—ë–Ω `RTC_MAX_FRAMES = 400` (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è RTC)
2. –í—Å–µ RTC –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `model_build.RTC_MAX_FRAMES` –¥–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ MacroProperty
3. Runtime `frames_total` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ Environment –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —è–¥–µ—Ä

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –î–∞—Ç–∞—Å–µ—Ç 2025-07-04 (335 –∞–≥–µ–Ω—Ç–æ–≤): ‚úÖ **75.64—Å** (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫, –∫–æ–º–ø–∏–ª—è—Ü–∏—è)
- –î–∞—Ç–∞—Å–µ—Ç 2025-12-30 (341 –∞–≥–µ–Ω—Ç): ‚úÖ **6.22—Å** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à)
- –§–∞–π–ª–æ–≤ –≤ –∫—ç—à–µ: **114** (–Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç–∞—Å–µ—Ç–∞)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø
> **–†–∞–∑–º–µ—Ä—ã MacroProperty –¥–ª—è RTC —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã** (`RTC_MAX_FRAMES=400`), —á—Ç–æ–±—ã —è–¥—Ä–∞ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å –µ–¥–∏–Ω–æ–∂–¥—ã. –†–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤ (`frames_total`) –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ Environment –¥–ª—è runtime-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏.

---

## üêõ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥—Ñ–∏–∫—Å: quota_target –æ–±–Ω—É–ª–µ–Ω–∏–µ (21.10.2025)

### –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –æ—à–∏–±–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RTC –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞
**–°–∏–º–ø—Ç–æ–º:** –ó–Ω–∞—á–µ–Ω–∏—è `quota_target_mi17` –≤ —Ç–∞–±–ª–∏—Ü–µ `sim_masterv2` –æ–±–Ω—É–ª—è–ª–∏—Å—å –Ω–∞—á–∏–Ω–∞—è —Å –¥–Ω—è 361, —Ö–æ—Ç—è –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `flight_program_ac` –±—ã–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (108‚Üí105).

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
- RTC —Ñ—É–Ω–∫—Ü–∏—è `rtc_log_mp4_targets` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤**
- –ù–∞ –¥–µ–Ω—å 361 –≤—Å–µ –∞–≥–µ–Ω—Ç—ã Mi-17 –ø–µ—Ä–µ—Ö–æ–¥–∏–ª–∏ –∏–∑ `operations` –≤ –¥—Ä—É–≥–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ö –º–æ–º–µ–Ω—Ç—É –≤—ã–∑–æ–≤–∞ —Å–ª–æ—è `log_mp4_targets` –∞–≥–µ–Ω—Ç–æ–≤ Mi-17 –≤ –Ω—É–∂–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —É–∂–µ –Ω–µ –±—ã–ª–æ
- –§—É–Ω–∫—Ü–∏—è –Ω–µ –≤—ã–∑—ã–≤–∞–ª–∞—Å—å ‚Üí `mp2_mp4_target_mi17[361]` –æ—Å—Ç–∞–≤–∞–ª—Å—è –Ω—É–ª—ë–º ‚ùå

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```
–î–µ–Ω—å 360: Mi-17 (idx 165) –≤ operations ‚Üí rtc_log_mp4_targets –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è ‚Üí quota_target=108 ‚úÖ
–î–µ–Ω—å 361: –í—Å–µ Mi-17 –¥–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã ‚Üí rtc_log_mp4_targets –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è ‚Üí quota_target=0 ‚ùå
```

### –†–µ—à–µ–Ω–∏–µ

#### `code/sim_v2/mp2_drain_host.py`
‚úÖ **–ß–∏—Ç–∞–µ–º `quota_target` –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `mp4_ops_counter` –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ Python**
- –ó–∞–º–µ–Ω–∏–ª–∏ —á—Ç–µ–Ω–∏–µ `mp2_mp4_target_mi8/mi17` (MacroProperty) –Ω–∞ –ø—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –∏–∑ `mp4_ops_counter_mi8/mi17` (PropertyArray)
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_get_mp4_target()` —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º `safe_day` –ª–æ–≥–∏–∫–∏:
  ```python
  def _get_mp4_target(self, mp4_array, day: int, days_total: int) -> int:
      """–ü–æ–ª—É—á–∞–µ—Ç —Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ mp4_ops_counter —Å safe_day –ª–æ–≥–∏–∫–æ–π"""
      if mp4_array is None:
          return 0
      safe_day = (day + 1) if (day + 1) < days_total else (days_total - 1 if days_total > 0 else 0)
      return int(mp4_array[safe_day])
  ```
- –¶–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å **–≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã**, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤

#### `code/sim_v2/rtc_quota_count_ops.py`
‚úÖ **–ü–æ–º–µ—á–µ–Ω–∞ RTC —Ñ—É–Ω–∫—Ü–∏—è –∫–∞–∫ DEPRECATED**
- `rtc_log_mp4_targets` –±–æ–ª—å—à–µ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `mp2_mp4_target_*`
- –§—É–Ω–∫—Ü–∏—è –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–µ–∑–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã

### –í–∞–ª–∏–¥–∞—Ü–∏—è

**–¢–µ—Å—Ç:** 365 –¥–Ω–µ–π —Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
```bash
cd code/sim_v2 && python3 orchestrator_v2.py \
  --modules spawn_v2 state_2_operations states_stub count_ops \
            quota_ops_excess quota_promote_serviceable quota_promote_reserve \
            quota_promote_inactive state_manager_operations state_manager_serviceable \
            state_manager_inactive state_manager_repair state_manager_reserve \
            state_manager_storage \
  --steps 365 --enable-mp2 --drop-table
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
[MP2_READ Day 360] mp4_ops_counter_mi17[361] = 108 ‚úÖ
[MP2_READ Day 361] mp4_ops_counter_mi17[362] = 105 ‚úÖ
[MP2_READ Day 362] mp4_ops_counter_mi17[363] = 105 ‚úÖ
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ:**
```sql
SELECT day_u16, quota_target_mi17 
FROM sim_masterv2 
WHERE day_u16 BETWEEN 360 AND 365 AND idx = 163
LIMIT 10;
```
‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (108, 105, 105, ...)

**–¢–µ—Å—Ç:** 3650 –¥–Ω–µ–π (–ø–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω)
- ‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è `quota_target_mi8` –∏ `quota_target_mi17` –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –Ω–∞ –≤—Å–µ—Ö –¥–Ω—è—Ö
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —É—Ä–æ–∫
**–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (per-day) –ù–ï –¥–æ–ª–∂–Ω—ã –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ RTC —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤!**
- RTC —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ Python (HostFunction –∏–ª–∏ –ø—Ä–∏ –¥—Ä–µ–Ω–∞–∂–µ)
- –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `code/sim_v2/mp2_drain_host.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_get_mp4_target()`, –∏–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —á—Ç–µ–Ω–∏—è —Ü–µ–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- `code/sim_v2/rtc_quota_count_ops.py` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `rtc_log_mp4_targets` –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ DEPRECATED
- `docs/changelog.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –æ –±–∞–≥—Ñ–∏–∫—Å–µ
- `docs/validation.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
- `docs/README.md` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

---

## üêõ –ë–∞–≥—Ñ–∏–∫—Å: frames_total_u16 –≤ RTC –º–æ–¥—É–ª—è—Ö (01.01.2026)

### –°—Ç–∞—Ç—É—Å
‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** ‚Äî RTC –º–æ–¥—É–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–∏—Ç–∞—é—Ç —Ä–∞–∑–º–µ—Ä MAX_FRAMES –∏–∑ env_data

### –ü—Ä–æ–±–ª–µ–º–∞
**–°–∏–º–ø—Ç–æ–º:** –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏–º—É–ª—è—Ü–∏–∏ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
FLAMEGPURuntimeException: Environment macro property 'mi17_ops_count' dimensions do not match (340, 1, 1, 1) != (57, 1, 1, 1)
```

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
- –í `sim_env_setup.py` –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `frames_total` —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å –∫–∞–∫ `frames_total_u16`
- RTC –º–æ–¥—É–ª–∏ (`rtc_spawn_dynamic.py`, `rtc_spawn_v2.py`) —á–∏—Ç–∞–ª–∏ `env_data.get('frames_total', 340)`
- –ö–ª—é—á `frames_total` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è fallback `340`
- –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `frames_total_u16` –±—ã–ª–æ –¥—Ä—É–≥–∏–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, 57 –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞)
- –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ MacroProperty –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫—É JIT –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### –†–µ—à–µ–Ω–∏–µ

**–§–∞–π–ª—ã:**
- `code/sim_v2/rtc_modules/rtc_spawn_dynamic.py`
- `code/sim_v2/rtc_modules/rtc_spawn_v2.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:**
```python
# –ë—ã–ª–æ:
MAX_FRAMES = env_data.get('frames_total', 340)

# –°—Ç–∞–ª–æ:
MAX_FRAMES = env_data.get('frames_total_u16', 340)
```

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–±–æ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ (`--version-date` –≤ orchestrator_v2.py)
- –û—á–∏—Å—Ç–∫–∞ RTC –∫—ç—à–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞: `rm -rf .rtc_cache/*`

---

## [31-10-2025] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è sne_new/ppr_new –¥–ª—è spawn –∞–≥—Ä–µ–≥–∞—Ç–æ–≤

### –ö–æ–Ω—Ç–µ–∫—Å—Ç
–î–ª—è spawn –Ω–æ–≤—ã—Ö –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Ä–∞–±–æ—Ç–∫–∞ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ `md_components` (–ø–æ–ª—è `sne_new`, `ppr_new`). –ó–Ω–∞—á–µ–Ω–∏—è –≤ Excel —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **—á–∞—Å–∞—Ö**, —Å–∏–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **–º–∏–Ω—É—Ç–∞—Ö**.

### –ü—Ä–æ–±–ª–µ–º–∞
1. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü:** Excel (—á–∞—Å—ã) ‚Üí –°–£–ë–î (–º–∏–Ω—É—Ç—ã) ‚Üí –°–∏–º—É–ª—è—Ü–∏—è (–º–∏–Ω—É—Ç—ã)
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ NULL:** –ü—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è = "–∞–≥—Ä–µ–≥–∞—Ç –Ω–µ –≤—ã–ø—É—Å–∫–∞–µ—Ç—Å—è"
3. **FLAME GPU –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** Environment –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `Nullable` —Ç–∏–ø—ã
4. **–•–∞—Ä–¥–∫–æ–¥ –≤ RTC:** Spawn –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `sne=0u, ppr=0u` –≤–º–µ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ MP1

### –†–µ—à–µ–Ω–∏–µ

**–≠—Ç–∞–ø 1: ETL (Extract)**
- –§–∞–π–ª: `code/md_components_loader.py`
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `sne_new` –∏ `ppr_new`: —á–∞—Å—ã √ó 60 ‚Üí –º–∏–Ω—É—Ç—ã
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `NULL` —á–µ—Ä–µ–∑ `Nullable(UInt32)` –≤ ClickHouse
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `None`/`NaN` –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ

**–≠—Ç–∞–ø 2: –°–∏–º—É–ª—è—Ü–∏—è (Transform)**
- –§–∞–π–ª: `code/sim_env_setup.py`
  - –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `fetch_mp1_sne_ppr_new()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –°–£–ë–î
  - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `NULL` ‚Üí `SENTINEL` (0xFFFFFFFF) –¥–ª—è FLAME GPU
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ `mp1_sne_new`, `mp1_ppr_new` –≤ Environment

- –§–∞–π–ª: `code/sim_v2/base_model.py`
  - –û–±—ä—è–≤–ª–µ–Ω–∏–µ Environment Property Arrays
  - –°–æ–∑–¥–∞–Ω–∏–µ Environment constants: `mi17_sne_new_const`, `mi17_ppr_new_const`
  - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `SENTINEL` ‚Üí `0` –¥–ª—è RTC –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- –§–∞–π–ª: `code/sim_v2/rtc_modules/rtc_spawn_v2.py`
  - –ó–∞–º–µ–Ω–∞ —Ö–∞—Ä–¥–∫–æ–¥–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏–∑ Environment constants
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏ spawn

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

**–û–±—Ä–∞–±–æ—Ç–∫–∞ NULL –∑–Ω–∞—á–µ–Ω–∏–π:**
- **–°–£–ë–î:** `Nullable(UInt32)` ‚Äî NULL –æ–∑–Ω–∞—á–∞–µ—Ç "–∞–≥—Ä–µ–≥–∞—Ç –Ω–µ –≤—ã–ø—É—Å–∫–∞–µ—Ç—Å—è"
- **FLAME GPU Environment:** Sentinel value `0xFFFFFFFF` (4294967295)
- **RTC –∫–æ–¥:** Sentinel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `0` (–Ω–æ–≤—ã–π –∞–≥—Ä–µ–≥–∞—Ç –±–µ–∑ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏)

**–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è:**
- **Excel –∏—Å—Ç–æ—á–Ω–∏–∫:** —á–∞—Å—ã (4500-7500)
- **ClickHouse –°–£–ë–î:** –º–∏–Ω—É—Ç—ã (270000-450000)
- **–°–∏–º—É–ª—è—Ü–∏—è:** –º–∏–Ω—É—Ç—ã (–≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã –≤ –º–∏–Ω—É—Ç–∞—Ö)

### –í–∞–ª–∏–¥–∞—Ü–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –°–£–ë–î:**
```sql
SELECT partno, sne_new, ppr_new
FROM md_components
WHERE sne_new IS NOT NULL AND sne_new > 0
ORDER BY sne_new
LIMIT 10;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- –¢–í2-117–ê: 270000 –º–∏–Ω—É—Ç (4500 —á–∞—Å–æ–≤) ‚úÖ
- –¢–í3-117–í–ú: 270000 –º–∏–Ω—É—Ç (4500 —á–∞—Å–æ–≤) ‚úÖ
- –ê–ò-9–í: 360000 –º–∏–Ω—É—Ç (6000 —á–∞—Å–æ–≤) ‚úÖ
- –í–†-8–ê: 450000 –º–∏–Ω—É—Ç (7500 —á–∞—Å–æ–≤) ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏:**
- –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω 3650 –¥–Ω–µ–π: ‚úÖ –£—Å–ø–µ—à–Ω–æ
- Spawn –ø–ª–∞–Ω–µ—Ä–æ–≤ (Mi-17): `sne=0, ppr=0` ‚úÖ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –ø–ª–∞–Ω–µ—Ä–æ–≤)
- –í—ã–≥—Ä—É–∑–∫–∞ MP2: 1039632 —Å—Ç—Ä–æ–∫ –∑–∞ 21.71—Å ‚úÖ
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤: ‚úÖ

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

**INV-SNE-PPR-1:** –ó–Ω–∞—á–µ–Ω–∏—è `sne_new` –∏ `ppr_new` –≤ –°–£–ë–î –≤—Å–µ–≥–¥–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫—Ä–∞—Ç–Ω—ã 60 (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ —á–∞—Å–æ–≤)
SELECT partno, sne_new, ppr_new
FROM md_components
WHERE sne_new IS NOT NULL 
  AND sne_new > 0 
  AND sne_new % 60 != 0;
-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 0 —Å—Ç—Ä–æ–∫
```

**INV-SNE-PPR-2:** NULL –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: NULL –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (–Ω–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ 0)
SELECT COUNT(*) as null_count
FROM md_components
WHERE sne_new IS NULL OR ppr_new IS NULL;
-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: > 0 (–µ—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤—ã–ø—É—Å–∫–∞—é—Ç—Å—è)
```

**INV-SNE-PPR-3:** Spawn –∞–≥–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ MP1
- –î–ª—è –ø–ª–∞–Ω–µ—Ä–æ–≤ (group_by=1,2): `sne=0, ppr=0` (–Ω–æ–≤—ã–π –ø–ª–∞–Ω–µ—Ä)
- –î–ª—è –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ (group_by‚â•3): `sne=mp1_sne_new[pidx], ppr=mp1_ppr_new[pidx]`
- –ï—Å–ª–∏ `sne_new` –∏–ª–∏ `ppr_new` = NULL ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `0`

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
1. `code/md_components_loader.py` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–∞—Å–æ–≤‚Üí–º–∏–Ω—É—Ç—ã, –æ–±—Ä–∞–±–æ—Ç–∫–∞ NULL
2. `code/sim_env_setup.py` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ sne_new/ppr_new –≤ MP1 arrays
3. `code/sim_v2/base_model.py` ‚Äî Environment arrays –∏ constants
4. `code/sim_v2/rtc_modules/rtc_spawn_v2.py` ‚Äî —á—Ç–µ–Ω–∏–µ –∏–∑ Environment –≤–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–∞
5. `docs/rtc_components.md` ‚Äî —Ä–∞–∑–¥–µ–ª 6 (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
6. `docs/changelog.md` ‚Äî –∑–∞–ø–∏—Å—å –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
7. `docs/validation.md` ‚Äî –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- `docs/rtc_components.md` ‚Äî –ø–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤
- `.cursorrules` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (–∑–∞–ø—Ä–µ—Ç Float64, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ UInt32)

---

## üìä –ü–æ–ª–µ repair_number –¥–ª—è –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–æ–≤ (13.11.2025)

### –ö–æ–Ω—Ç–µ–∫—Å—Ç

**–ó–∞–¥–∞—á–∞:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –º–æ–¥—É–ª—è –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–µ–º–æ–Ω—Ç–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –ø–æ–ª–µ `repair_number` –≤ —Ç–∞–±–ª–∏—Ü—É `md_components` –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –ø–æ –æ–±—ä–µ–º—É —Ä–µ–º–æ–Ω—Ç–∞.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü–∞ `md_components`:**
- **–ü–æ–ª–µ:** `repair_number Nullable(UInt8)`
- **–ü–æ–∑–∏—Ü–∏—è:** 11 (–º–µ–∂–¥—É `assembly_time` –∏ `repair_time`)
- **–¢–∏–ø:** `UInt8` (–¥–∏–∞–ø–∞–∑–æ–Ω 0-255)
- **Nullable:** –î–∞ (NULL –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ 0)
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** `data_input/master_data/MD_–°omponents.xlsx`, –∫–æ–ª–æ–Ω–∫–∞ "–û–±—ä–µ–º —Ä–µ–º–æ–Ω—Ç–∞" (—Å—Ç–æ–ª–±–µ—Ü 11)

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

**INV-REPAIR-NUMBER-1:** –ü–æ–ª–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã
```sql
SELECT name, type 
FROM system.columns 
WHERE table = 'md_components' AND name = 'repair_number';
-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: repair_number | Nullable(UInt8)
```

**INV-REPAIR-NUMBER-2:** NULL –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
```sql
SELECT 
    COUNT(*) as total,
    SUM(CASE WHEN repair_number IS NULL THEN 1 ELSE 0 END) as null_count,
    SUM(CASE WHEN repair_number IS NOT NULL THEN 1 ELSE 0 END) as not_null_count
FROM md_components;
-- –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: total=37, null_count=37, not_null_count=0
```

**INV-REPAIR-NUMBER-3:** –î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π (–∫–æ–≥–¥–∞ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã)
```sql
SELECT 
    MIN(repair_number) as min_val,
    MAX(repair_number) as max_val
FROM md_components
WHERE repair_number IS NOT NULL;
-- –û–∂–∏–¥–∞–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 0-255 (UInt8)
```

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. **`code/md_components_loader.py`:**
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ DDL —Ç–∞–±–ª–∏—Ü—ã (–¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `repair_number`)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ `prepare_md_data()` –∫–∞–∫ `UInt8 Nullable`
   - –û–±–Ω–æ–≤–ª–µ–Ω `column_order` —Å –Ω–æ–≤—ã–º –ø–æ–ª–µ–º
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ NULL –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ

2. **`code/sim_env_setup.py`:**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `fetch_mp1_repair_number()` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ –°–£–ë–î
   - NULL ‚Üí sentinel value `0xFF (255)` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å FLAME GPU
   - –ú–∞—Å—Å–∏–≤ `mp1_repair_number` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `env_data` –∏ `mp1_arrays`
   - –ó–∞–≥—Ä—É–∑–∫–∞ –≤ —Å–∏–º—É–ª—è—Ü–∏—é —á–µ—Ä–µ–∑ `setEnvironmentPropertyArrayUInt8()`

3. **`code/sim_v2/base_model.py`:**
   - –î–æ–±–∞–≤–ª–µ–Ω Environment array `mp1_repair_number` (UInt8)
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `newPropertyArrayUInt8()`

4. **`docs/changelog.md`:**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (13.11.2025)
   - –û–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å GPU Environment

5. **`docs/validation.md`:**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**Extract –ø–∞–π–ø–ª–∞–π–Ω (–ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª):**
- ‚úÖ –†–µ–∂–∏–º: TEST (–ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)
- ‚úÖ –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 19.1 —Å–µ–∫—É–Ω–¥
- ‚úÖ –£—Å–ø–µ—à–Ω–æ: 13/13 —ç—Ç–∞–ø–æ–≤
- ‚úÖ –í–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö: 2025-07-04 (version_id=1)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—è –≤ –°–£–ë–î:**
- ‚úÖ –ü–æ–ª–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö: `Nullable(UInt8)` ‚úîÔ∏è
- ‚úÖ NULL –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: 37
- ‚úÖ NULL –∑–Ω–∞—á–µ–Ω–∏–π: 37 (100%, –∫–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ MP1:**
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `fetch_mp1_repair_number()` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ NULL ‚Üí sentinel value 255 (0xFF)
- ‚úÖ –ú–∞—Å—Å–∏–≤ `mp1_repair_number` —Å–æ–∑–¥–∞–Ω (37 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- ‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è = 255 (NULL, –∫–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å)
- ‚úÖ Environment array –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Å–∏–º—É–ª—è—Ü–∏—é

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ RTC:**
```cuda
// –ü–æ–ª—É—á–µ–Ω–∏–µ repair_number –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ç–∞ –ø–æ –∏–Ω–¥–µ–∫—Å—É MP1
const unsigned int pidx = mp1_index.get(partseqno, 0u);
const uint8_t repair_num = FLAMEGPU->environment.getProperty<uint8_t>("mp1_repair_number", pidx);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NULL
if (repair_num == 255u) {
    // –ö–≤–æ—Ç–∞ —Ä–µ–º–æ–Ω—Ç–∞ –Ω–µ –∑–∞–¥–∞–Ω–∞
} else {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º repair_num –¥–ª—è –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (0-254)
}
```

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `repair_number` –≤ Excel —Ñ–∞–π–ª–µ `MD_–°omponents.xlsx`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –ø–æ–ª—è
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ RTC —Ñ—É–Ω–∫—Ü–∏—è—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–º–æ–º —Ä–µ–º–æ–Ω—Ç–æ–≤

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- `docs/changelog.md` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `.cursorrules` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

---

## üöÄ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn –ø–ª–∞–Ω–µ—Ä–æ–≤ (08.11.2025)

### –ö–æ–Ω—Ç–µ–∫—Å—Ç

**–ó–∞–¥–∞—á–∞:** –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –ø–ª–∞–Ω–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –∫–≤–æ—Ç P1/P2/P3

**–ü—Ä–æ–±–ª–µ–º–∞:** 
- –ö –∫–æ–Ω—Ü—É —Å–∏–º—É–ª—è—Ü–∏–∏ (3650 –¥–Ω–µ–π) –¥–µ—Ñ–∏—Ü–∏—Ç –¥–æ—Å—Ç–∏–≥–∞–ª -31 –ø–ª–∞–Ω–µ—Ä–∞
- –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ P1/P2/P3 –Ω–µ –ø–æ–∫—Ä—ã–≤–∞–ª–æ –¥–µ—Ñ–∏—Ü–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –¢—Ä–µ–±–æ–≤–∞–ª—Å—è –º–µ—Ö–∞–Ω–∏–∑–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- –ù–æ–≤—ã–π –º–æ–¥—É–ª—å: `code/sim_v2/rtc_modules/rtc_spawn_dynamic.py`
- –°–ª–æ–π 7.5: –º–µ–∂–¥—É P3 quota –∏ state_manager
- –î–≤–∞ –∞–≥–µ–Ω—Ç–∞-—É—Ç–∏–ª–∏—Ç—ã: `spawn_dynamic_mgr` (–º–µ–Ω–µ–¥–∂–µ—Ä) –∏ `spawn_dynamic_ticket` (—Ç–∏–∫–µ—Ç—ã)

**–õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ (–∫–∞—Å–∫–∞–¥–Ω–∞—è, –∫–∞–∫ –≤ P1/P2/P3):**
```cuda
deficit = target - curr - used
–≥–¥–µ:
  target = mp4_ops_counter_mi17[day]  // –¶–µ–ª–µ–≤–∞—è –∫–≤–æ—Ç–∞ –∏–∑ MP4
  curr = count(mi17_ops_count == 1)   // –¢–µ–∫—É—â–∏–µ –≤ operations
  used = sum(approve_s3, approve_s5, approve_s1)  // –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ P1+P2+P3
```

**–£—Å–ª–æ–≤–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**
- `day >= repair_time` (180 –¥–Ω–µ–π –¥–ª—è Mi-17)
- `deficit > 0` –ø–æ—Å–ª–µ P3

**–°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤:**
- **–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** `operations` (–ø—Ä—è–º–æ–π —Å–ø–∞–≤–Ω, intent=0)
- **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫

### –≠–≤–æ–ª—é—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è

| –í–µ—Ä—Å–∏—è | –°–æ—Å—Ç–æ—è–Ω–∏–µ | intent_state | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|--------|-----------|--------------|-----------|
| **v1** | serviceable | 2 (approved) | –ó–∞–¥–µ—Ä–∂–∫–∞ 1-108 –¥–Ω–µ–π, –ø—Ä–æ–º–∞—Ä–≥–∏–≤–∞–Ω–∏—è -1 ‚ùå |
| **v2 (—Ñ–∏–Ω–∞–ª)** | operations | 0 (no intent) | –ó–∞–¥–µ—Ä–∂–∫–∞ 0 –¥–Ω–µ–π, –Ω–µ—Ç –ø—Ä–æ–º–∞—Ä–≥–∏–≤–∞–Ω–∏–π ‚úÖ |

**–ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- v1: –ê–≥–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –≤ `serviceable&intent=2`, –ø–µ—Ä–µ—Ö–æ–¥–∏–ª–∏ –≤ `operations` —á–µ—Ä–µ–∑ `state_manager` –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
- v2: –ê–≥–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å—Ä–∞–∑—É –≤ `operations`, –ø–æ–ª—É—á–∞—é—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤ —Ç–æ—Ç –∂–µ –¥–µ–Ω—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è (—Ç–µ—Å—Ç 3650 –¥–Ω–µ–π)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spawn: 6 –∞–≥–µ–Ω—Ç–æ–≤ (100000-100005) –≤ –¥–µ–Ω—å 103
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn: —Ä–µ–∑–µ—Ä–≤ 55 —Å–ª–æ—Ç–æ–≤ (100006+)
- –£—Å–ª–æ–≤–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: day >= 180

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–æ | 31 –∏–∑ 55 | ‚úÖ 56.4% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ |
| –†–µ–∑–µ—Ä–≤ –æ—Å—Ç–∞–ª—Å—è | 24 —Å–ª–æ—Ç–∞ | ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–µ–Ω |
| –ó–∞–¥–µ—Ä–∂–∫–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ operations | 0 –¥–Ω–µ–π (100%) | ‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| –î–Ω–µ–π —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –±–∞–ª–∞–Ω—Å–æ–º | 0 | ‚úÖ –ù–µ—Ç –ø—Ä–æ–º–∞—Ä–≥–∏–≤–∞–Ω–∏–π -1 |
| –ü–µ—Ä–≤—ã–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn | –î–µ–Ω—å 823 | ‚úÖ –ü–æ—Å–ª–µ repair_time=180 |
| –ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn | –î–µ–Ω—å 3640 | ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–æ –∫–æ–Ω—Ü–∞ |

**–î–µ—Ç–∞–ª–∏ spawn:**
```
ACN    | Birth | First Ops | –ó–∞–¥–µ—Ä–∂–∫–∞
-------|-------|-----------|----------
100006 |   823 |       823 | 0 –¥–Ω. ‚úÖ
100007 |   829 |       829 | 0 –¥–Ω. ‚úÖ
100008 |   848 |       848 | 0 –¥–Ω. ‚úÖ
...
100036 |  3640 |      3640 | 0 –¥–Ω. ‚úÖ
```

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

**INV-SPAWN-DYN-1:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π spawn –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ repair_time
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö spawn –¥–æ repair_time
SELECT COUNT(*) 
FROM sim_masterv2 
WHERE aircraft_number >= 100006 
  AND group_by = 2
  AND day_u16 < 180;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

**INV-SPAWN-DYN-2:** –ó–∞–¥–µ—Ä–∂–∫–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ operations = 0
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞–≥–µ–Ω—Ç—ã –≤—Å—Ç—É–ø–∞—é—Ç –≤ operations –≤ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è
WITH spawn_days AS (
    SELECT 
        aircraft_number,
        MIN(day_u16) as birth_day,
        MIN(day_u16) FILTER (WHERE state = 'operations') as first_ops_day
    FROM sim_masterv2
    WHERE aircraft_number >= 100006 AND group_by = 2
    GROUP BY aircraft_number
)
SELECT COUNT(*) 
FROM spawn_days 
WHERE first_ops_day - birth_day != 0;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0
```

**INV-SPAWN-DYN-3:** –†–µ–∑–µ—Ä–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è 10 –ª–µ—Ç
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ < 100% —Ä–µ–∑–µ—Ä–≤–∞
SELECT COUNT(DISTINCT aircraft_number) as spawned
FROM sim_masterv2
WHERE aircraft_number >= 100006 AND group_by = 2;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: < 55 (—Ä–µ–∑–µ—Ä–≤)
```

**INV-SPAWN-DYN-4:** –ù–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è ACN —Å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º spawn
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (100000-100005) –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ (100006+) –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è
SELECT aircraft_number, COUNT(*) as cnt
FROM sim_masterv2
WHERE aircraft_number BETWEEN 100000 AND 100005
  AND group_by = 2
GROUP BY aircraft_number
HAVING cnt > 0;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: —Ä–æ–≤–Ω–æ 6 –∞–≥–µ–Ω—Ç–æ–≤ (100000-100005)
```

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. `code/sim_v2/rtc_modules/rtc_spawn_dynamic.py` ‚Äî –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn
2. `code/sim_v2/orchestrator_v2.py` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è –≤ –ø–∞–π–ø–ª–∞–π–Ω (—Å–ª–æ–π 7.5)
3. `code/sim_env_setup.py` ‚Äî —Ä–∞—Å—á—ë—Ç —Ä–µ–∑–µ—Ä–≤–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ spawn
4. `code/sim_v2/base_model.py` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Environment properties –¥–ª—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç
5. `docs/spawn_dynamic_architecture.md` ‚Äî –ø–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
6. `docs/changelog.md` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
7. `docs/validation.md` ‚Äî –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `docs/spawn_dynamic_architecture.md` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ spawn
- `docs/rtc_pipeline_architecture.md` ‚Äî –æ–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
- `.cursorrules` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (state-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∫–∞—Å–∫–∞–¥–Ω–æ–µ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## üöÄ LIMITER –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–≤–µ—Ç–∫–∞ feature/flame-messaging, 10-01-2026)

### –°—Ç–∞—Ç—É—Å
‚úÖ **–í–ê–õ–ò–î–ò–†–û–í–ê–ù** ‚Äî 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ baseline –ø–æ –≤—Å–µ–º –º–µ—Ç—Ä–∏–∫–∞–º

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
LIMITER ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ —Å adaptive time step –∏ event-driven –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
- **Limiter date:** –ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç –≤—ã—á–∏—Å–ª—è–µ—Ç –¥–∞—Ç—É –∏—Å—Ç–æ—â–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞ (min(LL-SNE, OH-PPR) / avg_dt)
- **Event-driven:** –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–ª–∏ –≤—ã–±—ã—Ç–∏–∏ –∞–≥–µ–Ω—Ç–∞
- **GPU-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ GPU, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ host-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å BASELINE (DS1: 2025-07-04, 3650 –¥–Ω–µ–π)

| –ú–µ—Ç—Ä–∏–∫–∞ | BASELINE | LIMITER | DIFF |
|---------|----------|---------|------|
| **–í—Ä–µ–º—è** | ~75—Å | **48—Å** | **-36%** |
| **GPU –≤—Ä–µ–º—è** | ~34—Å | ~27—Å | **-21%** |
| **Drain –≤—Ä–µ–º—è** | ~38—Å | ~21—Å | **-45%** |
| **–ü–µ—Ä–µ—Ö–æ–¥—ã** | 1,352 | 1,352 | **0** |
| **–ó–∞–ø–∏—Å–µ–π** | 1,098,816 | 1,098,816 | **0** |

### –ü–µ—Ä–µ—Ö–æ–¥—ã (100% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)

| –ü–µ—Ä–µ—Ö–æ–¥ | LIMITER | BASELINE | DIFF |
|---------|---------|----------|------|
| serviceable ‚Üí operations | 355 | 355 | 0 |
| operations ‚Üí serviceable | 344 | 344 | 0 |
| repair ‚Üí reserve | 198 | 198 | 0 |
| reserve ‚Üí operations | 181 | 181 | 0 |
| operations ‚Üí repair | 172 | 172 | 0 |
| operations ‚Üí storage | 29 | 29 | 0 |
| operations ‚Üí reserve | 22 | 22 | 0 |
| reserve ‚Üí repair | 22 | 22 | 0 |
| repair ‚Üí operations | 16 | 16 | 0 |
| inactive ‚Üí repair | 13 | 13 | 0 |
| **–ò–¢–û–ì–û** | **1,352** | **1,352** | **0** |

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º (100% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)

| State | LIMITER | BASELINE | DIFF |
|-------|---------|----------|------|
| operations | 577,193 | 577,193 | 0 |
| inactive | 353,117 | 353,117 | 0 |
| reserve | 62,856 | 62,856 | 0 |
| serviceable | 37,683 | 37,683 | 0 |
| repair | 36,843 | 36,843 | 0 |
| storage | 31,124 | 31,124 | 0 |
| **–ò–¢–û–ì–û** | **1,098,816** | **1,098,816** | **0** |

### SNE/PPR –Ω–∞ –¥–µ–Ω—å 3649 (100% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)

| State | LIM_SNE | BAS_SNE | LIM_PPR | BAS_PPR |
|-------|---------|---------|---------|---------|
| inactive | 125,706,987 | 125,706,987 | 14,824,005 | 14,824,005 |
| operations | 134,433,818 | 134,433,818 | 23,627,936 | 23,627,936 |
| repair | 1,619,220 | 1,619,220 | 1,079,678 | 1,079,678 |
| reserve | 20,234,590 | 20,234,590 | 0 | 0 |
| storage | 36,327,412 | 36,327,412 | 6,793,558 | 6,793,558 |

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã LIMITER

**INV-LIMITER-1:** –ü–µ—Ä–µ—Ö–æ–¥—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã baseline
```sql
-- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É LIMITER –∏ BASELINE
WITH 
  limiter_trans AS (
    SELECT l1.state as from_state, l2.state as to_state, count() as cnt
    FROM sim_masterv2_limiter l1
    JOIN sim_masterv2_limiter l2 ON l1.idx = l2.idx AND l1.day_u16 + 1 = l2.day_u16
    WHERE l1.state != l2.state
    GROUP BY from_state, to_state
  ),
  baseline_trans AS (
    SELECT b1.state as from_state, b2.state as to_state, count() as cnt
    FROM sim_masterv2 b1
    JOIN sim_masterv2 b2 ON b1.idx = b2.idx AND b1.day_u16 + 1 = b2.day_u16
    WHERE b1.state != b2.state AND b1.version_date = 20273
    GROUP BY from_state, to_state
  )
SELECT * FROM limiter_trans l
FULL OUTER JOIN baseline_trans b ON l.from_state = b.from_state AND l.to_state = b.to_state
WHERE coalesce(l.cnt, 0) != coalesce(b.cnt, 0);
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0 —Å—Ç—Ä–æ–∫ (–≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç)
```

**INV-LIMITER-2:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π —Å–æ–≤–ø–∞–¥–∞–µ—Ç
```sql
SELECT 
    (SELECT count() FROM sim_masterv2_limiter) as limiter_count,
    (SELECT count() FROM sim_masterv2 WHERE version_date = 20273) as baseline_count;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: –æ–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–≤–Ω—ã (1,098,816)
```

**INV-LIMITER-3:** SNE/PPR –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –¥–µ–Ω—å —Å–æ–≤–ø–∞–¥–∞—é—Ç
```sql
SELECT 
    l.state,
    sum(l.sne) as lim_sne, sum(b.sne) as bas_sne,
    sum(l.ppr) as lim_ppr, sum(b.ppr) as bas_ppr
FROM sim_masterv2_limiter l
JOIN sim_masterv2 b ON l.idx = b.idx AND l.day_u16 = b.day_u16
WHERE l.day_u16 = 3649 AND b.version_date = 20273
GROUP BY l.state;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: –≤—Å–µ –ø–∞—Ä—ã lim_*/bas_* —Ä–∞–≤–Ω—ã
```

**INV-LIMITER-4:** quota_repair —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: repair_number=18 –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –ø–ª–∞–Ω–µ—Ä–æ–≤
SELECT day_u16, count() as in_repair
FROM sim_masterv2_limiter
WHERE state = 'repair'
GROUP BY day_u16
ORDER BY in_repair DESC
LIMIT 1;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: in_repair <= 18
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `code/sim_v2/messaging/orchestrator_limiter.py` | –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä LIMITER |
| `code/sim_v2/messaging/rtc_limiter_date.py` | –†–∞—Å—á—ë—Ç limiter_date |
| `code/sim_v2/messaging/rtc_batch_operations.py` | –ü–∞–∫–µ—Ç–Ω—ã–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã |
| `code/sim_v2/messaging/base_model_messaging.py` | –ú–æ–¥–µ–ª—å –∞–≥–µ–Ω—Ç–æ–≤ LIMITER |
| `code/sim_v2/rtc_modules/rtc_quota_repair.py` | FIFO –æ—á–µ—Ä–µ–¥—å –Ω–∞ —Ä–µ–º–æ–Ω—Ç |

### –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞

```bash
cd code/sim_v2/messaging && python3 orchestrator_limiter.py \
  --version-date 2025-07-04 \
  --end-day 3650 \
  --enable-mp2 \
  --drop-table
```

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `docs/MESSAGING_RESEARCH.md` ‚Äî –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ messaging –ø–æ–¥—Ö–æ–¥–æ–≤ FLAME GPU
- `docs/ADAPTIVE_STEP_ARCHITECTURE.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ adaptive time step
- `docs/GPU_ONLY_ARCHITECTURE.md` ‚Äî GPU-only –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `docs/changelog.md` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∑–∞–ø–∏—Å—å 10-01-2026)

---

## üöÄ LIMITER V3 –í–∞–ª–∏–¥–∞—Ü–∏—è (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 11-01-2026)

### –°—Ç–∞—Ç—É—Å
‚úÖ **–í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´** –¥–ª—è –æ–±–æ–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | DS1 (2025-07-04) | DS2 (2025-12-30) |
|---------|------------------|------------------|
| **Œîsne = Œ£dt** | ‚úÖ 0 –º–∏–Ω | ‚úÖ 0 –º–∏–Ω |
| **dt = –ø—Ä–æ–≥—Ä–∞–º–º–∞** | ‚úÖ 513/513 | ‚úÖ 579/579 |
| **Œ£dt** | 906,443 —á | 922,603 —á |
| **–ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Mi-8** | 2.2% –¥–µ—Ñ–∏—Ü–∏—Ç | ‚úÖ 0% |
| **–ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Mi-17** | —Ñ–∏–∑.–ª–∏–º–∏—Ç | —Ñ–∏–∑.–ª–∏–º–∏—Ç |

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –î–∞—Ç–∞—Å–µ—Ç | –®–∞–≥–æ–≤ | –í—Ä–µ–º—è | –î–Ω–µ–π/—Å–µ–∫ |
|---------|-------|-------|----------|
| DS1 | 694 | 9.59—Å | 380.6 |
| DS2 | 764 | 10.42—Å | 350.4 |

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

**INV-LIMITER-V3-1:** Œîsne = Œ£dt (–¥–æ –º–∏–Ω—É—Ç—ã)
```sql
SELECT 
  sum(CASE WHEN day_u16 = 0 THEN sne ELSE 0 END) as sne_0,
  sum(CASE WHEN day_u16 = (SELECT max(day_u16) FROM sim_masterv2_limiter WHERE version_date = 20250704) THEN sne ELSE 0 END) as sne_last,
  sum(dt) as total_dt
FROM sim_masterv2_limiter
WHERE version_date = 20250704;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: sne_last - sne_0 = total_dt
```

**INV-LIMITER-V3-2:** dt = –ø—Ä–æ–≥—Ä–∞–º–º–∞
```sql
-- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –≤ operations: Œ£dt(–ø–µ—Ä–∏–æ–¥) = Œ£prog(–ø–µ—Ä–∏–æ–¥)
SELECT 
  m.aircraft_number,
  sum(m.dt) as sim_dt,
  sum(f.daily_hours) as prog
FROM sim_masterv2_limiter m
JOIN flight_program_fl f ON m.aircraft_number = f.aircraft_number
  AND toRelativeDayNum(f.dates) - toRelativeDayNum(toDate('2025-07-04')) = m.day_u16
WHERE m.state = 'operations' AND m.version_date = 20250704 AND f.version_date = '2025-07-04'
GROUP BY m.aircraft_number;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: sim_dt = prog –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
```

### –ö–æ–º–∞–Ω–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```bash
cd code/sim_v2/messaging && python3 validate_limiter_v3.py --version-date 2025-07-04
cd code/sim_v2/messaging && python3 validate_limiter_v3.py --version-date 2025-12-30
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (11-01-2026)
- **–ë–∞–≥:** `orchestrator_limiter_v3.py` —Å—Ç—Ä–æ–∫–∞ 695 —Ö–∞—Ä–¥–∫–æ–¥–∏–ª–∞ `dt=0` –¥–ª—è non-operations
- **–§–∏–∫—Å:** –£–±—Ä–∞–Ω `if state_name == 'operations' else 0`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Œîsne = Œ£dt —Ç–µ–ø–µ—Ä—å 0 (–±—ã–ª–æ +399,313 –º–∏–Ω)

### –ö–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –¥–µ—Ñ–∏—Ü–∏—Ç 2.2% Mi-8 DS1

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–Ω–µ –±–∞–≥)

**–ü—Ä–∏—á–∏–Ω–∞:**
- 95 inactive Mi-8 —Å—Ç–∞—Ä—Ç—É—é—Ç —Å `repair_days = 0`
- `repair_time = 180` –¥–Ω–µ–π ‚Äî –≤—Ä–µ–º—è –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- –ü–µ—Ä–≤—ã–µ 176 –¥–Ω–µ–π –∞–≥–µ–Ω—Ç—ã **—Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –º–æ–≥—É—Ç** –±—ã—Ç—å –ø–æ–¥–Ω—è—Ç—ã

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:**
| –ü–µ—Ä–∏–æ–¥ | –î–Ω–µ–π —Å –¥–µ—Ñ–∏—Ü–∏—Ç–æ–º | % |
|--------|------------------|---|
| –î–Ω–∏ 0-176 | 15 –∏–∑ 22 | 68% |
| **–î–Ω–∏ 180+** | **0 –∏–∑ 672** | **0%** |

–ü–æ—Å–ª–µ –¥–Ω—è 180 –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ ‚Äî 0 –¥–Ω–µ–π –¥–µ—Ñ–∏—Ü–∏—Ç–∞.

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –î–µ–Ω—å 0 —Å–∏–º—É–ª—è—Ü–∏–∏ ‚â† heli_pandas (12-01-2026)

**–í–∞–∂–Ω–æ:** –î–µ–Ω—å 0 –≤ —Ç–∞–±–ª–∏—Ü–µ `sim_masterv2_limiter` ‚Äî —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ **–ø–æ—Å–ª–µ** –ø–µ—Ä–≤–æ–≥–æ step(), –∞ –Ω–µ —á–∏—Å—Ç—ã–µ –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `heli_pandas`.

**–õ–æ–≥–∏–∫–∞ –∑–∞–ø–∏—Å–∏:**
```
1. –ê–≥–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∏–∑ heli_pandas (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)
2. simulation.step() ‚Äî RTC —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è (–∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ—Ö–æ–¥—ã)
3. _collect_mp2_day(day=0) ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ü–û–°–õ–ï step()
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞:**

| –î–∞—Ç–∞—Å–µ—Ç | heli_pandas | –°–∏–º—É–ª—è—Ü–∏—è –¥–µ–Ω—å 0 | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------|-------------|------------------|-----------|
| DS1 (2025-07-04) Mi-17 | 116 | 116 | ‚úÖ –ò–¢–û–ì–û —Å–æ–≤–ø–∞–¥–∞–µ—Ç |
| DS2 (2025-12-30) Mi-17 | 122 | 122 | ‚úÖ –ò–¢–û–ì–û —Å–æ–≤–ø–∞–¥–∞–µ—Ç |

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ DS2 Mi-17:**

| –°–æ—Å—Ç–æ—è–Ω–∏–µ | heli_pandas | –°–∏–º—É–ª—è—Ü–∏—è | Œî | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|-----------|-------------|-----------|---|------------|
| operations | 97 | 90 | -7 | –î–µ–º–æ—É—Ç –≤ serviceable + —Ä–µ—Å—É—Ä—Å |
| inactive | 20 | 15 | -5 | –ü—Ä–æ–º–æ—É—Ç –≤ operations (P3) |
| serviceable | 0 | 8 | +8 | –î–µ–º–æ—É—Ç –∏–∑ operations |
| unserviceable | 5 | 9 | +4 | –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Ä–µ—Å—É—Ä—Å—É (ppr >= oh) |
| **–ò–¢–û–ì–û** | **122** | **122** | **0** | ‚úÖ –ë–∞–ª–∞–Ω—Å —Å—Ö–æ–¥–∏—Ç—Å—è |

**–ë–∞–ª–∞–Ω—Å –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ DS2 –∑–∞ –ø–µ—Ä–≤—ã–π step:**
```
target –¥–µ–Ω—å 0 = 89
ops –≤ heli_pandas = 97
balance = +8 ‚Üí –î–ï–ú–û–£–¢ 8 –∞–≥–µ–Ω—Ç–æ–≤

–ü–µ—Ä–µ—Ö–æ–¥—ã:
  1. –î–ï–ú–û–£–¢:  ops ‚Üí serviceable      = 8 (–∏–∑–±—ã—Ç–æ–∫ 97-89=8)
  2. –†–ï–°–£–†–°:  ops ‚Üí unserviceable    = 4 (ppr >= oh)
  3. –ü–†–û–ú–û–£–¢: inactive ‚Üí operations  = 5 (–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –¥–µ—Ñ–∏—Ü–∏—Ç–∞)

–†–∞—Å—á—ë—Ç:
  ops = 97 - 8 - 4 + 5 = 90 ‚úÖ
  serviceable = 0 + 8 = 8 ‚úÖ
  unserviceable = 5 + 4 = 9 ‚úÖ
  inactive = 20 - 5 = 15 ‚úÖ
```

**–ü–æ—á–µ–º—É DS1 —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –∞ DS2 –Ω–µ—Ç:**
- DS1: `ops=87, target=88` ‚Üí balance=-1 ‚Üí –Ω–µ—Ç –¥–µ–º–æ—É—Ç–∞, inactive –Ω–µ –≥–æ—Ç–æ–≤—ã ‚Üí **–Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–æ–≤**
- DS2: `ops=97, target=89` ‚Üí balance=+8 ‚Üí –∞–∫—Ç–∏–≤–Ω–æ–µ –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí **–µ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã**

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç:**
> –ò—Ç–æ–≥–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ —Ç–∏–ø—É (Mi-8/Mi-17) –º–µ–∂–¥—É heli_pandas –∏ –¥–Ω—ë–º 0 —Å–∏–º—É–ª—è—Ü–∏–∏ **–≤—Å–µ–≥–¥–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç**. –†–∞–∑–ª–∏—á–∏—è –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º ‚Äî —ç—Ç–æ **–æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –∫–≤–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –Ω–∞ –ø–µ—Ä–≤–æ–º step().

