2025-02-09 17:41:34,567 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 17:41:34,726 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 17:41:34,817 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 17:41:34,931 - INFO - monthly_flight_hours: 48.0
2025-02-09 17:41:34,932 - INFO - Вычисленный aggregate_count: 235
2025-02-09 17:41:34,934 - INFO - aggregate_count рассчитан: 235
2025-02-09 17:41:34,936 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 17:41:35,031 - INFO - Получены значения из таблицы Agregat.
2025-02-09 17:41:35,033 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 17:41:35,150 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 17:41:35,152 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 17:41:35,252 - INFO - Получено 4001 уникальных дат.
2025-02-09 17:41:35,253 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 17:41:45,357 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 17:41:45,477 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 17:41:45,611 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 17:41:45,809 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 17:41:45,898 - INFO - Получено значение RepairTime: 120.0
2025-02-09 17:41:46,007 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 17:41:46,042 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 17:41:46,214 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 17:41:46,216 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 17:41:46,320 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 17:41:46,321 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 17:41:46,355 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 17:41:46,492 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 17:41:46,593 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 17:41:46,595 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 17:41:46,780 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 17:41:46,863 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 17:41:46,865 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 17:41:46,868 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 17:41:46,870 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 17:41:46,964 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 17:41:46,966 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 18:22:34,007 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 18:22:34,198 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 18:22:34,298 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 18:22:34,398 - INFO - monthly_flight_hours: 48.0
2025-02-09 18:22:34,399 - INFO - Вычисленный aggregate_count: 235
2025-02-09 18:22:34,401 - INFO - aggregate_count рассчитан: 235
2025-02-09 18:22:34,403 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 18:22:34,514 - INFO - Получены значения из таблицы Agregat.
2025-02-09 18:22:34,516 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 18:22:34,613 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 18:22:34,616 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 18:22:34,731 - INFO - Получено 4001 уникальных дат.
2025-02-09 18:22:34,732 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 18:22:45,349 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 18:22:45,468 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 18:22:45,685 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 18:22:45,946 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 18:22:46,038 - INFO - Получено значение RepairTime: 120.0
2025-02-09 18:22:46,165 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 18:22:46,210 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 18:22:46,443 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 18:22:46,445 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 18:22:46,549 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 18:22:46,551 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 18:22:46,586 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 18:22:46,790 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 18:22:46,923 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 18:22:46,925 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 18:22:47,168 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 18:22:47,263 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 18:22:47,265 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 18:22:47,267 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 18:22:47,268 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 18:22:47,364 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 18:22:47,366 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 18:27:51,276 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 18:27:51,865 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 18:27:51,992 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 18:27:52,118 - INFO - monthly_flight_hours: 48.0
2025-02-09 18:27:52,120 - INFO - Вычисленный aggregate_count: 235
2025-02-09 18:27:52,122 - INFO - aggregate_count рассчитан: 235
2025-02-09 18:27:52,124 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 18:27:52,251 - INFO - Получены значения из таблицы Agregat.
2025-02-09 18:27:52,253 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 18:27:52,380 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 18:27:52,381 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 18:27:52,518 - INFO - Получено 4001 уникальных дат.
2025-02-09 18:27:52,520 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 18:28:04,120 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 18:28:04,250 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 18:28:04,381 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 18:28:04,583 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 18:28:04,674 - INFO - Получено значение RepairTime: 120.0
2025-02-09 18:28:04,771 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 18:28:04,817 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 18:28:05,013 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 18:28:05,015 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 18:28:05,116 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 18:28:05,118 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 18:28:05,155 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 18:28:05,290 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 18:28:05,387 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 18:28:05,389 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 18:28:05,600 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 18:28:05,693 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 18:28:05,695 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 18:28:05,697 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 18:28:05,698 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 18:28:05,793 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 18:28:05,795 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 19:01:11,252 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 19:01:11,440 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 19:01:11,530 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 19:01:11,632 - INFO - monthly_flight_hours: 48.0
2025-02-09 19:01:11,632 - INFO - Вычисленный aggregate_count: 235
2025-02-09 19:01:11,633 - INFO - aggregate_count рассчитан: 235
2025-02-09 19:01:11,633 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 19:01:11,732 - INFO - Получены значения из таблицы Agregat.
2025-02-09 19:01:11,733 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 19:01:11,831 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 19:01:11,832 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 19:01:11,944 - INFO - Получено 4001 уникальных дат.
2025-02-09 19:01:11,945 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 19:01:21,572 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 19:01:21,626 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 19:01:21,812 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 19:01:22,012 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 19:01:22,098 - INFO - Получено значение RepairTime: 120.0
2025-02-09 19:01:22,199 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 19:01:22,216 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 19:01:22,390 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 19:01:22,391 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 19:01:22,506 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 19:01:22,507 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 19:01:22,519 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 19:01:22,682 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 19:01:22,782 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 19:01:22,783 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 19:01:22,954 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 19:01:23,043 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 19:01:23,044 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 19:01:23,045 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 19:01:23,046 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 19:01:23,143 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 19:01:23,145 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 19:29:50,001 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 19:29:50,189 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 19:29:50,280 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 19:29:50,380 - INFO - monthly_flight_hours: 48.0
2025-02-09 19:29:50,381 - INFO - Вычисленный aggregate_count: 235
2025-02-09 19:29:50,381 - INFO - aggregate_count рассчитан: 235
2025-02-09 19:29:50,382 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 19:29:50,482 - INFO - Получены значения из таблицы Agregat.
2025-02-09 19:29:50,483 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 19:29:50,583 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 19:29:50,584 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 19:29:50,701 - INFO - Получено 4001 уникальных дат.
2025-02-09 19:29:50,702 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 19:29:59,331 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 19:29:59,383 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 19:29:59,516 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 19:29:59,712 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 19:29:59,800 - INFO - Получено значение RepairTime: 120.0
2025-02-09 19:29:59,902 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 19:29:59,920 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 19:30:00,104 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 19:30:00,105 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 19:30:00,210 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 19:30:00,211 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 19:30:00,223 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 19:30:00,379 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 19:30:00,479 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 19:30:00,480 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 19:30:00,657 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 19:30:00,750 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 19:30:00,750 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 19:30:00,751 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 19:30:00,752 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 19:30:00,847 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 19:30:00,848 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 20:12:15,863 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 20:12:16,097 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 20:12:16,238 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 20:12:16,375 - INFO - monthly_flight_hours: 48.0
2025-02-09 20:12:16,377 - INFO - Вычисленный aggregate_count: 235
2025-02-09 20:12:16,377 - INFO - aggregate_count рассчитан: 235
2025-02-09 20:12:16,378 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 20:12:16,505 - INFO - Получены значения из таблицы Agregat.
2025-02-09 20:12:16,506 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 20:12:16,607 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 20:12:16,608 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 20:12:16,727 - INFO - Получено 4001 уникальных дат.
2025-02-09 20:12:16,728 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 20:12:29,886 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 20:12:29,938 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:12:30,069 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 20:12:30,269 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 20:12:30,355 - INFO - Получено значение RepairTime: 120.0
2025-02-09 20:12:30,457 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 20:12:30,475 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:12:30,654 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 20:12:30,655 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 20:12:30,758 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 20:12:30,759 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 20:12:30,771 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:12:30,921 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 20:12:31,020 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 20:12:31,020 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 20:12:31,178 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 20:12:31,276 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 20:12:31,277 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 20:12:31,278 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 20:12:31,278 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 20:12:31,372 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 20:12:31,373 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 20:33:13,443 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 20:33:13,619 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 20:33:13,704 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 20:33:13,799 - INFO - monthly_flight_hours: 48.0
2025-02-09 20:33:13,800 - INFO - Вычисленный aggregate_count: 235
2025-02-09 20:33:13,801 - INFO - aggregate_count рассчитан: 235
2025-02-09 20:33:13,801 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 20:33:13,901 - INFO - Получены значения из таблицы Agregat.
2025-02-09 20:33:13,902 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 20:33:13,995 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 20:33:13,996 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 20:33:14,102 - INFO - Получено 4001 уникальных дат.
2025-02-09 20:33:14,103 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 20:33:22,537 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 20:33:22,591 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:33:22,810 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 20:33:23,079 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 20:33:23,190 - INFO - Получено значение RepairTime: 120.0
2025-02-09 20:33:23,305 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 20:33:23,322 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:33:23,545 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 20:33:23,546 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 20:33:23,683 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 20:33:23,683 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 20:33:23,695 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:33:23,891 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 20:33:24,027 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 20:33:24,028 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 20:33:24,235 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 20:33:24,372 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 20:33:24,373 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 20:33:24,374 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 20:33:24,375 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 20:33:24,484 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 20:33:24,485 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 20:59:09,435 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 20:59:09,614 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 20:59:09,702 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 20:59:09,794 - INFO - monthly_flight_hours: 48.0
2025-02-09 20:59:09,795 - INFO - Вычисленный aggregate_count: 235
2025-02-09 20:59:09,795 - INFO - aggregate_count рассчитан: 235
2025-02-09 20:59:09,796 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 20:59:10,201 - INFO - Получены значения из таблицы Agregat.
2025-02-09 20:59:10,202 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 20:59:10,307 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 20:59:10,307 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 20:59:10,417 - INFO - Получено 4001 уникальных дат.
2025-02-09 20:59:10,417 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 20:59:18,700 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 20:59:18,754 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:59:18,908 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 20:59:19,105 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 20:59:19,192 - INFO - Получено значение RepairTime: 120.0
2025-02-09 20:59:19,291 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 20:59:19,308 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:59:19,496 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 20:59:19,497 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 20:59:19,602 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 20:59:19,603 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 20:59:19,616 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 20:59:19,762 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 20:59:19,861 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 20:59:19,862 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 20:59:20,019 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 20:59:20,110 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 20:59:20,111 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 20:59:20,111 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 20:59:20,112 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 20:59:20,210 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 20:59:20,211 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 21:34:40,452 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 21:34:40,637 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 21:34:40,727 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 21:34:40,822 - INFO - monthly_flight_hours: 48.0
2025-02-09 21:34:40,823 - INFO - Вычисленный aggregate_count: 235
2025-02-09 21:34:40,824 - INFO - aggregate_count рассчитан: 235
2025-02-09 21:34:40,824 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 21:34:40,926 - INFO - Получены значения из таблицы Agregat.
2025-02-09 21:34:40,927 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 21:34:41,019 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 21:34:41,020 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 21:34:41,122 - INFO - Получено 4001 уникальных дат.
2025-02-09 21:34:41,122 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 21:34:49,286 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 21:34:49,339 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 21:34:49,498 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 21:34:49,694 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 21:34:49,783 - INFO - Получено значение RepairTime: 120.0
2025-02-09 21:34:49,887 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 21:34:49,904 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 21:34:50,100 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 21:34:50,101 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 21:34:50,209 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 21:34:50,210 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 21:34:50,222 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 21:34:50,359 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 21:34:50,459 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 21:34:50,460 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 21:34:50,636 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 21:34:50,734 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 21:34:50,735 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 21:34:50,735 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 21:34:50,736 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 21:34:50,832 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 21:34:50,833 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 21:44:34,376 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 21:44:34,569 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 21:44:34,658 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 21:44:34,767 - INFO - monthly_flight_hours: 48.0
2025-02-09 21:44:34,767 - INFO - Вычисленный aggregate_count: 235
2025-02-09 21:44:34,768 - INFO - aggregate_count рассчитан: 235
2025-02-09 21:44:34,769 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 21:44:34,860 - INFO - Получены значения из таблицы Agregat.
2025-02-09 21:44:34,861 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 21:44:34,959 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 21:44:34,959 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 21:44:35,068 - INFO - Получено 4001 уникальных дат.
2025-02-09 21:44:35,069 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 21:44:43,415 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 21:44:43,466 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 21:44:43,920 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 21:44:44,112 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 21:44:44,201 - INFO - Получено значение RepairTime: 120.0
2025-02-09 21:44:44,299 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 21:44:44,316 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 21:44:44,502 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 21:44:44,504 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 21:44:44,607 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 21:44:44,608 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 21:44:44,619 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 21:44:44,780 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 21:44:44,879 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 21:44:44,880 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 21:44:45,031 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 21:44:45,125 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 21:44:45,126 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 21:44:45,127 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 21:44:45,127 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 21:44:45,226 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 21:44:45,227 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-09 22:12:39,025 - INFO - Начинаю вычисление aggregate_count.
2025-02-09 22:12:39,217 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-09 22:12:39,308 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-09 22:12:39,407 - INFO - monthly_flight_hours: 48.0
2025-02-09 22:12:39,409 - INFO - Вычисленный aggregate_count: 235
2025-02-09 22:12:39,410 - INFO - aggregate_count рассчитан: 235
2025-02-09 22:12:39,411 - INFO - Получаю значения из таблицы Agregat.
2025-02-09 22:12:39,505 - INFO - Получены значения из таблицы Agregat.
2025-02-09 22:12:39,507 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-09 22:12:39,616 - INFO - Получено daily_flight_hours: 1.58
2025-02-09 22:12:39,619 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-09 22:12:39,719 - INFO - Получено 4001 уникальных дат.
2025-02-09 22:12:39,721 - INFO - Сгенерировано 235 серийных номеров.
2025-02-09 22:12:49,830 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-09 22:12:49,949 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 22:12:50,083 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-09 22:12:50,281 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-09 22:12:50,369 - INFO - Получено значение RepairTime: 120.0
2025-02-09 22:12:50,473 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-09 22:12:50,522 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 22:12:50,698 - INFO - Получено данных из fleet: 12 месяцев
2025-02-09 22:12:50,700 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-09 22:12:50,811 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-09 22:12:50,813 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-09 22:12:50,841 - INFO - Подключение к ClickHouse успешно установлено
2025-02-09 22:12:50,987 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-09 22:12:51,087 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-09 22:12:51,090 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-09 22:12:51,276 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-09 22:12:51,368 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-09 22:12:51,370 - INFO - Определено 0 записей с trigger_type=1.
2025-02-09 22:12:51,372 - INFO - Определено 1 записей с trigger_type=0.
2025-02-09 22:12:51,373 - INFO - Нет записей для обновления trigger_type=1.
2025-02-09 22:12:51,469 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-09 22:12:51,471 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-10 14:31:41,382 - INFO - Начинаю вычисление aggregate_count.
2025-02-10 14:31:41,397 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-10 14:31:41,405 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-10 14:31:41,414 - INFO - monthly_flight_hours: 48.0
2025-02-10 14:31:41,415 - INFO - Вычисленный aggregate_count: 235
2025-02-10 14:31:41,416 - INFO - aggregate_count рассчитан: 235
2025-02-10 14:31:41,417 - INFO - Получаю значения из таблицы Agregat.
2025-02-10 14:31:41,427 - INFO - Получены значения из таблицы Agregat.
2025-02-10 14:31:41,429 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-10 14:31:41,437 - INFO - Получено daily_flight_hours: 1.58
2025-02-10 14:31:41,438 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-10 14:31:41,453 - INFO - Получено 4001 уникальных дат.
2025-02-10 14:31:41,455 - INFO - Сгенерировано 235 серийных номеров.
2025-02-10 14:31:53,476 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-10 14:31:53,578 - INFO - Подключение к ClickHouse успешно установлено
2025-02-10 14:31:53,589 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-10 14:31:53,610 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-10 14:31:53,620 - INFO - Получено значение RepairTime: 120.0
2025-02-10 14:31:53,630 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-10 14:31:53,663 - INFO - Подключение к ClickHouse успешно установлено
2025-02-10 14:31:53,701 - INFO - Получено данных из fleet: 12 месяцев
2025-02-10 14:31:53,702 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-10 14:31:53,714 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-10 14:31:53,715 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-10 14:31:53,737 - INFO - Подключение к ClickHouse успешно установлено
2025-02-10 14:31:53,760 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-10 14:31:53,772 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-10 14:31:53,773 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-10 14:31:53,824 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-10 14:31:53,834 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-10 14:31:53,835 - INFO - Определено 0 записей с trigger_type=1.
2025-02-10 14:31:53,836 - INFO - Определено 1 записей с trigger_type=0.
2025-02-10 14:31:53,837 - INFO - Нет записей для обновления trigger_type=1.
2025-02-10 14:31:53,849 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-10 14:31:53,850 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-12 15:02:50,380 - INFO - Начинаю вычисление aggregate_count.
2025-02-12 15:02:50,397 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-12 15:02:50,408 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-12 15:02:50,418 - INFO - monthly_flight_hours: 48.0
2025-02-12 15:02:50,420 - INFO - Вычисленный aggregate_count: 235
2025-02-12 15:02:50,422 - INFO - aggregate_count рассчитан: 235
2025-02-12 15:02:50,423 - INFO - Получаю значения из таблицы Agregat.
2025-02-12 15:02:50,434 - INFO - Получены значения из таблицы Agregat.
2025-02-12 15:02:50,438 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-12 15:02:50,446 - INFO - Получено daily_flight_hours: 1.58
2025-02-12 15:02:50,447 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-12 15:02:50,467 - INFO - Получено 4001 уникальных дат.
2025-02-12 15:02:50,469 - INFO - Сгенерировано 235 серийных номеров.
2025-02-12 15:03:04,020 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-12 15:03:04,168 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 15:03:04,180 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-12 15:03:04,203 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-12 15:03:04,212 - INFO - Получено значение RepairTime: 120.0
2025-02-12 15:03:04,225 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-12 15:03:04,274 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 15:03:04,305 - INFO - Получено данных из fleet: 12 месяцев
2025-02-12 15:03:04,306 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-12 15:03:04,321 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-12 15:03:04,324 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-12 15:03:04,358 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 15:03:04,372 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-12 15:03:04,383 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-12 15:03:04,385 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-12 15:03:04,459 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-12 15:03:04,469 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-12 15:03:04,471 - INFO - Определено 0 записей с trigger_type=1.
2025-02-12 15:03:04,472 - INFO - Определено 1 записей с trigger_type=0.
2025-02-12 15:03:04,473 - INFO - Нет записей для обновления trigger_type=1.
2025-02-12 15:03:04,482 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-12 15:03:04,485 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-12 16:22:10,287 - INFO - Начинаю вычисление aggregate_count.
2025-02-12 16:22:10,302 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-12 16:22:10,310 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-12 16:22:10,319 - INFO - monthly_flight_hours: 48.0
2025-02-12 16:22:10,321 - INFO - Вычисленный aggregate_count: 235
2025-02-12 16:22:10,322 - INFO - aggregate_count рассчитан: 235
2025-02-12 16:22:10,323 - INFO - Получаю значения из таблицы Agregat.
2025-02-12 16:22:10,334 - INFO - Получены значения из таблицы Agregat.
2025-02-12 16:22:10,335 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-12 16:22:10,344 - INFO - Получено daily_flight_hours: 1.58
2025-02-12 16:22:10,345 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-12 16:22:10,666 - INFO - Получено 4001 уникальных дат.
2025-02-12 16:22:10,669 - INFO - Сгенерировано 235 серийных номеров.
2025-02-12 16:22:21,461 - ERROR - Ошибка при вставке данных в OlapCube_VNV: Code: 252.
DB::Exception: Too many partitions for single INSERT block (more than 100). The limit is controlled by 'max_partitions_per_insert_block' setting. Large number of partitions is a common misconception. It will lead to severe negative performance impact, including slow server startup, slow INSERT queries and slow SELECT queries. Recommended total number of partitions for a table is under 1000..10000. Please note, that partitioning is not intended to speed up SELECT queries (ORDER BY key is sufficient to make range queries fast). Partitions are intended for data manipulation (DROP PARTITION, etc).. Stack trace:

0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000cf720fb
1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000007ea888c
2. DB::Exception::Exception<unsigned long&>(int, FormatStringHelperImpl<std::type_identity<unsigned long&>::type>, unsigned long&) @ 0x000000000849248b
3. DB::MergeTreeDataWriter::splitBlockIntoParts(DB::Block&&, unsigned long, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::Context const>, std::shared_ptr<DB::AsyncInsertInfo>) @ 0x00000000123ddd8d
4. DB::MergeTreeSink::consume(DB::Chunk&) @ 0x0000000012699135
5. DB::SinkToStorage::onConsume(DB::Chunk) @ 0x0000000012cf5564
6. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_1, void ()>>(std::__function::__policy_storage const*) @ 0x0000000012c1e5f8
7. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x0000000012c1e30b
8. DB::ExceptionKeepingTransform::work() @ 0x0000000012c1db35
9. DB::ExecutionThreadContext::executeTask() @ 0x00000000129b3ce7
10. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000129a7290
11. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000129a6ae8
12. DB::TCPHandler::processInsertQuery() @ 0x0000000012924246
13. DB::TCPHandler::runImpl() @ 0x0000000012913483
14. DB::TCPHandler::run() @ 0x000000001292e7b8
15. Poco::Net::TCPServerConnection::start() @ 0x00000000157fc747
16. Poco::Net::TCPServerDispatcher::run() @ 0x00000000157fcbd9
17. Poco::PooledThread::run() @ 0x00000000157c9741
18. Poco::ThreadImpl::runnableEntry(void*) @ 0x00000000157c7cfd
19. ? @ 0x00007fcf0187d609
20. ? @ 0x00007fcf017a2353
Traceback (most recent call last):
  File "C:\Users\Budnik_AN\AppData\Local\Temp\ipykernel_18044\3885069522.py", line 174, in insert_into_olapcube_vnv_with_dates
    client.execute(insert_query, data_to_insert, types_check=True)
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 376, in execute
    rv = self.process_insert_query(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 607, in process_insert_query
    rv = self.send_data(sample_block, data,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 670, in send_data
    self.receive_profile_events()
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 747, in receive_profile_events
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 252.
DB::Exception: Too many partitions for single INSERT block (more than 100). The limit is controlled by 'max_partitions_per_insert_block' setting. Large number of partitions is a common misconception. It will lead to severe negative performance impact, including slow server startup, slow INSERT queries and slow SELECT queries. Recommended total number of partitions for a table is under 1000..10000. Please note, that partitioning is not intended to speed up SELECT queries (ORDER BY key is sufficient to make range queries fast). Partitions are intended for data manipulation (DROP PARTITION, etc).. Stack trace:

0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000cf720fb
1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000007ea888c
2. DB::Exception::Exception<unsigned long&>(int, FormatStringHelperImpl<std::type_identity<unsigned long&>::type>, unsigned long&) @ 0x000000000849248b
3. DB::MergeTreeDataWriter::splitBlockIntoParts(DB::Block&&, unsigned long, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::Context const>, std::shared_ptr<DB::AsyncInsertInfo>) @ 0x00000000123ddd8d
4. DB::MergeTreeSink::consume(DB::Chunk&) @ 0x0000000012699135
5. DB::SinkToStorage::onConsume(DB::Chunk) @ 0x0000000012cf5564
6. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_1, void ()>>(std::__function::__policy_storage const*) @ 0x0000000012c1e5f8
7. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x0000000012c1e30b
8. DB::ExceptionKeepingTransform::work() @ 0x0000000012c1db35
9. DB::ExecutionThreadContext::executeTask() @ 0x00000000129b3ce7
10. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000129a7290
11. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000129a6ae8
12. DB::TCPHandler::processInsertQuery() @ 0x0000000012924246
13. DB::TCPHandler::runImpl() @ 0x0000000012913483
14. DB::TCPHandler::run() @ 0x000000001292e7b8
15. Poco::Net::TCPServerConnection::start() @ 0x00000000157fc747
16. Poco::Net::TCPServerDispatcher::run() @ 0x00000000157fcbd9
17. Poco::PooledThread::run() @ 0x00000000157c9741
18. Poco::ThreadImpl::runnableEntry(void*) @ 0x00000000157c7cfd
19. ? @ 0x00007fcf0187d609
20. ? @ 0x00007fcf017a2353

2025-02-12 16:22:21,575 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:22:21,587 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String,
    `update_time` DateTime
)
ENGINE = ReplacingMergeTree(update_time)
PARTITION BY toYYYYMM(Dates)
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-12 16:22:22,167 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-12 16:22:22,187 - INFO - Получено значение RepairTime: 120.0
2025-02-12 16:22:22,825 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-12 16:22:22,851 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:22:22,870 - INFO - Получено данных из fleet: 12 месяцев
2025-02-12 16:22:22,871 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-12 16:22:22,891 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-12 16:22:22,892 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-12 16:22:22,911 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:22:22,924 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-12 16:22:22,941 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-12 16:22:22,942 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-12 16:22:23,018 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-12 16:22:23,029 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-12 16:22:23,030 - INFO - Определено 0 записей с trigger_type=1.
2025-02-12 16:22:23,032 - INFO - Определено 1 записей с trigger_type=0.
2025-02-12 16:22:23,033 - INFO - Нет записей для обновления trigger_type=1.
2025-02-12 16:22:23,063 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-12 16:22:23,064 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-12 16:31:26,284 - INFO - Начинаю вычисление aggregate_count.
2025-02-12 16:31:26,300 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-12 16:31:26,309 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-12 16:31:26,324 - INFO - monthly_flight_hours: 48.0
2025-02-12 16:31:26,325 - INFO - Вычисленный aggregate_count: 235
2025-02-12 16:31:26,326 - INFO - aggregate_count рассчитан: 235
2025-02-12 16:31:26,328 - INFO - Получаю значения из таблицы Agregat.
2025-02-12 16:31:26,339 - INFO - Получены значения из таблицы Agregat.
2025-02-12 16:31:26,340 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-12 16:31:26,350 - INFO - Получено daily_flight_hours: 1.58
2025-02-12 16:31:26,351 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-12 16:31:26,828 - INFO - Получено 4001 уникальных дат.
2025-02-12 16:31:26,829 - INFO - Сгенерировано 235 серийных номеров.
2025-02-12 16:31:37,464 - ERROR - Ошибка при вставке данных в OlapCube_VNV: Code: 252.
DB::Exception: Too many partitions for single INSERT block (more than 100). The limit is controlled by 'max_partitions_per_insert_block' setting. Large number of partitions is a common misconception. It will lead to severe negative performance impact, including slow server startup, slow INSERT queries and slow SELECT queries. Recommended total number of partitions for a table is under 1000..10000. Please note, that partitioning is not intended to speed up SELECT queries (ORDER BY key is sufficient to make range queries fast). Partitions are intended for data manipulation (DROP PARTITION, etc).. Stack trace:

0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000cf720fb
1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000007ea888c
2. DB::Exception::Exception<unsigned long&>(int, FormatStringHelperImpl<std::type_identity<unsigned long&>::type>, unsigned long&) @ 0x000000000849248b
3. DB::MergeTreeDataWriter::splitBlockIntoParts(DB::Block&&, unsigned long, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::Context const>, std::shared_ptr<DB::AsyncInsertInfo>) @ 0x00000000123ddd8d
4. DB::MergeTreeSink::consume(DB::Chunk&) @ 0x0000000012699135
5. DB::SinkToStorage::onConsume(DB::Chunk) @ 0x0000000012cf5564
6. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_1, void ()>>(std::__function::__policy_storage const*) @ 0x0000000012c1e5f8
7. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x0000000012c1e30b
8. DB::ExceptionKeepingTransform::work() @ 0x0000000012c1db35
9. DB::ExecutionThreadContext::executeTask() @ 0x00000000129b3ce7
10. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000129a7290
11. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000129a6ae8
12. DB::TCPHandler::processInsertQuery() @ 0x0000000012924246
13. DB::TCPHandler::runImpl() @ 0x0000000012913483
14. DB::TCPHandler::run() @ 0x000000001292e7b8
15. Poco::Net::TCPServerConnection::start() @ 0x00000000157fc747
16. Poco::Net::TCPServerDispatcher::run() @ 0x00000000157fcbd9
17. Poco::PooledThread::run() @ 0x00000000157c9741
18. Poco::ThreadImpl::runnableEntry(void*) @ 0x00000000157c7cfd
19. ? @ 0x00007fcf0187d609
20. ? @ 0x00007fcf017a2353
Traceback (most recent call last):
  File "C:\Users\Budnik_AN\AppData\Local\Temp\ipykernel_18044\3885069522.py", line 174, in insert_into_olapcube_vnv_with_dates
    client.execute(insert_query, data_to_insert, types_check=True)
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 376, in execute
    rv = self.process_insert_query(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 607, in process_insert_query
    rv = self.send_data(sample_block, data,
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 670, in send_data
    self.receive_profile_events()
  File "c:\Program Files\Python311\Lib\site-packages\clickhouse_driver\client.py", line 747, in receive_profile_events
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 252.
DB::Exception: Too many partitions for single INSERT block (more than 100). The limit is controlled by 'max_partitions_per_insert_block' setting. Large number of partitions is a common misconception. It will lead to severe negative performance impact, including slow server startup, slow INSERT queries and slow SELECT queries. Recommended total number of partitions for a table is under 1000..10000. Please note, that partitioning is not intended to speed up SELECT queries (ORDER BY key is sufficient to make range queries fast). Partitions are intended for data manipulation (DROP PARTITION, etc).. Stack trace:

0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000cf720fb
1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000007ea888c
2. DB::Exception::Exception<unsigned long&>(int, FormatStringHelperImpl<std::type_identity<unsigned long&>::type>, unsigned long&) @ 0x000000000849248b
3. DB::MergeTreeDataWriter::splitBlockIntoParts(DB::Block&&, unsigned long, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::Context const>, std::shared_ptr<DB::AsyncInsertInfo>) @ 0x00000000123ddd8d
4. DB::MergeTreeSink::consume(DB::Chunk&) @ 0x0000000012699135
5. DB::SinkToStorage::onConsume(DB::Chunk) @ 0x0000000012cf5564
6. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_1, void ()>>(std::__function::__policy_storage const*) @ 0x0000000012c1e5f8
7. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x0000000012c1e30b
8. DB::ExceptionKeepingTransform::work() @ 0x0000000012c1db35
9. DB::ExecutionThreadContext::executeTask() @ 0x00000000129b3ce7
10. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000129a7290
11. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000129a6ae8
12. DB::TCPHandler::processInsertQuery() @ 0x0000000012924246
13. DB::TCPHandler::runImpl() @ 0x0000000012913483
14. DB::TCPHandler::run() @ 0x000000001292e7b8
15. Poco::Net::TCPServerConnection::start() @ 0x00000000157fc747
16. Poco::Net::TCPServerDispatcher::run() @ 0x00000000157fcbd9
17. Poco::PooledThread::run() @ 0x00000000157c9741
18. Poco::ThreadImpl::runnableEntry(void*) @ 0x00000000157c7cfd
19. ? @ 0x00007fcf0187d609
20. ? @ 0x00007fcf017a2353

2025-02-12 16:31:37,589 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:31:37,603 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String,
    `update_time` DateTime
)
ENGINE = ReplacingMergeTree(update_time)
PARTITION BY toYYYYMM(Dates)
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-12 16:31:37,780 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-12 16:31:37,792 - INFO - Получено значение RepairTime: 120.0
2025-02-12 16:31:38,223 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-12 16:31:38,260 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:31:38,277 - INFO - Получено данных из fleet: 12 месяцев
2025-02-12 16:31:38,278 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-12 16:31:38,319 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-12 16:31:38,320 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-12 16:31:38,339 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:31:38,354 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-12 16:31:38,368 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-12 16:31:38,369 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-12 16:31:38,430 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-12 16:31:38,449 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-12 16:31:38,450 - INFO - Определено 0 записей с trigger_type=1.
2025-02-12 16:31:38,452 - INFO - Определено 1 записей с trigger_type=0.
2025-02-12 16:31:38,453 - INFO - Нет записей для обновления trigger_type=1.
2025-02-12 16:31:38,474 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-12 16:31:38,475 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-12 16:34:00,900 - INFO - Начинаю вычисление aggregate_count.
2025-02-12 16:34:00,914 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-12 16:34:00,924 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-12 16:34:00,932 - INFO - monthly_flight_hours: 48.0
2025-02-12 16:34:00,934 - INFO - Вычисленный aggregate_count: 235
2025-02-12 16:34:00,935 - INFO - aggregate_count рассчитан: 235
2025-02-12 16:34:00,937 - INFO - Получаю значения из таблицы Agregat.
2025-02-12 16:34:00,948 - INFO - Получены значения из таблицы Agregat.
2025-02-12 16:34:00,949 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-12 16:34:00,958 - INFO - Получено daily_flight_hours: 1.58
2025-02-12 16:34:00,959 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-12 16:34:01,065 - INFO - Получено 4001 уникальных дат.
2025-02-12 16:34:01,066 - INFO - Сгенерировано 235 серийных номеров.
2025-02-12 16:34:01,980 - INFO - Подготовлено 940235 записей для вставки.
2025-02-12 16:34:07,697 - INFO - Вставлено 1410 записей для партиции 202411
2025-02-12 16:34:07,814 - INFO - Вставлено 7285 записей для партиции 202412
2025-02-12 16:34:07,922 - INFO - Вставлено 7285 записей для партиции 202501
2025-02-12 16:34:08,019 - INFO - Вставлено 6580 записей для партиции 202502
2025-02-12 16:34:08,129 - INFO - Вставлено 7285 записей для партиции 202503
2025-02-12 16:34:08,233 - INFO - Вставлено 7050 записей для партиции 202504
2025-02-12 16:34:08,342 - INFO - Вставлено 7285 записей для партиции 202505
2025-02-12 16:34:08,449 - INFO - Вставлено 7050 записей для партиции 202506
2025-02-12 16:34:08,559 - INFO - Вставлено 7285 записей для партиции 202507
2025-02-12 16:34:08,691 - INFO - Вставлено 7285 записей для партиции 202508
2025-02-12 16:34:08,798 - INFO - Вставлено 7050 записей для партиции 202509
2025-02-12 16:34:08,914 - INFO - Вставлено 7285 записей для партиции 202510
2025-02-12 16:34:09,020 - INFO - Вставлено 7050 записей для партиции 202511
2025-02-12 16:34:09,127 - INFO - Вставлено 7285 записей для партиции 202512
2025-02-12 16:34:09,239 - INFO - Вставлено 7285 записей для партиции 202601
2025-02-12 16:34:09,335 - INFO - Вставлено 6580 записей для партиции 202602
2025-02-12 16:34:09,455 - INFO - Вставлено 7285 записей для партиции 202603
2025-02-12 16:34:09,571 - INFO - Вставлено 7050 записей для партиции 202604
2025-02-12 16:34:09,677 - INFO - Вставлено 7285 записей для партиции 202605
2025-02-12 16:34:09,785 - INFO - Вставлено 7050 записей для партиции 202606
2025-02-12 16:34:09,894 - INFO - Вставлено 7285 записей для партиции 202607
2025-02-12 16:34:10,007 - INFO - Вставлено 7285 записей для партиции 202608
2025-02-12 16:34:10,129 - INFO - Вставлено 7050 записей для партиции 202609
2025-02-12 16:34:10,251 - INFO - Вставлено 7285 записей для партиции 202610
2025-02-12 16:34:10,369 - INFO - Вставлено 7050 записей для партиции 202611
2025-02-12 16:34:10,479 - INFO - Вставлено 7285 записей для партиции 202612
2025-02-12 16:34:10,585 - INFO - Вставлено 7285 записей для партиции 202701
2025-02-12 16:34:10,683 - INFO - Вставлено 6580 записей для партиции 202702
2025-02-12 16:34:10,789 - INFO - Вставлено 7285 записей для партиции 202703
2025-02-12 16:34:10,906 - INFO - Вставлено 7050 записей для партиции 202704
2025-02-12 16:34:11,014 - INFO - Вставлено 7285 записей для партиции 202705
2025-02-12 16:34:11,119 - INFO - Вставлено 7050 записей для партиции 202706
2025-02-12 16:34:11,231 - INFO - Вставлено 7285 записей для партиции 202707
2025-02-12 16:34:11,341 - INFO - Вставлено 7285 записей для партиции 202708
2025-02-12 16:34:11,453 - INFO - Вставлено 7050 записей для партиции 202709
2025-02-12 16:34:11,561 - INFO - Вставлено 7285 записей для партиции 202710
2025-02-12 16:34:11,667 - INFO - Вставлено 7050 записей для партиции 202711
2025-02-12 16:34:11,772 - INFO - Вставлено 7285 записей для партиции 202712
2025-02-12 16:34:11,883 - INFO - Вставлено 7285 записей для партиции 202801
2025-02-12 16:34:11,983 - INFO - Вставлено 6815 записей для партиции 202802
2025-02-12 16:34:12,087 - INFO - Вставлено 7285 записей для партиции 202803
2025-02-12 16:34:12,189 - INFO - Вставлено 7050 записей для партиции 202804
2025-02-12 16:34:12,300 - INFO - Вставлено 7285 записей для партиции 202805
2025-02-12 16:34:12,415 - INFO - Вставлено 7050 записей для партиции 202806
2025-02-12 16:34:12,528 - INFO - Вставлено 7285 записей для партиции 202807
2025-02-12 16:34:12,636 - INFO - Вставлено 7285 записей для партиции 202808
2025-02-12 16:34:12,745 - INFO - Вставлено 7050 записей для партиции 202809
2025-02-12 16:34:12,848 - INFO - Вставлено 7285 записей для партиции 202810
2025-02-12 16:34:12,964 - INFO - Вставлено 7050 записей для партиции 202811
2025-02-12 16:34:13,072 - INFO - Вставлено 7285 записей для партиции 202812
2025-02-12 16:34:13,182 - INFO - Вставлено 7285 записей для партиции 202901
2025-02-12 16:34:13,278 - INFO - Вставлено 6580 записей для партиции 202902
2025-02-12 16:34:13,381 - INFO - Вставлено 7285 записей для партиции 202903
2025-02-12 16:34:13,494 - INFO - Вставлено 7050 записей для партиции 202904
2025-02-12 16:34:13,600 - INFO - Вставлено 7285 записей для партиции 202905
2025-02-12 16:34:13,701 - INFO - Вставлено 7050 записей для партиции 202906
2025-02-12 16:34:13,807 - INFO - Вставлено 7285 записей для партиции 202907
2025-02-12 16:34:13,923 - INFO - Вставлено 7285 записей для партиции 202908
2025-02-12 16:34:14,031 - INFO - Вставлено 7050 записей для партиции 202909
2025-02-12 16:34:14,138 - INFO - Вставлено 7285 записей для партиции 202910
2025-02-12 16:34:14,249 - INFO - Вставлено 7050 записей для партиции 202911
2025-02-12 16:34:14,356 - INFO - Вставлено 7285 записей для партиции 202912
2025-02-12 16:34:14,467 - INFO - Вставлено 7285 записей для партиции 203001
2025-02-12 16:34:14,567 - INFO - Вставлено 6580 записей для партиции 203002
2025-02-12 16:34:14,678 - INFO - Вставлено 7285 записей для партиции 203003
2025-02-12 16:34:14,790 - INFO - Вставлено 7050 записей для партиции 203004
2025-02-12 16:34:14,901 - INFO - Вставлено 7285 записей для партиции 203005
2025-02-12 16:34:15,016 - INFO - Вставлено 7050 записей для партиции 203006
2025-02-12 16:34:15,128 - INFO - Вставлено 7285 записей для партиции 203007
2025-02-12 16:34:15,238 - INFO - Вставлено 7285 записей для партиции 203008
2025-02-12 16:34:15,346 - INFO - Вставлено 7050 записей для партиции 203009
2025-02-12 16:34:15,463 - INFO - Вставлено 7285 записей для партиции 203010
2025-02-12 16:34:15,568 - INFO - Вставлено 7050 записей для партиции 203011
2025-02-12 16:34:15,683 - INFO - Вставлено 7285 записей для партиции 203012
2025-02-12 16:34:15,797 - INFO - Вставлено 7285 записей для партиции 203101
2025-02-12 16:34:15,911 - INFO - Вставлено 6580 записей для партиции 203102
2025-02-12 16:34:16,036 - INFO - Вставлено 7285 записей для партиции 203103
2025-02-12 16:34:16,163 - INFO - Вставлено 7050 записей для партиции 203104
2025-02-12 16:34:16,270 - INFO - Вставлено 7285 записей для партиции 203105
2025-02-12 16:34:16,377 - INFO - Вставлено 7050 записей для партиции 203106
2025-02-12 16:34:16,486 - INFO - Вставлено 7285 записей для партиции 203107
2025-02-12 16:34:16,594 - INFO - Вставлено 7285 записей для партиции 203108
2025-02-12 16:34:16,701 - INFO - Вставлено 7050 записей для партиции 203109
2025-02-12 16:34:16,809 - INFO - Вставлено 7285 записей для партиции 203110
2025-02-12 16:34:16,916 - INFO - Вставлено 7050 записей для партиции 203111
2025-02-12 16:34:17,022 - INFO - Вставлено 7285 записей для партиции 203112
2025-02-12 16:34:17,134 - INFO - Вставлено 7285 записей для партиции 203201
2025-02-12 16:34:17,237 - INFO - Вставлено 6815 записей для партиции 203202
2025-02-12 16:34:17,350 - INFO - Вставлено 7285 записей для партиции 203203
2025-02-12 16:34:17,455 - INFO - Вставлено 7050 записей для партиции 203204
2025-02-12 16:34:17,562 - INFO - Вставлено 7285 записей для партиции 203205
2025-02-12 16:34:17,679 - INFO - Вставлено 7050 записей для партиции 203206
2025-02-12 16:34:17,788 - INFO - Вставлено 7285 записей для партиции 203207
2025-02-12 16:34:17,893 - INFO - Вставлено 7285 записей для партиции 203208
2025-02-12 16:34:18,009 - INFO - Вставлено 7050 записей для партиции 203209
2025-02-12 16:34:18,115 - INFO - Вставлено 7285 записей для партиции 203210
2025-02-12 16:34:18,230 - INFO - Вставлено 7050 записей для партиции 203211
2025-02-12 16:34:18,346 - INFO - Вставлено 7285 записей для партиции 203212
2025-02-12 16:34:18,467 - INFO - Вставлено 7285 записей для партиции 203301
2025-02-12 16:34:18,580 - INFO - Вставлено 6580 записей для партиции 203302
2025-02-12 16:34:18,698 - INFO - Вставлено 7285 записей для партиции 203303
2025-02-12 16:34:18,808 - INFO - Вставлено 7050 записей для партиции 203304
2025-02-12 16:34:18,929 - INFO - Вставлено 7285 записей для партиции 203305
2025-02-12 16:34:19,040 - INFO - Вставлено 7050 записей для партиции 203306
2025-02-12 16:34:19,159 - INFO - Вставлено 7285 записей для партиции 203307
2025-02-12 16:34:19,267 - INFO - Вставлено 7285 записей для партиции 203308
2025-02-12 16:34:19,377 - INFO - Вставлено 7050 записей для партиции 203309
2025-02-12 16:34:19,484 - INFO - Вставлено 7285 записей для партиции 203310
2025-02-12 16:34:19,591 - INFO - Вставлено 7050 записей для партиции 203311
2025-02-12 16:34:19,698 - INFO - Вставлено 7285 записей для партиции 203312
2025-02-12 16:34:19,813 - INFO - Вставлено 7285 записей для партиции 203401
2025-02-12 16:34:19,912 - INFO - Вставлено 6580 записей для партиции 203402
2025-02-12 16:34:20,020 - INFO - Вставлено 7285 записей для партиции 203403
2025-02-12 16:34:20,123 - INFO - Вставлено 7050 записей для партиции 203404
2025-02-12 16:34:20,237 - INFO - Вставлено 7285 записей для партиции 203405
2025-02-12 16:34:20,352 - INFO - Вставлено 7050 записей для партиции 203406
2025-02-12 16:34:20,464 - INFO - Вставлено 7285 записей для партиции 203407
2025-02-12 16:34:20,573 - INFO - Вставлено 7285 записей для партиции 203408
2025-02-12 16:34:20,687 - INFO - Вставлено 7050 записей для партиции 203409
2025-02-12 16:34:20,792 - INFO - Вставлено 7285 записей для партиции 203410
2025-02-12 16:34:20,919 - INFO - Вставлено 7050 записей для партиции 203411
2025-02-12 16:34:21,038 - INFO - Вставлено 7285 записей для партиции 203412
2025-02-12 16:34:21,163 - INFO - Вставлено 7285 записей для партиции 203501
2025-02-12 16:34:21,266 - INFO - Вставлено 6580 записей для партиции 203502
2025-02-12 16:34:21,409 - INFO - Вставлено 7285 записей для партиции 203503
2025-02-12 16:34:21,528 - INFO - Вставлено 7050 записей для партиции 203504
2025-02-12 16:34:21,645 - INFO - Вставлено 7285 записей для партиции 203505
2025-02-12 16:34:21,762 - INFO - Вставлено 7050 записей для партиции 203506
2025-02-12 16:34:21,883 - INFO - Вставлено 7285 записей для партиции 203507
2025-02-12 16:34:22,007 - INFO - Вставлено 7285 записей для партиции 203508
2025-02-12 16:34:22,110 - INFO - Вставлено 7050 записей для партиции 203509
2025-02-12 16:34:22,217 - INFO - Вставлено 7285 записей для партиции 203510
2025-02-12 16:34:22,273 - INFO - Вставлено 1880 записей для партиции 203511
2025-02-12 16:34:22,276 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-12 16:34:22,403 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:34:22,413 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String,
    `update_time` DateTime,
    `RepairTime` Nullable(Float64),
    `trigger_type` UInt8
)
ENGINE = ReplacingMergeTree(update_time)
PARTITION BY toYYYYMM(Dates)
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-12 16:34:22,422 - INFO - Столбец 'RepairTime' уже существует в таблице 'OlapCube_VNV'
2025-02-12 16:34:22,429 - INFO - Получено значение RepairTime: 120.0
2025-02-12 16:34:22,441 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-12 16:34:22,474 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:34:22,497 - INFO - Получено данных из fleet: 12 месяцев
2025-02-12 16:34:22,498 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-12 16:34:22,534 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-12 16:34:22,535 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-12 16:34:22,555 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 16:34:22,568 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-12 16:34:22,590 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-12 16:34:22,591 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-12 16:34:22,651 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-12 16:34:22,664 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-12 16:34:22,665 - INFO - Определено 0 записей с trigger_type=1.
2025-02-12 16:34:22,665 - INFO - Определено 1 записей с trigger_type=0.
2025-02-12 16:34:22,666 - INFO - Нет записей для обновления trigger_type=1.
2025-02-12 16:34:22,691 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-12 16:34:22,692 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-12 18:30:49,989 - INFO - Начинаю вычисление aggregate_count.
2025-02-12 18:30:50,004 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-12 18:30:50,015 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-12 18:30:50,024 - INFO - monthly_flight_hours: 48.0
2025-02-12 18:30:50,028 - INFO - Вычисленный aggregate_count: 235
2025-02-12 18:30:50,030 - INFO - aggregate_count рассчитан: 235
2025-02-12 18:30:50,033 - INFO - Получаю значения из таблицы Agregat.
2025-02-12 18:30:50,043 - INFO - Получены значения из таблицы Agregat.
2025-02-12 18:30:50,045 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-12 18:30:50,053 - INFO - Получено daily_flight_hours: 1.58
2025-02-12 18:30:50,055 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-12 18:30:50,070 - INFO - Получено 4001 уникальных дат.
2025-02-12 18:30:50,072 - INFO - Сгенерировано 235 серийных номеров.
2025-02-12 18:31:02,969 - INFO - Успешно вставлено 940235 записей в OlapCube_VNV.
2025-02-12 18:31:03,071 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 18:31:03,089 - INFO - Схема таблицы 'OlapCube_VNV':
CREATE TABLE default.OlapCube_VNV
(
    `serialno` String,
    `Dates` Date,
    `Status_P` Nullable(String),
    `repair_days` Nullable(Float64),
    `sne` Nullable(Float64),
    `ppr` Nullable(Float64),
    `Status` Nullable(String),
    `daily_flight_hours` Nullable(Float64),
    `daily_flight_hours_f` Nullable(Float64),
    `BR` Nullable(Float64),
    `ll` Nullable(Float64),
    `oh` Nullable(Float64),
    `threshold` Nullable(Float64),
    `Effectivity` Nullable(String),
    `mi8t_count` Nullable(Float64),
    `mi17_count` Nullable(Float64),
    `balance_mi8t` Float64,
    `balance_mi17` Float64,
    `balance_total` Float64,
    `stock_mi8t` Float64,
    `stock_mi17` Float64,
    `stock_total` Float64,
    `balance_empty` Float64,
    `stock_empty` Float64,
    `location` String,
    `ac_typ` String
)
ENGINE = ReplacingMergeTree
ORDER BY (serialno, Dates)
SETTINGS index_granularity = 8192
2025-02-12 18:31:03,110 - INFO - Столбец 'RepairTime' успешно добавлен в таблицу 'OlapCube_VNV'
2025-02-12 18:31:03,120 - INFO - Получено значение RepairTime: 120.0
2025-02-12 18:31:03,130 - INFO - Столбец 'RepairTime' успешно обновлён в таблице 'OlapCube_VNV'
2025-02-12 18:31:03,172 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 18:31:03,188 - INFO - Получено данных из fleet: 12 месяцев
2025-02-12 18:31:03,190 - INFO - Начинается обновление полей mi8t_count и mi17_count в OlapCube_VNV
2025-02-12 18:31:03,202 - INFO - Поля mi8t_count и mi17_count успешно обновлены в OlapCube_VNV
2025-02-12 18:31:03,204 - INFO - Данные mi8t_count и mi17_count успешно обновлены на основании Dates в OlapCube_VNV
2025-02-12 18:31:03,225 - INFO - Подключение к ClickHouse успешно установлено
2025-02-12 18:31:03,237 - INFO - Получено значение daily_flight_hours: 1.58
2025-02-12 18:31:03,249 - INFO - Поле daily_flight_hours успешно обновлено в OlapCube_VNV
2025-02-12 18:31:03,251 - INFO - Поле daily_flight_hours успешно обновлено в OLAP кубе
2025-02-12 18:31:03,298 - INFO - Поле trigger_type успешно добавлено в таблицу OlapCube_VNV.
2025-02-12 18:31:03,307 - INFO - Извлечено 1 записей из таблицы Agregat.
2025-02-12 18:31:03,309 - INFO - Определено 0 записей с trigger_type=1.
2025-02-12 18:31:03,310 - INFO - Определено 1 записей с trigger_type=0.
2025-02-12 18:31:03,311 - INFO - Нет записей для обновления trigger_type=1.
2025-02-12 18:31:03,320 - INFO - Обновлено trigger_type=0 для 1 записей (батч 1).
2025-02-12 18:31:03,322 - INFO - Поле trigger_type успешно добавлено и заполнено в таблице OlapCube_VNV.
2025-02-12 19:03:21,519 - INFO - Начинаю вычисление aggregate_count.
2025-02-12 19:03:21,537 - INFO - Сумма mi17_count: 777.0, сумма mi8t_count: 1006.0
2025-02-12 19:03:21,547 - INFO - items_per_ac: 1.0, NR_Mi17: 6000.0
2025-02-12 19:03:21,555 - INFO - monthly_flight_hours: 48.0
2025-02-12 19:03:21,556 - INFO - Вычисленный aggregate_count: 235
2025-02-12 19:03:21,557 - INFO - aggregate_count рассчитан: 235
2025-02-12 19:03:21,557 - INFO - Получаю значения из таблицы Agregat.
2025-02-12 19:03:21,566 - INFO - Получены значения из таблицы Agregat.
2025-02-12 19:03:21,568 - INFO - Получаю daily_flight_hours из flight_hours.
2025-02-12 19:03:21,577 - INFO - Получено daily_flight_hours: 1.58
2025-02-12 19:03:21,578 - INFO - Начинаю вставку данных в OlapCube_VNV.
2025-02-12 19:03:21,598 - INFO - Получено 4001 уникальных дат.
2025-02-12 19:03:21,600 - INFO - Сгенерировано 235 серийных номеров.
